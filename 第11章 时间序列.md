Date: Sat, 25 May 2019 11:52:58 GMT
Content-Type: text/html; charset=utf-8
Transfer-Encoding: chunked
Server: GitHub.com
Status: 200 OK
Vary: X-PJAX
ETag: W/"d8c1729103980024b8ced7bdebc3657d"
Cache-Control: max-age=0, private, must-revalidate
Set-Cookie: user_session=4uuBF9zWnN3QmENGE1de4hTYZd0DZQFOE-nhfW4XatthTuj8; path=/; expires=Sat, 08 Jun 2019 11:52:57 -0000; secure; HttpOnly
Set-Cookie: __Host-user_session_same_site=4uuBF9zWnN3QmENGE1de4hTYZd0DZQFOE-nhfW4XatthTuj8; path=/; expires=Sat, 08 Jun 2019 11:52:57 -0000; secure; HttpOnly; SameSite=Strict
Set-Cookie: has_recent_activity=1; path=/; expires=Sat, 25 May 2019 12:52:57 -0000
Set-Cookie: _gh_sess=dU1NOVZsU2daUG5XUGFLcTdIRTNoZTFRcVFpeVRiUVVKTjVPQTlKQVltdU9zck1vamlCMFNJL1NYVURYYlg0anc2MzYwRUsvcHNNVmt0ZU4vTVhORFhjcDJER0dFSlQ4cWw0UVltcFNGQklDSUV3Q1V3ME01cjJTSjc4RGdnYjNUN1dLR0JONkVsNWNTck92T2U1MzZITFFhRmxrR0NCS21WanEweWRGcUNLK0N6cldSUnAyWVhFell2NFI5QkVoZkhLT1VlMDR4TTFmRTNhYXhkYmdLUHFndDdaa3MxN3BHbzJ5VDd0VFBIODlNdFpaeVJmc0IvbGRFeDZtY1grdU1YQTRaY2xDVkJONDJDR0VtU2QvVTBpVVNwUXhhUDRDNVZoeXNsN1hib2tGcm1zeEtvM1draDQ1a2V0dlFzRGtvTmtmU1JjRlp3UCt1M21XaU1rcjRYdWJtNkpwN1BGMlJsTkFjUTUzSk1KR1gvb2JkVndnTnlDc04yWlE5N1ZGLS0rTjJXZWNiTnFKeUM2aW10Q2ttVEJBPT0%3D--ec286efc4f798c779e5b20547a2eeb5e706a898f; path=/; secure; HttpOnly
X-Request-Id: 79e21527-c83b-41d5-b603-29b612dbfdb6
Strict-Transport-Security: max-age=31536000; includeSubdomains; preload
X-Frame-Options: deny
X-Content-Type-Options: nosniff
X-XSS-Protection: 1; mode=block
Expect-CT: max-age=2592000, report-uri="https://api.github.com/_private/browser/errors"
Content-Security-Policy: default-src 'none'; base-uri 'self'; block-all-mixed-content; connect-src 'self' uploads.github.com www.githubstatus.com collector.githubapp.com api.github.com www.google-analytics.com github-cloud.s3.amazonaws.com github-production-repository-file-5c1aeb.s3.amazonaws.com github-production-upload-manifest-file-7fdce7.s3.amazonaws.com github-production-user-asset-6210df.s3.amazonaws.com wss://live.github.com; font-src github.githubassets.com; form-action 'self' github.com gist.github.com; frame-ancestors 'none'; frame-src render.githubusercontent.com; img-src 'self' data: github.githubassets.com identicons.github.com collector.githubapp.com github-cloud.s3.amazonaws.com *.githubusercontent.com; manifest-src 'self'; media-src 'none'; script-src github.githubassets.com; style-src 'unsafe-inline' github.githubassets.com
Vary: Accept-Encoding
X-GitHub-Request-Id: AD5F:3B28:8C0418:C500D0:5CE92C99

355d






<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
  <link rel="dns-prefetch" href="https://github.githubassets.com">
  <link rel="dns-prefetch" href="https://avatars0.githubusercontent.com">
  <link rel="dns-prefetch" href="https://avatars1.githubusercontent.com">
  <link rel="dns-prefetch" href="https://avatars2.githubusercontent.com">
  <link rel="dns-prefetch" href="https://avatars3.githubusercontent.com">
  <link rel="dns-prefetch" href="https://github-cloud.s3.amazonaws.com">
  <link rel="dns-prefetch" href="https://user-images.githubusercontent.com/">



  <link crossorigin="anonymous" media="all" integrity="sha512-3+HOqCwtQal5hOJQ+mdxiq5zmGOTjF6RhjDsPLxbKDYgGlLFeCwzoIanb7j5IiCuXKUqyC2q8FdkC4nmx2P2rA==" rel="stylesheet" href="https://github.githubassets.com/assets/frameworks-a2fba223d5af91496cac70d4ec3624df.css" />
  
    <link crossorigin="anonymous" media="all" integrity="sha512-rsD81z23enDfs9K8QwuOdeneWb2QHFNY9t5B56bADHpt6HdhHGuAg2uTvL4Ct95hfkjZyKIQH6S2ETUBSR3VIA==" rel="stylesheet" href="https://github.githubassets.com/assets/github-6556dfa9be535e551ffffaadfecdad99.css" />
    
    
    
    

  <meta name="viewport" content="width=device-width">
  
  <title>python_for_data_analysis_2nd_chinese_version/第11章 时间序列.md at master · iamseancheney/python_for_data_analysis_2nd_chinese_version</title>
    <meta name="description" content="《利用Python进行数据分析·第2版》. Contribute to iamseancheney/python_for_data_analysis_2nd_chinese_version development by creating an account on GitHub.">
    <link rel="search" type="application/opensearchdescription+xml" href="/opensearch.xml" title="GitHub">
  <link rel="fluid-icon" href="https://github.com/fluidicon.png" title="GitHub">
  <meta property="fb:app_id" content="1401488693436528">

    <meta name="twitter:image:src" content="https://avatars3.githubusercontent.com/u/29977021?s=400&amp;v=4" /><meta name="twitter:site" content="@github" /><meta name="twitter:card" content="summary" /><meta name="twitter:title" content="iamseancheney/python_for_data_analysis_2nd_chinese_version" /><meta name="twitter:description" content="《利用Python进行数据分析·第2版》. Contribute to iamseancheney/python_for_data_analysis_2nd_chinese_version development by creating an account on GitHub." />
    <meta property="og:image" content="https://avatars3.githubusercontent.com/u/29977021?s=400&amp;v=4" /><meta property="og:site_name" content="GitHub" /><meta property="og:type" content="object" /><meta property="og:title" content="iamseancheney/python_for_data_analysis_2nd_chinese_version" /><meta property="og:url" content="https://github.com/iamseancheney/python_for_data_analysis_2nd_chinese_version" /><meta property="og:description" content="《利用Python进行数据分析·第2版》. Contribute to iamseancheney/python_for_data_analysis_2nd_chinese_version development by creating an account on GitHub." />

  <link rel="assets" href="https://github.githubassets.com/">
  <link rel="web-socket" href="wss://live.github.com/_sockets/VjI6NDAyMTYwNTQ3OjdlM2I0MTg1MjkxMzU3NGJlYTI3NTkxMjFkZTIyY2QzNWMzZThiYTU5NWQ2MjJhNDUyMjdiNTY3MDcyMzhiNTA=--22e6e8030175d7b0bb697a8f1e55a2f7db6224e1">
  <meta name="pjax-timeout" content="1000">
  <link rel="sudo-modal" href="/sessions/sudo_modal">
  <meta name="request-id" content="AD5F:3B28:8C0418:C500D0:5CE92C99" data-pjax-transient>


  

  <meta name="selected-link" value="repo_source" data-pjax-transient>

      <meta name="google-site-verification" content="KT5gs8h0wvaagLKAVWq8bbeNwnZZK1r1XQysX3xurLU">
    <meta name="google-site-verification" content="ZzhVyEFwb7w3e0-uOTltm8Jsck2F5StVihD0exw2fsA">
    <meta name="google-site-verification" content="GXs5KoUUkNCoaAZn7wPN-t01Pywp9M3sEjnt_3_ZWPc">

  <meta name="octolytics-host" content="collector.githubapp.com" /><meta name="octolytics-app-id" content="github" /><meta name="octolytics-event-url" content="https://collector.githubapp.com/github-external/browser_event" /><meta name="octolytics-dimension-request_id" content="AD5F:3B28:8C0418:C500D0:5CE92C99" /><meta name="octolytics-dimension-region_edge" content="ap-southeast-1" /><meta name="octolytics-dimension-region_render" content="iad" /><meta name="octolytics-actor-id" content="40493722" /><meta name="octolytics-actor-login" content="coca-carb" /><meta name="octolytics-actor-hash" content="bbf4cd20af57d9932eb3a9a7d67fe059bc91c89360fd89df7fe5178f4de0c9ec" />
<meta name="analytics-location" content="/&lt;user-name&gt;/&lt;repo-name&gt;/blob/show" data-pjax-transient="true" />



    <meta name="google-analytics" content="UA-3769691-2">

  <meta class="js-ga-set" name="userId" content="545a3bd22fd494918f55eaec5e63e3a6">

<meta class="js-ga-set" name="dimension1" content="Logged In">



  

      <meta name="hostname" content="github.com">
    <meta name="user-login" content="coca-carb">

      <meta name="expected-hostname" content="github.com">
    <meta name="js-proxy-site-detection-payload" content="MDUzZjQ2MDEwYzE5NTc2YjA5Y2Y1ZjdhZjJkMTI0N2U3MTM1ZWVmZGZiODcxYmJjOTcyZTMzMTc3YzY3NjIwMXx7InJlbW90ZV9hZGRyZXNzIjoiMTgzLjYzLjk3LjE1OCIsInJlcXVlc3RfaWQiOiJBRDVGOjNCMjg6OEMwNDE4OkM1MDBEMDo1Q0U5MkM5OSIsInRpbWVzdGFtcCI6MTU1ODc4NTE3OCwiaG9zdCI6ImdpdGh1Yi5jb20ifQ==">

    <meta name="enabled-features" content="SPONSORS,UNIVERSE_BANNER,MARKETPLACE_INVOICED_BILLING,MARKETPLACE_SOCIAL_PROOF_CUSTOMERS,MARKETPLACE_TRENDING_SOCIAL_PROOF,MARKETPLACE_RECOMMENDATIONS,NOTIFY_ON_BLOCK,RELATED_ISSUES">

  <meta name="html-safe-nonce" content="86deef24c08ee80099e4844cba9dbed0d333a838">

  <meta http-equiv="x-pjax-version" content="64395112d6a30f49197bac7217175fdd">
  

      <link href="https://github.com/iamseancheney/python_for_data_analysis_2nd_chinese_version/commits/master.atom" rel="alternate" title="Recent Commits to python_for_data_analysis_2nd_chinese_version:master" type="application/atom+xml">

  <meta name="go-import" content="github.com/iamseancheney/python_for_data_analysis_2nd_chinese_version git https://github.com/iamseancheney/python_for_data_analysis_2nd_chinese_version.git">

  <meta name="octolytics-dimension-user_id" content="29977021" /><meta name="octolytics-dimension-user_login" content="iamseancheney" /><meta name="octolytics-dimension-repository_id" content="138245018" /><meta name="octolytics-dimension-repository_nwo" content="iamseancheney/python_for_data_analysis_2nd_chinese_version" /><meta name="octolytics-dimension-repository_public" content="true" /><meta name="octolytics-dimension-repository_is_fork" content="false" /><meta name="octolytics-dimension-repository_network_root_id" content="138245018" /><meta name="octolytics-dimension-repository_network_root_nwo" content="iamseancheney/python_for_data_analysis_2nd_chinese_version" /><meta name="octolytics-dimension-repository_explore_github_marketplace_ci_cta_shown" content="false" />


    <link rel="canonical" href="https://github.com/iamseancheney/python_for_data_analysis_2nd_chinese_version/blob/master/%E7%AC%AC11%E7%AB%A0%20%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97.md" data-pjax-transient>


  <meta name="browser-stats-url" content="https://api.github.com/_private/browser/stats">

  <meta name="browser-errors-url" content="https://api.github.com/_private/browser/errors">

  <link rel="mask-icon" href="https://github.githubassets.com/pinned-octocat.svg" color="#000000">
  <link rel="icon" type="image/x-icon" class="js-site-favicon" href="https://github.githubassets.com/favicon.ico">

<meta name="theme-color" content="#1e2327">


  <meta name="u2f-enabled" content="true">



  <link rel="manifest" href="/manifest.json" crossOrigin="use-credentials">

  </head>

  <body class="logged-in env-production page-responsive page-blob">
    

  <div class="position-relative js-header-wrapper ">
    <a href="#start-of-content" tabindex="1" class="p-3 bg-blue text-white show-on-focus js-skip-to-content">Skip to content</a>
    <div id="js-pjax-loader-bar" class="pjax-loader-bar"><div class="progress"></div></div>

    
    
    


          <header class="Header js-details-container Details flex-wrap flex-lg-nowrap p-responsive" role="banner">

    <div class="Header-item d-none d-lg-flex">
      <a class="Header-link" href="https://github.com/" data-hotkey="g d" aria-label="Homepage" data-ga-click="Header, go to dashboard, icon:logo">
  <svg class="octicon octicon-mark-github v-align-middle" height="32" viewBox="0 0 16 16" version="1.1" width="32" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"/></svg>
</a>

    </div>

    <div class="Header-item d-lg-none">
      <button class="Header-link btn-link js-details-target" type="button" aria-label="Toggle navigation" aria-expanded="false">
        <svg height="24" class="octicon octicon-three-bars" viewBox="0 0 12 16" version="1.1" width="18" aria-hidden="true"><path fill-rule="evenodd" d="M11.41 9H.59C0 9 0 8.59 0 8c0-.59 0-1 .59-1H11.4c.59 0 .59.41.59 1 0 .59 0 1-.59 1h.01zm0-4H.59C0 5 0 4.59 0 4c0-.59 0-1 .59-1H11.4c.59 0 .59.41.59 1 0 .59 0 1-.59 1h.01zM.59 11H11.4c.59 0 .59.41.59 1 0 .59 0 1-.59 1H.59C0 13 0 12.59 0 12c0-.59 0-1 .59-1z"/></svg>
      </button>
    </div>

    <div class="Header-item Header-item--full flex-column flex-lg-row width-full flex-order-2 flex-lg-order-none mr-0 mr-lg-3 mt-3 mt-lg-0 Details-content--hidden">
        <div class="header-search flex-self-stretch flex-lg-self-auto mr-0 mr-lg-3 mb-3 mb-lg-0 scoped-search site-scoped-search js-site-search position-relative js-jump-to"
  role="combobox"
  aria-owns="jump-to-results"
  aria-label="Search or jump to"
  aria-haspopup="listbox"
  aria-expanded="false"
>
  <div class="position-relative">
    <!-- '"` --><!-- </textarea></xmp> --></option></form><form class="js-site-search-form" role="search" aria-label="Site" data-scope-type="Repository" data-scope-id="138245018" data-scoped-search-url="/iamseancheney/python_for_data_analysis_2nd_chinese_version/search" data-unscoped-search-url="/search" action="/iamseancheney/python_for_data_analysis_2nd_chinese_version/search" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
      <label class="form-control input-sm header-search-wrapper p-0 header-search-wrapper-jump-to position-relative d-flex flex-justify-between flex-items-center js-chromeless-input-container">
        <input type="text"
          class="form-control input-sm header-search-input jump-to-field js-jump-to-field js-site-search-focus js-site-search-field is-clearable"
          data-hotkey="s,/"
          name="q"
          value=""
          placeholder="Search or jump to…"
          data-unscoped-placeholder="Search or jump to…"
          data-scoped-placeholder="Search or jump to…"
          autocapitalize="off"
          aria-autocomplete="list"
          aria-controls="jump-to-results"
          aria-label="Search or jump to…"
          data-jump-to-suggestions-path="/_graphql/GetSuggestedNavigationDestinations#csrf-token=mgGb1UroZCETPW11NeKOSyga1sMgFc88SeYDu2v4wMrM8CPFGERw0EJbMjJd0iL61mPUJvntiZA9uHHTU4OKqw=="
          spellcheck="false"
          autocomplete="off"
          >
          <input type="hidden" class="js-site-search-type-field" name="type" >
            <img src="https://github.githubassets.com/images/search-key-slash.svg" alt="" class="mr-2 header-search-key-slash">

            <div class="Box position-absolute overflow-hidden d-none jump-to-suggestions js-jump-to-suggestions-container">
              
<ul class="d-none js-jump-to-suggestions-template-container">
  

<li class="d-flex flex-justify-start flex-items-center p-0 f5 navigation-item js-navigation-item js-jump-to-suggestion" role="option">
  <a tabindex="-1" class="no-underline d-flex flex-auto flex-items-center jump-to-suggestions-path js-jump-to-suggestion-path js-navigation-open p-2" href="">
    <div class="jump-to-octicon js-jump-to-octicon flex-shrink-0 mr-2 text-center d-none">
      <svg height="16" width="16" class="octicon octicon-repo flex-shrink-0 js-jump-to-octicon-repo d-none" title="Repository" aria-label="Repository" viewBox="0 0 12 16" version="1.1" role="img"><path fill-rule="evenodd" d="M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z"/></svg>
      <svg height="16" width="16" class="octicon octicon-project flex-shrink-0 js-jump-to-octicon-project d-none" title="Project" aria-label="Project" viewBox="0 0 15 16" version="1.1" role="img"><path fill-rule="evenodd" d="M10 12h3V2h-3v10zm-4-2h3V2H6v8zm-4 4h3V2H2v12zm-1 1h13V1H1v14zM14 0H1a1 1 0 0 0-1 1v14a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1z"/></svg>
      <svg height="16" width="16" class="octicon octicon-search flex-shrink-0 js-jump-to-octicon-search d-none" title="Search" aria-label="Search" viewBox="0 0 16 16" version="1.1" role="img"><path fill-rule="evenodd" d="M15.7 13.3l-3.81-3.83A5.93 5.93 0 0 0 13 6c0-3.31-2.69-6-6-6S1 2.69 1 6s2.69 6 6 6c1.3 0 2.48-.41 3.47-1.11l3.83 3.81c.19.2.45.3.7.3.25 0
6084
 .52-.09.7-.3a.996.996 0 0 0 0-1.41v.01zM7 10.7c-2.59 0-4.7-2.11-4.7-4.7 0-2.59 2.11-4.7 4.7-4.7 2.59 0 4.7 2.11 4.7 4.7 0 2.59-2.11 4.7-4.7 4.7z"/></svg>
    </div>

    <img class="avatar mr-2 flex-shrink-0 js-jump-to-suggestion-avatar d-none" alt="" aria-label="Team" src="" width="28" height="28">

    <div class="jump-to-suggestion-name js-jump-to-suggestion-name flex-auto overflow-hidden text-left no-wrap css-truncate css-truncate-target">
    </div>

    <div class="border rounded-1 flex-shrink-0 bg-gray px-1 text-gray-light ml-1 f6 d-none js-jump-to-badge-search">
      <span class="js-jump-to-badge-search-text-default d-none" aria-label="in this repository">
        In this repository
      </span>
      <span class="js-jump-to-badge-search-text-global d-none" aria-label="in all of GitHub">
        All GitHub
      </span>
      <span aria-hidden="true" class="d-inline-block ml-1 v-align-middle">↵</span>
    </div>

    <div aria-hidden="true" class="border rounded-1 flex-shrink-0 bg-gray px-1 text-gray-light ml-1 f6 d-none d-on-nav-focus js-jump-to-badge-jump">
      Jump to
      <span class="d-inline-block ml-1 v-align-middle">↵</span>
    </div>
  </a>
</li>

</ul>

<ul class="d-none js-jump-to-no-results-template-container">
  <li class="d-flex flex-justify-center flex-items-center f5 d-none js-jump-to-suggestion p-2">
    <span class="text-gray">No suggested jump to results</span>
  </li>
</ul>

<ul id="jump-to-results" role="listbox" class="p-0 m-0 js-navigation-container jump-to-suggestions-results-container js-jump-to-suggestions-results-container">
  

<li class="d-flex flex-justify-start flex-items-center p-0 f5 navigation-item js-navigation-item js-jump-to-scoped-search d-none" role="option">
  <a tabindex="-1" class="no-underline d-flex flex-auto flex-items-center jump-to-suggestions-path js-jump-to-suggestion-path js-navigation-open p-2" href="">
    <div class="jump-to-octicon js-jump-to-octicon flex-shrink-0 mr-2 text-center d-none">
      <svg height="16" width="16" class="octicon octicon-repo flex-shrink-0 js-jump-to-octicon-repo d-none" title="Repository" aria-label="Repository" viewBox="0 0 12 16" version="1.1" role="img"><path fill-rule="evenodd" d="M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z"/></svg>
      <svg height="16" width="16" class="octicon octicon-project flex-shrink-0 js-jump-to-octicon-project d-none" title="Project" aria-label="Project" viewBox="0 0 15 16" version="1.1" role="img"><path fill-rule="evenodd" d="M10 12h3V2h-3v10zm-4-2h3V2H6v8zm-4 4h3V2H2v12zm-1 1h13V1H1v14zM14 0H1a1 1 0 0 0-1 1v14a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1z"/></svg>
      <svg height="16" width="16" class="octicon octicon-search flex-shrink-0 js-jump-to-octicon-search d-none" title="Search" aria-label="Search" viewBox="0 0 16 16" version="1.1" role="img"><path fill-rule="evenodd" d="M15.7 13.3l-3.81-3.83A5.93 5.93 0 0 0 13 6c0-3.31-2.69-6-6-6S1 2.69 1 6s2.69 6 6 6c1.3 0 2.48-.41 3.47-1.11l3.83 3.81c.19.2.45.3.7.3.25 0 .52-.09.7-.3a.996.996 0 0 0 0-1.41v.01zM7 10.7c-2.59 0-4.7-2.11-4.7-4.7 0-2.59 2.11-4.7 4.7-4.7 2.59 0 4.7 2.11 4.7 4.7 0 2.59-2.11 4.7-4.7 4.7z"/></svg>
    </div>

    <img class="avatar mr-2 flex-shrink-0 js-jump-to-suggestion-avatar d-none" alt="" aria-label="Team" src="" width="28" height="28">

    <div class="jump-to-suggestion-name js-jump-to-suggestion-name flex-auto overflow-hidden text-left no-wrap css-truncate css-truncate-target">
    </div>

    <div class="border rounded-1 flex-shrink-0 bg-gray px-1 text-gray-light ml-1 f6 d-none js-jump-to-badge-search">
      <span class="js-jump-to-badge-search-text-default d-none" aria-label="in this repository">
        In this repository
      </span>
      <span class="js-jump-to-badge-search-text-global d-none" aria-label="in all of GitHub">
        All GitHub
      </span>
      <span aria-hidden="true" class="d-inline-block ml-1 v-align-middle">↵</span>
    </div>

    <div aria-hidden="true" class="border rounded-1 flex-shrink-0 bg-gray px-1 text-gray-light ml-1 f6 d-none d-on-nav-focus js-jump-to-badge-jump">
      Jump to
      <span class="d-inline-block ml-1 v-align-middle">↵</span>
    </div>
  </a>
</li>

  

<li class="d-flex flex-justify-start flex-items-center p-0 f5 navigation-item js-navigation-item js-jump-to-global-search d-none" role="option">
  <a tabindex="-1" class="no-underline d-flex flex-auto flex-items-center jump-to-suggestions-path js-jump-to-suggestion-path js-navigation-open p-2" href="">
    <div class="jump-to-octicon js-jump-to-octicon flex-shrink-0 mr-2 text-center d-none">
      <svg height="16" width="16" class="octicon octicon-repo flex-shrink-0 js-jump-to-octicon-repo d-none" title="Repository" aria-label="Repository" viewBox="0 0 12 16" version="1.1" role="img"><path fill-rule="evenodd" d="M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z"/></svg>
      <svg height="16" width="16" class="octicon octicon-project flex-shrink-0 js-jump-to-octicon-project d-none" title="Project" aria-label="Project" viewBox="0 0 15 16" version="1.1" role="img"><path fill-rule="evenodd" d="M10 12h3V2h-3v10zm-4-2h3V2H6v8zm-4 4h3V2H2v12zm-1 1h13V1H1v14zM14 0H1a1 1 0 0 0-1 1v14a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1z"/></svg>
      <svg height="16" width="16" class="octicon octicon-search flex-shrink-0 js-jump-to-octicon-search d-none" title="Search" aria-label="Search" viewBox="0 0 16 16" version="1.1" role="img"><path fill-rule="evenodd" d="M15.7 13.3l-3.81-3.83A5.93 5.93 0 0 0 13 6c0-3.31-2.69-6-6-6S1 2.69 1 6s2.69 6 6 6c1.3 0 2.48-.41 3.47-1.11l3.83 3.81c.19.2.45.3.7.3.25 0 .52-.09.7-.3a.996.996 0 0 0 0-1.41v.01zM7 10.7c-2.59 0-4.7-2.11-4.7-4.7 0-2.59 2.11-4.7 4.7-4.7 2.59 0 4.7 2.11 4.7 4.7 0 2.59-2.11 4.7-4.7 4.7z"/></svg>
    </div>

    <img class="avatar mr-2 flex-shrink-0 js-jump-to-suggestion-avatar d-none" alt="" aria-label="Team" src="" width="28" height="28">

    <div class="jump-to-suggestion-name js-jump-to-suggestion-name flex-auto overflow-hidden text-left no-wrap css-truncate css-truncate-target">
    </div>

    <div class="border rounded-1 flex-shrink-0 bg-gray px-1 text-gray-light ml-1 f6 d-none js-jump-to-badge-search">
      <span class="js-jump-to-badge-search-text-default d-none" aria-label="in this repository">
        In this repository
      </span>
      <span class="js-jump-to-badge-search-text-global d-none" aria-label="in all of GitHub">
        All GitHub
      </span>
      <span aria-hidden="true" class="d-inline-block ml-1 v-align-middle">↵</span>
    </div>

    <div aria-hidden="true" class="border rounded-1 flex-shrink-0 bg-gray px-1 text-gray-light ml-1 f6 d-none d-on-nav-focus js-jump-to-badge-jump">
      Jump to
      <span class="d-inline-block ml-1 v-align-middle">↵</span>
    </div>
  </a>
</li>


    <li class="d-flex flex-justify-center flex-items-center p-0 f5 js-jump-to-suggestion">
      <img src="https://github.githubassets.com/images/spinners/octocat-spinner-128.gif" alt="Octocat Spinner Icon" class="m-2" width="28">
    </li>
</ul>

            </div>
      </label>
</form>  </div>
</div>


      <nav class="d-flex flex-column flex-lg-row flex-self-stretch flex-lg-self-auto" aria-label="Global">
    <a class="Header-link d-block d-lg-none py-2 py-lg-0 border-top border-lg-top-0 border-white-fade-15" data-ga-click="Header, click, Nav menu - item:dashboard:user" aria-label="Dashboard" href="/dashboard">
      Dashboard
</a>
  <a class="js-selected-navigation-item Header-link  mr-0 mr-lg-3 py-2 py-lg-0 border-top border-lg-top-0 border-white-fade-15" data-hotkey="g p" data-ga-click="Header, click, Nav menu - item:pulls context:user" aria-label="Pull requests you created" data-selected-links="/pulls /pulls/assigned /pulls/mentioned /pulls" href="/pulls">
    Pull requests
</a>
  <a class="js-selected-navigation-item Header-link  mr-0 mr-lg-3 py-2 py-lg-0 border-top border-lg-top-0 border-white-fade-15" data-hotkey="g i" data-ga-click="Header, click, Nav menu - item:issues context:user" aria-label="Issues you created" data-selected-links="/issues /issues/assigned /issues/mentioned /issues" href="/issues">
    Issues
</a>
    <div>
      <a class="js-selected-navigation-item Header-link  mr-0 mr-lg-3 py-2 py-lg-0 border-top border-lg-top-0 border-white-fade-15" data-ga-click="Header, click, Nav menu - item:marketplace context:user" data-octo-click="marketplace_click" data-octo-dimensions="location:nav_bar" data-selected-links=" /marketplace" href="/marketplace">
        Marketplace
</a>        
    </div>

  <a class="js-selected-navigation-item Header-link  mr-0 mr-lg-3 py-2 py-lg-0 border-top border-lg-top-0 border-white-fade-15" data-ga-click="Header, click, Nav menu - item:explore" data-selected-links="/explore /trending /trending/developers /integrations /integrations/feature/code /integrations/feature/collaborate /integrations/feature/ship showcases showcases_search showcases_landing /explore" href="/explore">
    Explore
</a>
    <a class="Header-link d-block d-lg-none mr-0 mr-lg-3 py-2 py-lg-0 border-top border-lg-top-0 border-white-fade-15" aria-label="View profile and more" aria-expanded="false" aria-haspopup="false" href="https://github.com/coca-carb">
      <img class="avatar" src="https://avatars0.githubusercontent.com/u/40493722?s=40&amp;v=4" width="20" height="20" alt="@coca-carb" />
      coca-carb
</a>
    <!-- '"` --><!-- </textarea></xmp> --></option></form><form action="/logout" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><input type="hidden" name="authenticity_token" value="YM5YX3GYp4EsJHHelQA8MdqsBuG3jmUvW0iJFCnSW+7xTeiKdoQlD8JM8veKQ1lNlRCyxSje2r6lWbyDoUFSEg==" />
      <button type="submit" class="Header-link mr-0 mr-lg-3 py-2 py-lg-0 border-top border-lg-top-0 border-white-fade-15 d-lg-none btn-link d-block width-full text-left" data-ga-click="Header, sign out, icon:logout" style="padding-left: 2px;">
        <svg class="octicon octicon-sign-out v-align-middle" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 9V7H8V5h4V3l4 3-4 3zm-2 3H6V3L2 1h8v3h1V1c0-.55-.45-1-1-1H1C.45 0 0 .45 0 1v11.38c0 .39.22.73.55.91L6 16.01V13h4c.55 0 1-.45 1-1V8h-1v4z"/></svg>
        Sign out
      </button>
</form></nav>

    </div>

    <div class="Header-item Header-item--full flex-justify-center d-lg-none position-relative">
      <div class="css-truncate css-truncate-target width-fit position-absolute left-0 right-0 text-center">
              <svg class="octicon octicon-repo" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z"/></svg>
    <a class="Header-link" href="/iamseancheney">iamseancheney</a>
    /
    <a class="Header-link" href="/iamseancheney/python_for_data_analysis_2nd_chinese_version">python_for_data_analysis_2nd_chinese_version</a>

</div>
    </div>

    <div class="Header-item position-relative d-none d-lg-flex">
      

    </div>

    <div class="Header-item mr-0 mr-lg-3 flex-order-1 flex-lg-order-none">
      
    <a aria-label="You have no unread notifications" class="Header-link notification-indicator position-relative tooltipped tooltipped-s js-socket-channel js-notification-indicator" data-hotkey="g n" data-ga-click="Header, go to notifications, icon:read" data-channel="notification-changed:40493722" href="/notifications">
        <span class="mail-status "></span>
        <svg class="octicon octicon-bell" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M14 12v1H0v-1l.73-.58c.77-.77.81-2.55 1.19-4.42C2.69 3.23 6 2 6 2c0-.55.45-1 1-1s1 .45 1 1c0 0 3.39 1.23 4.16 5 .38 1.88.42 3.66 1.19 4.42l.66.58H14zm-7 4c1.11 0 2-.89 2-2H5c0 1.11.89 2 2 2z"/></svg>
</a>
    </div>


    <div class="Header-item position-relative d-none d-lg-flex">
      <details class="details-overlay details-reset">
  <summary class="Header-link"
      aria-label="Create new…"
      data-ga-click="Header, create new, icon:add">
    <svg class="octicon octicon-plus" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 9H7v5H5V9H0V7h5V2h2v5h5v2z"/></svg> <span class="dropdown-caret"></span>
  </summary>
  <details-menu class="dropdown-menu dropdown-menu-sw">
    
<a role="menuitem" class="dropdown-item" href="/new" data-ga-click="Header, create new repository">
  New repository
</a>

  <a role="menuitem" class="dropdown-item" href="/new/import" data-ga-click="Header, import a repository">
    Import repository
  </a>

<a role="menuitem" class="dropdown-item" href="https://gist.github.com/" data-ga-click="Header, create new gist">
  New gist
</a>

  <a role="menuitem" class="dropdown-item" href="/organizations/new" data-ga-click="Header, create new organization">
    New organization
  </a>


  <div role="none" class="dropdown-divider"></div>
  <div class="dropdown-header">
    <span title="iamseancheney/python_for_data_analysis_2nd_chinese_version">This repository</span>
  </div>
    <a role="menuitem" class="dropdown-item" href="/iamseancheney/python_for_data_analysis_2nd_chinese_version/issues/new" data-ga-click="Header, create new issue" data-skip-pjax>
      New issue
    </a>


  </details-menu>
</details>

    </div>

    <div class="Header-item position-relative mr-0 d-none d-lg-flex">
      
<details class="details-overlay details-reset">
  <summary class="Header-link"
    aria-label="View profile and more"
    data-ga-click="Header, show menu, icon:avatar">
    <img alt="@coca-carb" class="avatar" src="https://avatars0.githubusercontent.com/u/40493722?s=40&amp;v=4" height="20" width="20">
    <span class="dropdown-caret"></span>
  </summary>
  <details-menu class="dropdown-menu dropdown-menu-sw mt-2" style="width: 180px">
    <div class="header-nav-current-user css-truncate"><a role="menuitem" class="no-underline user-profile-link px-3 pt-2 pb-2 mb-n2 mt-n1 d-block" href="/coca-carb" data-ga-click="Header, go to profile, text:Signed in as">Signed in as <strong class="css-truncate-target">coca-carb</strong></a></div>
    <div role="none" class="dropdown-divider"></div>

      <div class="pl-3 pr-3 f6 user-status-container js-user-status-context pb-1" data-url="/users/status?compact=1&amp;link_mentions=0&amp;truncate=1">
        
<div class="js-user-status-container
    user-status-compact rounded-1 px-2 py-1 mt-2
    border
  " data-team-hovercards-enabled>
  <details class="js-user-status-details details-reset details-overlay details-overlay-dark">
    <summary class="btn-link btn-block link-gray no-underline js-toggle-user-status-edit toggle-user-status-edit " aria-haspopup="dialog" role="menuitem" data-hydro-click="{&quot;event_type&quot;:&quot;user_profile.click&quot;,&quot;payload&quot;:{&quot;profile_user_id&quot;:29977021,&quot;target&quot;:&quot;EDIT_USER_STATUS&quot;,&quot;user_id&quot;:40493722,&quot;client_id&quot;:&quot;1457370512.1531722550&quot;,&quot;originating_request_id&quot;:&quot;AD5F:3B28:8C0418:C500D0:5CE92C99&quot;,&quot;originating_url&quot;:&quot;https://github.com/iamseancheney/python_for_data_analysis_2nd_chinese_version/blob/master/%E7%AC%AC11%E7%AB%A0%20%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97.md&quot;,&quot;referrer&quot;:&quot;https://github.com/iamseancheney/python_for_data_analysis_2nd_chinese_version&quot;}}" data-hydro-click-hmac="2cd8aaf1d58b8a00ff8df65dc5adadc4fe315f098d1a41d52b73ff7cacbf7421">
      <div class="d-flex">
        <div class="f6 lh-condensed user-status-header
          d-inline-block v-align-middle
            user-status-emoji-only-header circle
            pr-2
"
            style="max-width: 29px"
          >
          <div class="user-status-emoji-container flex-shrink-0 mr-1 mt-1 lh-condensed-ultra v-align-bottom" style="">
            <svg class="octicon octicon-smiley" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8s3.58 8 8 8 8-3.58 8-8-3.58-8-8-8zm4.81 12.81a6.72 6.72 0 0 1-2.17 1.45c-.83.36-1.72.53-2.64.53-.92 0-1.81-.17-2.64-.53-.81-.34-1.55-.83-2.17-1.45a6.773 6.773 0 0 1-1.45-2.17A6.59 6.59 0 0 1 1.21 8c0-.92.17-1.81.53-2.64.34-.81.83-1.55 1.45-2.17.62-.62 1.36-1.11 2.17-1.45A6.59 6.59 0 0 1 8 1.21c.92 0 1.81.17 2.64.53.81.34 1.55.83 2.17 1.45.62.62 1.11 1.36 1.45 2.17.36.83.53 1.72.53 2.64 0 .92-.17 1.81-.53 2.64-.34.81-.83 1.55-1.45 2.17zM4 6.8v-.59c0-.66.53-1.19 1.2-1.19h.59c.66 0 1.19.53 1.19 1.19v.59c0 .67-.53 1.2-1.19 1.2H5.2C4.53 8 4 7.47 4 6.8zm5 0v-.59c0-.66.53-1.19 1.2-1.19h.59c.66 0 1.19.53 1.19 1.19v.59c0 .67-.53 1.2-1.19 1.2h-.59C9.53 8 9 7.47 9 6.8zm4 3.2c-.72 1.88-2.91 3-5 3s-4.28-1.13-5-3c-.14-.39.23-1 .66-1h8.59c.41 0 .89.61.75 1z"/></svg>
          </div>
        </div>
        <div class="
          d-inline-block v-align-middle
          
          
           css-truncate css-truncate-target 
           user-status-message-wrapper f6"
           style="line-height: 20px;" >
          <div class="d-inline-block text-gray-dark v-align-text-top text-left">
              <span class="text-gray ml-2">Set status</span>
          </div>
        </div>
      </div>
</summary>    <details-dialog class="details-dialog rounded-1 anim-fade-in fast Box Box--overlay" role="dialog" tabindex="-1">
      <!-- '"` --><!-- </textarea></xmp> --></option></form><form class="position-relative flex-auto js-user-status-form" action="/users/status?compact=1&amp;link_mentions=0&amp;truncate=1" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><input type="hidden" name="_method" value="put" /><input type="hidden" name="authenticity_token" value="qfNVhLghdfrD+aBcImttjVt/O+m33m9Q9rTjTkwDvkczmWJbLjaIrdzLqSPFG67wruD/SKXILrjbY+Ve+/rxUg==" />
        <div class="Box-header bg-gray border-bottom p-3">
          <button class="Box-btn-octicon js-toggle-user-status-edit btn-octicon float-right" type="reset" aria-label="Close dialog" data-close-dialog>
            <svg class="octicon octicon-x" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48L7.48 8z"/></svg>
          </button>
          <h3 class="Box-title f5 text-bold text-gray-dark">Edit status</h3>
        </div>
        <input type="hidden" name="emoji" class="js-user-status-emoji-field" value="">
        <input type="hidden" name="organization_id" class="js-user-status-org-id-field" value="">
        <div class="px-3 py-2 text-gray-dark">
          <div class="js-characters-remaining-container position-relative mt-2">
            <div class="input-group d-table form-group my-0 js-user-status-form-group">
              <span class="input-group-button d-table-cell v-align-middle" style="width: 1%">
                <button type="button" aria-label="Choose an emoji" class="btn-outline btn js-toggle-user-status-emoji-picker btn-open-emoji-picker p-0">
                  <span class="js-user-status-original-emoji" hidden></span>
                  <span class="js-user-status-custom-emoji"></span>
                  <span class="js-user-status-no-emoji-icon" >
                    <svg class="octicon octicon-smiley" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8s3.58 8 8 8 8-3.58 8-8-3.58-8-8-8zm4.81 12.81a6.72 6.72 0 0 1-2.17 1.45c-.83.36-1.72.53-2.64.53-.92 0-1.81-.17-2.64-.53-.81-.34-1.55-.83-2.17-1.45a6.773 6.773 0 0 1-1.45-2.17A6.59 6.59 0 0 1 1.21 8c0-.92.17-1.81.53-2.64.34-.81.83-1.55 1.45-2.17.62-.62 1.36-1.11 2.17-1.45A6.59 6.59 0 0 1 8 1.21c.92 0 1.81.17 2.64.53.81.34 1.55.83 2.17 1.45.62.62 1.11 1.36 1.45 2.17.36.83.53 1.72.53 2.64 0 .92-.17 1.81-.53 2.64-.34.81-.83 1.55-1.45 2.17zM4 6.8v-.59c0-.66.53-1.19 1.2-1.19h.59c.66 0 1.19.53 1.19 1.19v.59c0 .67-.53 1.2-1.19 1.2H5.2C4.53 8 4 7.47 4 6.8zm5 0v-.59c0-.66.53-1.19 1.2-1.19h.59c.66 0 1.19.53 1.19 1.19v.59c0 .67-.53 1.2-1.19 1.2h-.59C9.53 8 9 7.47 9 6.8zm4 3.2c-.72 1.88-2.91 3-5 3s-4.28-1.13-5-3c-.14-.39.23-1 .66-1h8.59c.41 0 .89.61.75 1z"/></svg>
                  </span>
                </button>
              </span>
              <input
                type="text"
                autocomplete="off"
                data-suggest-emoji="/autocomplete/emoji"
                data-suggest-mention="/autocomplete/user-suggestions"
                data-no-org-url="/autocomplete/user-suggestions"
                data-org-url="/suggestions?mention_suggester=1"
                data-maxlength="80"
                class="d-table-cell width-full form-control js-user-status-message-field js-characters-remaining-field"
                placeholder="What's happening?"
                name="message"
                value=""
                aria-label="What is your current status?">
              <div class="error">Could not update your status, please try again.</div>
            </div>
            <div style="margin-left: 53px" class="my-1 text-small label-characters-remaining js-characters-remaining" data-suffix="remaining" hidden>
              80 remaining
            </div>
          </div>
          <include-fragment class="js-user-status-emoji-picker" data-url="/users/status/emoji"></include-fragment>
          <div class="overflow-auto ml-n3 mr-n3 px-3 border-bottom" style="max-height: 33vh">
            <div class="user-status-suggestions js-user-status-suggestions collapsed overflow-hidden">
              <h4 class="f6 text-normal my-3">Suggestions:</h4>
              <div class="mx-3 mt-2 clearfix">
                  <div class="float-left col-6">
                      <button type="button" value=":palm_tree:" class="d-flex flex-items-baseline flex-items-stretch lh-condensed f6 btn-link link-gray no-underline js-predefined-user-status mb-1">
                        <div class="emoji-status-width mr-2 v-align-middle js-predefined-user-status-emoji">
                          <g-emoji alias="palm_tree" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f334.png">🌴</g-emoji>
                        </div>
                        <div class="d-flex flex-items-center no-underline js-predefined-user-status-message ws-normal text-left" style="border-left: 1px solid transparent">
                          On vacation
                        </div>
                      </button>
                      <button type="button" value=":face_with_thermometer:" class="d-flex flex-items-baseline flex-items-stretch lh-condensed f6 btn-link link-gray no-underline js-predefined-user-status mb-1">
                        <div class="emoji-status-width mr-2 v-align-middle js-predefined-user-status-emoji">
                          <g-emoji alias="face_with_thermometer" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f912.png">🤒</g-emoji>
                        </div>
                        <div class="d-flex flex-items-center no-underline js-predefined-user-status-message ws-normal text-left" style="border-left: 1px solid transparent">
                          Out sick
                        </div>
                      </button>
                  </div>
                  <div class="float-left col-6">
                      <button type="button" value=":house:" class="d-flex flex-items-baseline flex-items-stretch lh-condensed f6 btn-link link-gray no-underline js-predefined-user-status mb-1">
                        <div class="emoji-status-width mr-2 v-align-middle js-predefined-user-status-emoji">
                          <g-emoji alias="house" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f3e0.png">🏠</g-emoji>
                        </div>
                        <div class="d-flex flex-items-center no-underline js-predefined-user-status-message ws-normal text-left" style="border-left: 1px solid transparent">
                          Working from home
                        </div>
                      </button>
                      <button type="button" value=":dart:" class="d-flex flex-items-baseline flex-items-stretch lh-conde
4000
nsed f6 btn-link link-gray no-underline js-predefined-user-status mb-1">
                        <div class="emoji-status-width mr-2 v-align-middle js-predefined-user-status-emoji">
                          <g-emoji alias="dart" fallback-src="https://github.githubassets.com/images/icons/emoji/unicode/1f3af.png">🎯</g-emoji>
                        </div>
                        <div class="d-flex flex-items-center no-underline js-predefined-user-status-message ws-normal text-left" style="border-left: 1px solid transparent">
                          Focusing
                        </div>
                      </button>
                  </div>
              </div>
            </div>
            <div class="user-status-limited-availability-container">
              <div class="form-checkbox my-0">
                <input type="checkbox" name="limited_availability" value="1" class="js-user-status-limited-availability-checkbox" data-default-message="I may be slow to respond." aria-describedby="limited-availability-help-text-truncate-true" id="limited-availability-truncate-true">
                <label class="d-block f5 text-gray-dark mb-1" for="limited-availability-truncate-true">
                  Busy
                </label>
                <p class="note" id="limited-availability-help-text-truncate-true">
                  When others mention you, assign you, or request your review,
                  GitHub will let them know that you have limited availability.
                </p>
              </div>
            </div>
          </div>
            

<div class="d-inline-block f5 mr-2 pt-3 pb-2" >
  <div class="d-inline-block mr-1">
    Clear status
  </div>

  <details class="js-user-status-expire-drop-down f6 dropdown details-reset details-overlay d-inline-block mr-2">
    <summary class="f5 btn-link link-gray-dark border px-2 py-1 rounded-1" aria-haspopup="true">
      <div class="js-user-status-expiration-interval-selected d-inline-block v-align-baseline">
        Never
      </div>
      <div class="dropdown-caret"></div>
    </summary>

    <ul class="dropdown-menu dropdown-menu-se pl-0 overflow-auto" style="width: 220px; max-height: 15.5em">
      <li>
        <button type="button" class="btn-link dropdown-item js-user-status-expire-button ws-normal" title="Never">
          <span class="d-inline-block text-bold mb-1">Never</span>
          <div class="f6 lh-condensed">Keep this status until you clear your status or edit your status.</div>
        </button>
      </li>
      <li class="dropdown-divider" role="none"></li>
        <li>
          <button type="button" class="btn-link dropdown-item ws-normal js-user-status-expire-button" title="in 30 minutes" value="2019-05-25T20:22:58+08:00">
            in 30 minutes
          </button>
        </li>
        <li>
          <button type="button" class="btn-link dropdown-item ws-normal js-user-status-expire-button" title="in 1 hour" value="2019-05-25T20:52:58+08:00">
            in 1 hour
          </button>
        </li>
        <li>
          <button type="button" class="btn-link dropdown-item ws-normal js-user-status-expire-button" title="in 4 hours" value="2019-05-25T23:52:58+08:00">
            in 4 hours
          </button>
        </li>
        <li>
          <button type="button" class="btn-link dropdown-item ws-normal js-user-status-expire-button" title="today" value="2019-05-25T23:59:59+08:00">
            today
          </button>
        </li>
        <li>
          <button type="button" class="btn-link dropdown-item ws-normal js-user-status-expire-button" title="this week" value="2019-05-26T23:59:59+08:00">
            this week
          </button>
        </li>
    </ul>
  </details>
  <input class="js-user-status-expiration-date-input" type="hidden" name="expires_at" value="">
</div>

          <include-fragment class="js-user-status-org-picker" data-url="/users/status/organizations"></include-fragment>
        </div>
        <div class="d-flex flex-items-center flex-justify-between p-3 border-top">
          <button type="submit" disabled class="width-full btn btn-primary mr-2 js-user-status-submit">
            Set status
          </button>
          <button type="button" disabled class="width-full js-clear-user-status-button btn ml-2 ">
            Clear status
          </button>
        </div>
</form>    </details-dialog>
  </details>
</div>

      </div>
      <div role="none" class="dropdown-divider"></div>


    <a role="menuitem" class="dropdown-item" href="/coca-carb" data-ga-click="Header, go to profile, text:your profile">Your profile</a>
    <a role="menuitem" class="dropdown-item" href="/coca-carb?tab=repositories" data-ga-click="Header, go to repositories, text:your repositories">Your repositories</a>

    <a role="menuitem" class="dropdown-item" href="/coca-carb?tab=projects" data-ga-click="Header, go to projects, text:your projects">Your projects</a>

    <a role="menuitem" class="dropdown-item" href="/coca-carb?tab=stars" data-ga-click="Header, go to starred repos, text:your stars">Your stars</a>
      <a role="menuitem" class="dropdown-item" href="https://gist.github.com/" data-ga-click="Header, your gists, text:your gists">Your gists</a>

    <div role="none" class="dropdown-divider"></div>
    <a role="menuitem" class="dropdown-item" href="https://help.github.com" data-ga-click="Header, go to help, text:help">Help</a>
    <a role="menuitem" class="dropdown-item" href="/settings/profile" data-ga-click="Header, go to settings, icon:settings">Settings</a>
    <!-- '"` --><!-- </textarea></xmp> --></option></form><form class="logout-form" action="/logout" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><input type="hidden" name="authenticity_token" value="ObE/JiWitJedIb7y9wPqhk/dacdV0mmVGCmJgaxm8QuoMo/zIr42GXNJPdvoQI/6AGHd48qC1gTmOLwWJPX49w==" />
      
      <button type="submit" class="dropdown-item dropdown-signout" data-ga-click="Header, sign out, icon:logout" role="menuitem">
        Sign out
      </button>
</form>  </details-menu>
</details>

    </div>

  </header>

      

  </div>

  <div id="start-of-content" class="show-on-focus"></div>


    <div id="js-flash-container">

</div>



  <div class="application-main " data-commit-hovercards-enabled>
        <div itemscope itemtype="http://schema.org/SoftwareSourceCode" class="">
    <main  >
      


  






  <div class="pagehead repohead instapaper_ignore readability-menu experiment-repo-nav pt-0 pt-lg-4 ">
    <div class="repohead-details-container clearfix container-lg p-responsive d-none d-lg-block">

      <ul class="pagehead-actions">




  <li>
    
    <!-- '"` --><!-- </textarea></xmp> --></option></form><form data-remote="true" class="clearfix js-social-form js-social-container" action="/notifications/subscribe" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><input type="hidden" name="authenticity_token" value="+b8/eQcLqx9b0IdKOgKiSzNmkhB5LUxWjdb+5i/mML+DMd8z5U/qo4r+7kMaaDD8dkb+/nPEcWDNhb9UEy54aQ==" />      <input type="hidden" name="repository_id" value="138245018">

      <details class="details-reset details-overlay select-menu float-left">
        <summary class="select-menu-button float-left btn btn-sm btn-with-count" data-hydro-click="{&quot;event_type&quot;:&quot;repository.click&quot;,&quot;payload&quot;:{&quot;target&quot;:&quot;WATCH_BUTTON&quot;,&quot;repository_id&quot;:138245018,&quot;client_id&quot;:&quot;1457370512.1531722550&quot;,&quot;originating_request_id&quot;:&quot;AD5F:3B28:8C0418:C500D0:5CE92C99&quot;,&quot;originating_url&quot;:&quot;https://github.com/iamseancheney/python_for_data_analysis_2nd_chinese_version/blob/master/%E7%AC%AC11%E7%AB%A0%20%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97.md&quot;,&quot;referrer&quot;:&quot;https://github.com/iamseancheney/python_for_data_analysis_2nd_chinese_version&quot;,&quot;user_id&quot;:40493722}}" data-hydro-click-hmac="b8b9e0a3e6e903dc17a278d82eb308b65d42ca5c9b0b912938accd4bb5c95df7" data-ga-click="Repository, click Watch settings, action:blob#show">          <span data-menu-button>
              <svg class="octicon octicon-eye v-align-text-bottom" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.06 2C3 2 0 8 0 8s3 6 8.06 6C13 14 16 8 16 8s-3-6-7.94-6zM8 12c-2.2 0-4-1.78-4-4 0-2.2 1.8-4 4-4 2.22 0 4 1.8 4 4 0 2.22-1.78 4-4 4zm2-4c0 1.11-.89 2-2 2-1.11 0-2-.89-2-2 0-1.11.89-2 2-2 1.11 0 2 .89 2 2z"/></svg>
              Watch
          </span>
</summary>        <details-menu
          class="select-menu-modal position-absolute mt-5"
          style="z-index: 99;">
          <div class="select-menu-header">
            <span class="select-menu-title">Notifications</span>
          </div>
          <div class="select-menu-list">
            <button type="submit" name="do" value="included" class="select-menu-item width-full" aria-checked="true" role="menuitemradio">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <div class="select-menu-item-text">
                <span class="select-menu-item-heading">Not watching</span>
                <span class="description">Be notified only when participating or @mentioned.</span>
                <span class="hidden-select-button-text" data-menu-button-contents>
                  <svg class="octicon octicon-eye v-align-text-bottom" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.06 2C3 2 0 8 0 8s3 6 8.06 6C13 14 16 8 16 8s-3-6-7.94-6zM8 12c-2.2 0-4-1.78-4-4 0-2.2 1.8-4 4-4 2.22 0 4 1.8 4 4 0 2.22-1.78 4-4 4zm2-4c0 1.11-.89 2-2 2-1.11 0-2-.89-2-2 0-1.11.89-2 2-2 1.11 0 2 .89 2 2z"/></svg>
                  Watch
                </span>
              </div>
            </button>

            <button type="submit" name="do" value="release_only" class="select-menu-item width-full" aria-checked="false" role="menuitemradio">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <div class="select-menu-item-text">
                <span class="select-menu-item-heading">Releases only</span>
                <span class="description">Be notified of new releases, and when participating or @mentioned.</span>
                <span class="hidden-select-button-text" data-menu-button-contents>
                  <svg class="octicon octicon-eye v-align-text-bottom" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.06 2C3 2 0 8 0 8s3 6 8.06 6C13 14 16 8 16 8s-3-6-7.94-6zM8 12c-2.2 0-4-1.78-4-4 0-2.2 1.8-4 4-4 2.22 0 4 1.8 4 4 0 2.22-1.78 4-4 4zm2-4c0 1.11-.89 2-2 2-1.11 0-2-.89-2-2 0-1.11.89-2 2-2 1.11 0 2 .89 2 2z"/></svg>
                  Unwatch releases
                </span>
              </div>
            </button>

            <button type="submit" name="do" value="subscribed" class="select-menu-item width-full" aria-checked="false" role="menuitemradio">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <div class="select-menu-item-text">
                <span class="select-menu-item-heading">Watching</span>
                <span class="description">Be notified of all conversations.</span>
                <span class="hidden-select-button-text" data-menu-button-contents>
                  <svg class="octicon octicon-eye v-align-text-bottom" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.06 2C3 2 0 8 0 8s3 6 8.06 6C13 14 16 8 16 8s-3-6-7.94-6zM8 12c-2.2 0-4-1.78-4-4 0-2.2 1.8-4 4-4 2.22 0 4 1.8 4 4 0 2.22-1.78 4-4 4zm2-4c0 1.11-.89 2-2 2-1.11 0-2-.89-2-2 0-1.11.89-2 2-2 1.11 0 2 .89 2 2z"/></svg>
                  Unwatch
                </span>
              </div>
            </button>

            <button type="submit" name="do" value="ignore" class="select-menu-item width-full" aria-checked="false" role="menuitemradio">
              <svg class="octicon octicon-check select-menu-item-icon" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M12 5l-8 8-4-4 1.5-1.5L4 10l6.5-6.5L12 5z"/></svg>
              <div class="select-menu-item-text">
                <span class="select-menu-item-heading">Ignoring</span>
                <span class="description">Never be notified.</span>
                <span class="hidden-select-button-text" data-menu-button-contents>
                  <svg class="octicon octicon-mute v-align-text-bottom" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 2.81v10.38c0 .67-.81 1-1.28.53L3 10H1c-.55 0-1-.45-1-1V7c0-.55.45-1 1-1h2l3.72-3.72C7.19 1.81 8 2.14 8 2.81zm7.53 3.22l-1.06-1.06-1.97 1.97-1.97-1.97-1.06 1.06L11.44 8 9.47 9.97l1.06 1.06 1.97-1.97 1.97 1.97 1.06-1.06L13.56 8l1.97-1.97z"/></svg>
                  Stop ignoring
                </span>
              </div>
            </button>
          </div>
        </details-menu>
      </details>
        <a class="social-count js-social-count"
          href="/iamseancheney/python_for_data_analysis_2nd_chinese_version/watchers"
          aria-label="53 users are watching this repository">
          53
        </a>
</form>
  </li>

  <li>
      <div class="js-toggler-container js-social-container starring-container ">
    <!-- '"` --><!-- </textarea></xmp> --></option></form><form class="starred js-social-form" action="/iamseancheney/python_for_data_analysis_2nd_chinese_version/unstar" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><input type="hidden" name="authenticity_token" value="4dh94HRZWTWnf2BhAUODTvl5eKTthhYhLVyVzOpZFgmi3CzpLtI6EPJ2UzHWN0KUtPWTpp/i69YTPmN1kL8U+Q==" />
      <input type="hidden" name="context" value="repository"></input>
      <button type="submit" class="btn btn-sm btn-with-count js-toggler-target" aria-label="Unstar this repository" title="Unstar iamseancheney/python_for_data_analysis_2nd_chinese_version" data-hydro-click="{&quot;event_type&quot;:&quot;repository.click&quot;,&quot;payload&quot;:{&quot;target&quot;:&quot;UNSTAR_BUTTON&quot;,&quot;repository_id&quot;:138245018,&quot;client_id&quot;:&quot;1457370512.1531722550&quot;,&quot;originating_request_id&quot;:&quot;AD5F:3B28:8C0418:C500D0:5CE92C99&quot;,&quot;originating_url&quot;:&quot;https://github.com/iamseancheney/python_for_data_analysis_2nd_chinese_version/blob/master/%E7%AC%AC11%E7%AB%A0%20%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97.md&quot;,&quot;referrer&quot;:&quot;https://github.com/iamseancheney/python_for_data_analysis_2nd_chinese_version&quot;,&quot;user_id&quot;:40493722}}" data-hydro-click-hmac="46a642223162916ddaf79533838cfa7ba177498e70c01f937bc8c56e04faa81d" data-ga-click="Repository, click unstar button, action:blob#show; text:Unstar">        <svg class="octicon octicon-star v-align-text-bottom" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M14 6l-4.9-.64L7 1 4.9 5.36 0 6l3.6 3.26L2.67 14 7 11.67 11.33 14l-.93-4.74L14 6z"/></svg>
        Unstar
</button>        <a class="social-count js-social-count" href="/iamseancheney/python_for_data_analysis_2nd_chinese_version/stargazers"
           aria-label="771 users starred this repository">
          771
        </a>
</form>
    <!-- '"` --><!-- </textarea></xmp> --></option></form><form class="unstarred js-social-form" action="/iamseancheney/python_for_data_analysis_2nd_chinese_version/star" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><input type="hidden" name="authenticity_token" value="FqyhpK807x4r3TsQOPERuH2ab3M52/Tle4MYgvK6FpzAHL9eOQJRNXyhPBPbP+LY4qkIkR3Wmjkn2zCvML8c6A==" />
      <input type="hidden" name="context" value="repository"></input>
      <button type="submit" class=
2e49
"btn btn-sm btn-with-count js-toggler-target" aria-label="Unstar this repository" title="Star iamseancheney/python_for_data_analysis_2nd_chinese_version" data-hydro-click="{&quot;event_type&quot;:&quot;repository.click&quot;,&quot;payload&quot;:{&quot;target&quot;:&quot;STAR_BUTTON&quot;,&quot;repository_id&quot;:138245018,&quot;client_id&quot;:&quot;1457370512.1531722550&quot;,&quot;originating_request_id&quot;:&quot;AD5F:3B28:8C0418:C500D0:5CE92C99&quot;,&quot;originating_url&quot;:&quot;https://github.com/iamseancheney/python_for_data_analysis_2nd_chinese_version/blob/master/%E7%AC%AC11%E7%AB%A0%20%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97.md&quot;,&quot;referrer&quot;:&quot;https://github.com/iamseancheney/python_for_data_analysis_2nd_chinese_version&quot;,&quot;user_id&quot;:40493722}}" data-hydro-click-hmac="5ccb5ec4ff4c34ebc7d377320fcc0ab1caa34e026f5985366ff856a80e907229" data-ga-click="Repository, click star button, action:blob#show; text:Star">        <svg class="octicon octicon-star v-align-text-bottom" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M14 6l-4.9-.64L7 1 4.9 5.36 0 6l3.6 3.26L2.67 14 7 11.67 11.33 14l-.93-4.74L14 6z"/></svg>
        Star
</button>        <a class="social-count js-social-count" href="/iamseancheney/python_for_data_analysis_2nd_chinese_version/stargazers"
           aria-label="771 users starred this repository">
          771
        </a>
</form>  </div>

  </li>

  <li>
          <!-- '"` --><!-- </textarea></xmp> --></option></form><form class="btn-with-count" action="/iamseancheney/python_for_data_analysis_2nd_chinese_version/fork" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><input type="hidden" name="authenticity_token" value="HO+J/q9/7To9qroUl4oNO2nDI0EMa0V2tekXyrUdWxdl3jtGoyRfh7H4n1RWwOpI+tP1IzVnRzq2iL0l1X9w3Q==" />
            <button class="btn btn-sm btn-with-count" data-hydro-click="{&quot;event_type&quot;:&quot;repository.click&quot;,&quot;payload&quot;:{&quot;target&quot;:&quot;FORK_BUTTON&quot;,&quot;repository_id&quot;:138245018,&quot;client_id&quot;:&quot;1457370512.1531722550&quot;,&quot;originating_request_id&quot;:&quot;AD5F:3B28:8C0418:C500D0:5CE92C99&quot;,&quot;originating_url&quot;:&quot;https://github.com/iamseancheney/python_for_data_analysis_2nd_chinese_version/blob/master/%E7%AC%AC11%E7%AB%A0%20%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97.md&quot;,&quot;referrer&quot;:&quot;https://github.com/iamseancheney/python_for_data_analysis_2nd_chinese_version&quot;,&quot;user_id&quot;:40493722}}" data-hydro-click-hmac="37d8097f06154e625c0fdf12d5f08fcd46c4ac63e1042b425d00c3d7cfaac849" data-ga-click="Repository, show fork modal, action:blob#show; text:Fork" type="submit" title="Fork your own copy of iamseancheney/python_for_data_analysis_2nd_chinese_version to your account" aria-label="Fork your own copy of iamseancheney/python_for_data_analysis_2nd_chinese_version to your account">              <svg class="octicon octicon-repo-forked v-align-text-bottom" viewBox="0 0 10 16" version="1.1" width="10" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8 1a1.993 1.993 0 0 0-1 3.72V6L5 8 3 6V4.72A1.993 1.993 0 0 0 2 1a1.993 1.993 0 0 0-1 3.72V6.5l3 3v1.78A1.993 1.993 0 0 0 5 15a1.993 1.993 0 0 0 1-3.72V9.5l3-3V4.72A1.993 1.993 0 0 0 8 1zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zm3 10c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zm3-10c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"/></svg>
              Fork
</button></form>
    <a href="/iamseancheney/python_for_data_analysis_2nd_chinese_version/network/members" class="social-count"
       aria-label="424 users forked this repository">
      424
    </a>
  </li>
</ul>

      <h1 class="public ">
    <svg class="octicon octicon-repo" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9H3V8h1v1zm0-3H3v1h1V6zm0-2H3v1h1V4zm0-2H3v1h1V2zm8-1v12c0 .55-.45 1-1 1H6v2l-1.5-1.5L3 16v-2H1c-.55 0-1-.45-1-1V1c0-.55.45-1 1-1h10c.55 0 1 .45 1 1zm-1 10H1v2h2v-1h3v1h5v-2zm0-10H2v9h9V1z"/></svg>
  <span class="author" itemprop="author"><a class="url fn" rel="author" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=29977021" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="/iamseancheney">iamseancheney</a></span><!--
--><span class="path-divider">/</span><!--
--><strong itemprop="name"><a data-pjax="#js-repo-pjax-container" href="/iamseancheney/python_for_data_analysis_2nd_chinese_version">python_for_data_analysis_2nd_chinese_version</a></strong>
  

</h1>

    </div>
    
<nav class="hx_reponav reponav js-repo-nav js-sidenav-container-pjax container-lg p-responsive d-none d-lg-block"
     itemscope
     itemtype="http://schema.org/BreadcrumbList"
    aria-label="Repository"
     data-pjax="#js-repo-pjax-container">

  <span itemscope itemtype="http://schema.org/ListItem" itemprop="itemListElement">
    <a class="js-selected-navigation-item selected reponav-item" itemprop="url" data-hotkey="g c" aria-current="page" data-selected-links="repo_source repo_downloads repo_commits repo_releases repo_tags repo_branches repo_packages /iamseancheney/python_for_data_analysis_2nd_chinese_version" href="/iamseancheney/python_for_data_analysis_2nd_chinese_version">
      <svg class="octicon octicon-code" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M9.5 3L8 4.5 11.5 8 8 11.5 9.5 13 14 8 9.5 3zm-5 0L0 8l4.5 5L6 11.5 2.5 8 6 4.5 4.5 3z"/></svg>
      <span itemprop="name">Code</span>
      <meta itemprop="position" content="1">
</a>  </span>

    <span itemscope itemtype="http://schema.org/ListItem" itemprop="itemListElement">
      <a itemprop="url" data-hotkey="g i" class="js-selected-navigation-item reponav-item" data-selected-links="repo_issues repo_labels repo_milestones /iamseancheney/python_for_data_analysis_2nd_chinese_version/issues" href="/iamseancheney/python_for_data_analysis_2nd_chinese_version/issues">
        <svg class="octicon octicon-issue-opened" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"/></svg>
        <span itemprop="name">Issues</span>
        <span class="Counter">3</span>
        <meta itemprop="position" content="2">
</a>    </span>

  <span itemscope itemtype="http://schema.org/ListItem" itemprop="itemListElement">
    <a data-hotkey="g p" itemprop="url" class="js-selected-navigation-item reponav-item" data-selected-links="repo_pulls checks /iamseancheney/python_for_data_analysis_2nd_chinese_version/pulls" href="/iamseancheney/python_for_data_analysis_2nd_chinese_version/pulls">
      <svg class="octicon octicon-git-pull-request" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M11 11.28V5c-.03-.78-.34-1.47-.94-2.06C9.46 2.35 8.78 2.03 8 2H7V0L4 3l3 3V4h1c.27.02.48.11.69.31.21.2.3.42.31.69v6.28A1.993 1.993 0 0 0 10 15a1.993 1.993 0 0 0 1-3.72zm-1 2.92c-.66 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2zM4 3c0-1.11-.89-2-2-2a1.993 1.993 0 0 0-1 3.72v6.56A1.993 1.993 0 0 0 2 15a1.993 1.993 0 0 0 1-3.72V4.72c.59-.34 1-.98 1-1.72zm-.8 10c0 .66-.55 1.2-1.2 1.2-.65 0-1.2-.55-1.2-1.2 0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2zM2 4.2C1.34 4.2.8 3.65.8 3c0-.65.55-1.2 1.2-1.2.65 0 1.2.55 1.2 1.2 0 .65-.55 1.2-1.2 1.2z"/></svg>
      <span itemprop="name">Pull requests</span>
      <span class="Counter">4</span>
      <meta itemprop="position" content="3">
</a>  </span>


    <a data-hotkey="g b" class="js-selected-navigation-item reponav-item" data-selected-links="repo_projects new_repo_project repo_project /iamseancheney/python_for_data_analysis_2nd_chinese_version/projects" href="/iamseancheney/python_for_data_analysis_2nd_chinese_version/projects">
      <svg class="octicon octicon-project" viewBox="0 0 15 16" version="1.1" width="15" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M10 12h3V2h-3v10zm-4-2h3V2H6v8zm-4 4h3V2H2v12zm-1 1h13V1H1v14zM14 0H1a1 1 0 0 0-1 1v14a1 1 0 0 0 1 1h13a1 1 0 0 0 1-1V1a1 1 0 0 0-1-1z"/></svg>
      Projects
      <span class="Counter" >0</span>
</a>

    <a class="js-selected-navigation-item reponav-item" data-hotkey="g w" data-selected-links="repo_wiki /iamseancheney/python_for_data_analysis_2nd_chinese_version/wiki" href="/iamseancheney/python_for_data_analysis_2nd_chinese_version/wiki">
      <svg class="octicon octicon-book" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M3 5h4v1H3V5zm0 3h4V7H3v1zm0 2h4V9H3v1zm11-5h-4v1h4V5zm0 2h-4v1h4V7zm0 2h-4v1h4V9zm2-6v9c0 .55-.45 1-1 1H9.5l-1 1-1-1H2c-.55 0-1-.45-1-1V3c0-.55.45-1 1-1h5.5l1 1 1-1H15c.55 0 1 .45 1 1zm-8 .5L7.5 3H2v9h6V3.5zm7-.5H9.5l-.5.5V12h6V3z"/></svg>
      Wiki
</a>
    <a data-skip-pjax="true" class="js-selected-navigation-item reponav-item" data-selected-links="security alerts policy /iamseancheney/python_for_data_analysis_2nd_chinese_version/security/advisories" href="/iamseancheney/python_for_data_analysis_2nd_chinese_version/security/advisories">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" class="octicon" height="16px" width="16px">
    <path fill-rule="evenodd" clip-rule="evenodd" d="M1 2l7-2 7 2v6.02C15 12.69 9.69 16 8 16c-1.69 0-7-3.31-7-7.98V2zm1 .75L8 1l6 1.75v5.268C14 12.104 9.45 15 8 15c-1.45 0-6-2.896-6-6.982V2.75z"></path>
    <path d="M3 3.5L8 2v12c-1.207 0-5-2.482-5-5.985V3.5z"></path>
</svg>

      Security
</a>
    <a class="js-selected-navigation-item reponav-item" data-selected-links="repo_graphs repo_contributors dependency_graph pulse people /iamseancheney/python_for_data_analysis_2nd_chinese_version/pulse" href="/iamseancheney/python_for_data_analysis_2nd_chinese_version/pulse">
      <svg class="octicon octicon-graph" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M16 14v1H0V0h1v14h15zM5 13H3V8h2v5zm4 0H7V3h2v10zm4 0h-2V6h2v7z"/></svg>
      Insights
</a>

</nav>

  <div class="reponav-wrapper reponav-small d-lg-none">
  <nav class="reponav js-reponav text-center no-wrap"
       itemscope
       itemtype="http://schema.org/BreadcrumbList">

    <span itemscope itemtype="http://schema.org/ListItem" itemprop="itemListElement">
      <a class="js-selected-navigation-item selected reponav-item" itemprop="url" aria-current="page" data-selected-links="repo_source repo_downloads repo_commits repo_releases repo_tags repo_branches repo_packages /iamseancheney/python_for_data_analysis_2nd_chinese_version" href="/iamseancheney/python_for_data_analysis_2nd_chinese_version">
        <span itemprop="name">Code</span>
        <meta itemprop="position" content="1">
</a>    </span>

      <span itemscope itemtype="http://schema.org/ListItem" itemprop="itemListElement">
        <a itemprop="url" class="js-selected-navigation-item reponav-item" data-selected-links="repo_issues repo_labels repo_milestones /iamseancheney/python_for_data_analysis_2nd_chinese_version/issues" href="/iamseancheney/python_for_data_analysis_2nd_chinese_version/issues">
          <span itemprop="name">Issues</span>
          <span class="Counter">3</span>
          <meta itemprop="position" content="2">
</a>      </span>

    <span itemscope itemtype="http://schema.org/ListItem" itemprop="itemListElement">
      <a itemprop="url" class="js-selected-navigation-item reponav-item" data-selected-links="repo_pu
4000
lls checks /iamseancheney/python_for_data_analysis_2nd_chinese_version/pulls" href="/iamseancheney/python_for_data_analysis_2nd_chinese_version/pulls">
        <span itemprop="name">Pull requests</span>
        <span class="Counter">4</span>
        <meta itemprop="position" content="3">
</a>    </span>

      <span itemscope itemtype="http://schema.org/ListItem" itemprop="itemListElement">
        <a itemprop="url" class="js-selected-navigation-item reponav-item" data-selected-links="repo_projects new_repo_project repo_project /iamseancheney/python_for_data_analysis_2nd_chinese_version/projects" href="/iamseancheney/python_for_data_analysis_2nd_chinese_version/projects">
          <span itemprop="name">Projects</span>
          <span class="Counter">0</span>
          <meta itemprop="position" content="4">
</a>      </span>

      <span itemscope itemtype="http://schema.org/ListItem" itemprop="itemListElement">
        <a itemprop="url" class="js-selected-navigation-item reponav-item" data-selected-links="repo_wiki /iamseancheney/python_for_data_analysis_2nd_chinese_version/wiki" href="/iamseancheney/python_for_data_analysis_2nd_chinese_version/wiki">
          <span itemprop="name">Wiki</span>
          <meta itemprop="position" content="5">
</a>      </span>

      <a itemprop="url" class="js-selected-navigation-item reponav-item" data-selected-links="security alerts policy /iamseancheney/python_for_data_analysis_2nd_chinese_version/security/advisories" href="/iamseancheney/python_for_data_analysis_2nd_chinese_version/security/advisories">
        <span itemprop="name">Security</span>
        <meta itemprop="position" content="6">
</a>
      <a class="js-selected-navigation-item reponav-item" data-selected-links="pulse /iamseancheney/python_for_data_analysis_2nd_chinese_version/pulse" href="/iamseancheney/python_for_data_analysis_2nd_chinese_version/pulse">
        Pulse
</a>
      <span itemscope itemtype="http://schema.org/ListItem" itemprop="itemListElement">
        <a itemprop="url" class="js-selected-navigation-item reponav-item" data-selected-links="community /iamseancheney/python_for_data_analysis_2nd_chinese_version/community" href="/iamseancheney/python_for_data_analysis_2nd_chinese_version/community">
          Community
</a>      </span>

  </nav>
</div>


  </div>
<div class="container-lg new-discussion-timeline experiment-repo-nav  p-responsive">
  <div class="repository-content ">

    
    



  
    <a class="d-none js-permalink-shortcut" data-hotkey="y" href="/iamseancheney/python_for_data_analysis_2nd_chinese_version/blob/8e45c74448e37573f06ba96f241c89a3f4f183a4/%E7%AC%AC11%E7%AB%A0%20%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97.md">Permalink</a>

    <!-- blob contrib key: blob_contributors:v21:81d3b07d91f818f86acf288b2e7d6073 -->
      

    <div class="d-flex flex-items-start mb-3 flex-column flex-md-row">
      <span class="d-flex flex-justify-between width-full width-md-auto">
        
<details class="details-reset details-overlay select-menu branch-select-menu  hx_rsm" id="branch-select-menu">
  <summary class="btn btn-sm select-menu-button css-truncate"
           data-hotkey="w"
           
           title="Switch branches or tags">
    <i>Branch:</i>
    <span class="css-truncate-target">master</span>
  </summary>

  <details-menu class="select-menu-modal hx_rsm-modal position-absolute" style="z-index: 99;" src="/iamseancheney/python_for_data_analysis_2nd_chinese_version/ref-list/master/%E7%AC%AC11%E7%AB%A0%20%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97.md?source_action=show&amp;source_controller=blob" preload>
    <include-fragment class="select-menu-loading-overlay anim-pulse">
      <svg height="32" class="octicon octicon-octoface" viewBox="0 0 16 16" version="1.1" width="32" aria-hidden="true"><path fill-rule="evenodd" d="M14.7 5.34c.13-.32.55-1.59-.13-3.31 0 0-1.05-.33-3.44 1.3-1-.28-2.07-.32-3.13-.32s-2.13.04-3.13.32c-2.39-1.64-3.44-1.3-3.44-1.3-.68 1.72-.26 2.99-.13 3.31C.49 6.21 0 7.33 0 8.69 0 13.84 3.33 15 7.98 15S16 13.84 16 8.69c0-1.36-.49-2.48-1.3-3.35zM8 14.02c-3.3 0-5.98-.15-5.98-3.35 0-.76.38-1.48 1.02-2.07 1.07-.98 2.9-.46 4.96-.46 2.07 0 3.88-.52 4.96.46.65.59 1.02 1.3 1.02 2.07 0 3.19-2.68 3.35-5.98 3.35zM5.49 9.01c-.66 0-1.2.8-1.2 1.78s.54 1.79 1.2 1.79c.66 0 1.2-.8 1.2-1.79s-.54-1.78-1.2-1.78zm5.02 0c-.66 0-1.2.79-1.2 1.78s.54 1.79 1.2 1.79c.66 0 1.2-.8 1.2-1.79s-.53-1.78-1.2-1.78z"/></svg>
    </include-fragment>
  </details-menu>
</details>

        <div class="BtnGroup flex-shrink-0 d-md-none">
          <a href="/iamseancheney/python_for_data_analysis_2nd_chinese_version/find/master"
                class="js-pjax-capture-input btn btn-sm BtnGroup-item"
                data-pjax
                data-hotkey="t">
            Find file
          </a>
          <clipboard-copy value="第11章 时间序列.md" class="btn btn-sm BtnGroup-item">
            Copy path
          </clipboard-copy>
        </div>
      </span>
      <h2 id="blob-path" class="breadcrumb flex-auto min-width-0 text-normal flex-md-self-center ml-md-2 mr-md-3 my-2 my-md-0">
        <span class="js-repo-root text-bold"><span class="js-path-segment"><a data-pjax="true" href="/iamseancheney/python_for_data_analysis_2nd_chinese_version"><span>python_for_data_analysis_2nd_chinese_version</span></a></span></span><span class="separator">/</span><strong class="final-path">第11章 时间序列.md</strong>
      </h2>

      <div class="BtnGroup flex-shrink-0 d-none d-md-inline-block">
        <a href="/iamseancheney/python_for_data_analysis_2nd_chinese_version/find/master"
              class="js-pjax-capture-input btn btn-sm BtnGroup-item"
              data-pjax
              data-hotkey="t">
          Find file
        </a>
        <clipboard-copy value="第11章 时间序列.md" class="btn btn-sm BtnGroup-item">
          Copy path
        </clipboard-copy>
      </div>
    </div>



    
  <div class="Box Box--condensed d-flex flex-column flex-shrink-0">
      <div class="Box-body d-flex flex-justify-between bg-blue-light flex-column flex-md-row flex-items-start flex-md-items-center">
        <span class="pr-md-4 f6">
          <a rel="author" data-skip-pjax="true" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=29977021" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="/iamseancheney"><img class="avatar" src="https://avatars0.githubusercontent.com/u/29977021?s=40&amp;v=4" width="20" height="20" alt="@iamseancheney" /></a>
          <a class="text-bold link-gray-dark lh-default v-align-middle" rel="author" data-hovercard-type="user" data-hovercard-url="/hovercards?user_id=29977021" data-octo-click="hovercard-link-click" data-octo-dimensions="link_type:self" href="/iamseancheney">iamseancheney</a>
            <span class="lh-default v-align-middle">
              <a data-pjax="true" title="Create 第11章 时间序列.md" class="link-gray" href="/iamseancheney/python_for_data_analysis_2nd_chinese_version/commit/d199ff7f95dbe33884a4e5a4c7d47f81c9bc047b">Create 第11章 时间序列.md</a>
            </span>
        </span>
        <span class="d-inline-block flex-shrink-0 v-align-bottom f6 mt-2 mt-md-0">
          <a class="pr-2 text-mono link-gray" href="/iamseancheney/python_for_data_analysis_2nd_chinese_version/commit/d199ff7f95dbe33884a4e5a4c7d47f81c9bc047b" data-pjax>d199ff7</a>
          <relative-time datetime="2018-07-18T12:18:43Z">Jul 18, 2018</relative-time>
        </span>
      </div>

    <div class="Box-body d-flex flex-items-center flex-auto f6 border-bottom-0 flex-wrap" >
      <details class="details-reset details-overlay details-overlay-dark lh-default text-gray-dark float-left mr-2" id="blob_contributors_box">
        <summary class="btn-link" aria-haspopup="dialog">
          <span><strong>1</strong> contributor</span>
        </summary>
        <details-dialog
          class="Box Box--overlay d-flex flex-column anim-fade-in fast"
          aria-label="Users who have contributed to this file"
          src="/iamseancheney/python_for_data_analysis_2nd_chinese_version/contributors/master/%E7%AC%AC11%E7%AB%A0%20%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97.md/list" preload>
          <div class="Box-header">
            <button class="Box-btn-octicon btn-octicon float-right" type="button" aria-label="Close dialog" data-close-dialog>
              <svg class="octicon octicon-x" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48L7.48 8z"/></svg>
            </button>
            <h3 class="Box-title">
              Users who have contributed to this file
            </h3>
          </div>
          <include-fragment class="octocat-spinner my-3" aria-label="Loading..."></include-fragment>
        </details-dialog>
      </details>
    </div>
  </div>






    <div class="Box mt-3 position-relative">
      
<div class="Box-header py-2 d-flex flex-column flex-shrink-0 flex-md-row flex-md-items-center">

  <div class="text-mono f6 flex-auto pr-3 flex-order-2 flex-md-order-1 mt-2 mt-md-0">
      1875 lines (1510 sloc)
      <span class="file-info-divider"></span>
    65.7 KB
  </div>

  <div class="d-flex py-1 py-md-0 flex-auto flex-order-1 flex-md-order-2 flex-sm-grow-0 flex-justify-between">

    <div class="BtnGroup">
      <a id="raw-url" class="btn btn-sm BtnGroup-item" href="/iamseancheney/python_for_data_analysis_2nd_chinese_version/raw/master/%E7%AC%AC11%E7%AB%A0%20%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97.md">Raw</a>
        <a class="btn btn-sm js-update-url-with-hash BtnGroup-item" data-hotkey="b" href="/iamseancheney/python_for_data_analysis_2nd_chinese_version/blame/master/%E7%AC%AC11%E7%AB%A0%20%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97.md">Blame</a>
      <a rel="nofollow" class="btn btn-sm BtnGroup-item" href="/iamseancheney/python_for_data_analysis_2nd_chinese_version/commits/master/%E7%AC%AC11%E7%AB%A0%20%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97.md">History</a>
    </div>


    <div>
            <a class="btn-octicon tooltipped tooltipped-nw hide-sm"
               href="https://desktop.github.com"
               aria-label="Open this file in GitHub Desktop"
               data-ga-click="Repository, open with desktop, type:windows">
                <svg class="octicon octicon-device-desktop" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M15 2H1c-.55 0-1 .45-1 1v9c0 .55.45 1 1 1h5.34c-.25.61-.86 1.39-2.34 2h8c-1.48-.61-2.09-1.39-2.34-2H15c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1zm0 9H1V3h14v8z"/></svg>
            </a>

            <!-- '"` --><!-- </textarea></xmp> --></option></form><form class="inline-form js-update-url-with-hash" action="/iamseancheney/python_for_data_analysis_2nd_chinese_version/edit/master/%E7%AC%AC11%E7%AB%A0%20%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97.md" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><input type="hidden" name="authenticity_token" value="pLpYx0lYWFsk5AU4qVjZ49jmXBNCtQoMVaRhaOdziuvmb0tU3dkGH+prooPZeP3Hw9TR9QkYvmR7IIU5sBuQdw==" />
              <button class="btn-octicon tooltipped tooltipped-nw" type="submit"
                aria-label="Fork this project and edit the file" data-hotkey="e" data-disable-with>
                <svg class="octicon octicon-pencil" viewBox="0 0 14 16" version="1.1" width="14" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M0 12v3h3l8-8-3-3-8 8zm3 2H1v-2h1v1h1v1zm10.3-9.3L12 6 9 3l1.3-1.3a.996.996 0 0 1 1.41 0l1.59 1.59c.39.39.39 1.02 0 1.41z"/></svg>
              </button>
</form>
          <!-- '"` --><!-- </textarea></xmp> --></option></form><form class="inline-form" action="/iamseancheney/python_for_data_analysis_2nd_chinese_version/delete/master/%E7%AC%AC11%E7%AB%A0%20%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97.md" accept-charset="UTF-8" method="post"><input name="utf8" type="hidden" value="&#x2713;" /><input type="hidden" name="authenticity_token" value="3/tJO8CcRCa0n1mbOdzRmkZRvi804sy97P98410+4KKM+Mgi2gLRUyAJ7WFtHMSlgICYI6INLrsU6IslccXTOQ==" />
            <button class="btn-octicon btn-octicon-danger tooltipped tooltipped-nw" type="submit"
              aria-label="Fork this project and delete the file" data-disable-with>
              <svg class="octicon octicon-trashcan" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M11 2H9c0-.55-.45-1-1-1H5c-.55 0-1 .45-1 1H2c-.55 0-1 .45-1 1v1c0 .55.45 1 1 1v9c0 .55.45 1 1 1h7c.55 0 1-.45 1-1V5c.55 0 1-.45 1-1V3c0-.55-.45-1-1-1zm-1 12H3V5h1v8h1V5h1v8h1V5h1v8h1V5h1v9zm1-10H2V3h9v1z"/></svg>
            </button>
</form>    </div>
  </div>
</div>

      
  <div id="readme" class="Box-body readme blob instapaper_body js-code-block-container">
    <article class="markdown-body entry-content p-3 p-md-6" itemprop="text"><p>时间序列（time series）数据是一种重要的结构化数据形式，应用于多个领域，包括金融学、经济学、生态学、神经科学、物理学等。在多个时间点观察或测量到的任何事物都可以形成一段时间序列。很多时间序列是固定频率的，也就是说，数据点是根据某种规律定期出现的（比如每15秒、每5分钟、每月出现一次）。时间序列也可以是不定期的，没有固定的时间单位或单位之间的偏移量。时间序列数据的意义取决于具体的应用场景，主要有以下几种：</p>
<ul>
<li>时间戳（timestamp），特定的时刻。</li>
<li>固定时期（period），如2007年1月或2010年全年。</li>
<li>时间间隔（interval），由起始和结束时间戳表示。时期（period）可以被看做间隔（interval）的特例。</li>
<li>实验或过程时间，每个时间点都是相对于特定起始时间的一个度量。例如，从放入烤箱时起，每秒钟饼干的直径。</li>
</ul>
<p>本章主要讲解前3种时间序列。许多技术都可用于处理实验型时间序列，其索引可能是一个整数或浮点数（表示从实验开始算起已经过去的时间）。最简单也最常见的时间序列都是用时间戳进行索引的。</p>
<blockquote>
<p>提示：pandas也支持基于timedeltas的指数，它可以有效代表实验或经过的时间。这本书不涉及timedelta指数，但你可以学习pandas的文档（<a href="http://pandas.pydata.org/%EF%BC%89%E3%80%82" rel="nofollow">http://pandas.pydata.org/）。</a></p>
</blockquote>
<p>pandas提供了许多内置的时间序列处理工具和数据算法。因此，你可以高效处理非常大的时间序列，轻松地进行切片/切块、聚合、对定期/不定期的时间序列进行重采样等。有些工具特别适合金融和经济应用，你当然也可以用它们来分析服务器日志数据。</p>
<h1><a id="user-content-111-日期和时间数据类型及工具" class="anchor" aria-hidden="true" href="#111-日期和时间数据类型及工具"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>11.1 日期和时间数据类型及工具</h1>
<p>Python标准库包含用于日期（date）和时间（time）数据的数据类型，而且还有日历方面的功能。我们主要会用到datetime、time以及calendar模块。datetime.datetime（也可以简写为datetime）是用得最多的数据类型：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">10</span>]: <span class="pl-k">from</span> datetime <span class="pl-k">import</span> datetime

In [<span class="pl-c1">11</span>]: now <span class="pl-k">=</span> datetime.now()

In [<span class="pl-c1">12</span>]: now
Out[<span class="pl-c1">12</span>]: datetime.datetime(<span class="pl-c1">2017</span>, <span class="pl-c1">9</span>, <span class="pl-c1">25</span>, <span class="pl-c1">14</span>, <span class="pl-c1">5</span>, <span class=
3ff8
"pl-c1">52</span>, <span class="pl-c1">72973</span>)

In [<span class="pl-c1">13</span>]: now.year, now.month, now.day
Out[<span class="pl-c1">13</span>]: (<span class="pl-c1">2017</span>, <span class="pl-c1">9</span>, <span class="pl-c1">25</span>)</pre></div>
<p>datetime以毫秒形式存储日期和时间。timedelta表示两个datetime对象之间的时间差：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">14</span>]: delta <span class="pl-k">=</span> datetime(<span class="pl-c1">2011</span>, <span class="pl-c1">1</span>, <span class="pl-c1">7</span>) <span class="pl-k">-</span> datetime(<span class="pl-c1">2008</span>, <span class="pl-c1">6</span>, <span class="pl-c1">24</span>, <span class="pl-c1">8</span>, <span class="pl-c1">15</span>)

In [<span class="pl-c1">15</span>]: delta
Out[<span class="pl-c1">15</span>]: datetime.timedelta(<span class="pl-c1">926</span>, <span class="pl-c1">56700</span>)

In [<span class="pl-c1">16</span>]: delta.days
Out[<span class="pl-c1">16</span>]: <span class="pl-c1">926</span>

In [<span class="pl-c1">17</span>]: delta.seconds
Out[<span class="pl-c1">17</span>]: <span class="pl-c1">56700</span></pre></div>
<p>可以给datetime对象加上（或减去）一个或多个timedelta，这样会产生一个新对象：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">18</span>]: <span class="pl-k">from</span> datetime <span class="pl-k">import</span> timedelta

In [<span class="pl-c1">19</span>]: start <span class="pl-k">=</span> datetime(<span class="pl-c1">2011</span>, <span class="pl-c1">1</span>, <span class="pl-c1">7</span>)

In [<span class="pl-c1">20</span>]: start <span class="pl-k">+</span> timedelta(<span class="pl-c1">12</span>)
Out[<span class="pl-c1">20</span>]: datetime.datetime(<span class="pl-c1">2011</span>, <span class="pl-c1">1</span>, <span class="pl-c1">19</span>, <span class="pl-c1">0</span>, <span class="pl-c1">0</span>)

In [<span class="pl-c1">21</span>]: start <span class="pl-k">-</span> <span class="pl-c1">2</span> <span class="pl-k">*</span> timedelta(<span class="pl-c1">12</span>)
Out[<span class="pl-c1">21</span>]: datetime.datetime(<span class="pl-c1">2010</span>, <span class="pl-c1">12</span>, <span class="pl-c1">14</span>, <span class="pl-c1">0</span>, <span class="pl-c1">0</span>)</pre></div>
<p>datetime模块中的数据类型参见表10-1。虽然本章主要讲的是pandas数据类型和高级时间序列处理，但你肯定会在Python的其他地方遇到有关datetime的数据类型。</p>
<p>表11-1 datetime模块中的数据类型</p>
<p><a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/9f86270387f8b04bc10b63b98538264a8f359a47/687474703a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d346166323631613330356137306165622e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430"><img src="https://camo.githubusercontent.com/9f86270387f8b04bc10b63b98538264a8f359a47/687474703a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d346166323631613330356137306165622e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430" alt="" data-canonical-src="http://upload-images.jianshu.io/upload_images/7178691-4af261a305a70aeb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="max-width:100%;"></a></p>
<p>tzinfo  存储时区信息的基本类型</p>
<h2><a id="user-content-字符串和datetime的相互转换" class="anchor" aria-hidden="true" href="#字符串和datetime的相互转换"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>字符串和datetime的相互转换</h2>
<p>利用str或strftime方法（传入一个格式化字符串），datetime对象和pandas的Timestamp对象（稍后就会介绍）可以被格式化为字符串：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">22</span>]: stamp <span class="pl-k">=</span> datetime(<span class="pl-c1">2011</span>, <span class="pl-c1">1</span>, <span class="pl-c1">3</span>)

In [<span class="pl-c1">23</span>]: <span class="pl-c1">str</span>(stamp)
Out[<span class="pl-c1">23</span>]: <span class="pl-s"><span class="pl-pds">'</span>2011-01-03 00:00:00<span class="pl-pds">'</span></span>

In [<span class="pl-c1">24</span>]: stamp.strftime(<span class="pl-s"><span class="pl-pds">'</span>%Y-%m-<span class="pl-c1">%d</span><span class="pl-pds">'</span></span>)
Out[<span class="pl-c1">24</span>]: <span class="pl-s"><span class="pl-pds">'</span>2011-01-03<span class="pl-pds">'</span></span></pre></div>
<p>表11-2列出了全部的格式化编码。</p>
<p>表11-2 datetime格式定义（兼容ISO C89）</p>
<p><a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/e8437841d3c960a8c5ee7c2810243e981cd028e7/687474703a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d353063373531383233373534646635382e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430"><img src="https://camo.githubusercontent.com/e8437841d3c960a8c5ee7c2810243e981cd028e7/687474703a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d353063373531383233373534646635382e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430" alt="" data-canonical-src="http://upload-images.jianshu.io/upload_images/7178691-50c751823754df58.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="max-width:100%;"></a></p>
<p><a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/2ad68b9bd8863a4e86d903f6dd5cd2f70478fe49/687474703a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d646530313831653166366234356561662e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430"><img src="https://camo.githubusercontent.com/2ad68b9bd8863a4e86d903f6dd5cd2f70478fe49/687474703a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d646530313831653166366234356561662e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430" alt="" data-canonical-src="http://upload-images.jianshu.io/upload_images/7178691-de0181e1f6b45eaf.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="max-width:100%;"></a></p>
<p>datetime.strptime可以用这些格式化编码将字符串转换为日期：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">25</span>]: value <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">'</span>2011-01-03<span class="pl-pds">'</span></span>

In [<span class="pl-c1">26</span>]: datetime.strptime(value, <span class="pl-s"><span class="pl-pds">'</span>%Y-%m-<span class="pl-c1">%d</span><span class="pl-pds">'</span></span>)
Out[<span class="pl-c1">26</span>]: datetime.datetime(<span class="pl-c1">2011</span>, <span class="pl-c1">1</span>, <span class="pl-c1">3</span>, <span class="pl-c1">0</span>, <span class="pl-c1">0</span>)

In [<span class="pl-c1">27</span>]: datestrs <span class="pl-k">=</span> [<span class="pl-s"><span class="pl-pds">'</span>7/6/2011<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>8/6/2011<span class="pl-pds">'</span></span>]

In [<span class="pl-c1">28</span>]: [datetime.strptime(x, <span class="pl-s"><span class="pl-pds">'</span>%m/<span class="pl-c1">%d</span>/%Y<span class="pl-pds">'</span></span>) <span class="pl-k">for</span> x <span class="pl-k">in</span> datestrs]
Out[<span class="pl-c1">28</span>]: 
[datetime.datetime(<span class="pl-c1">2011</span>, <span class="pl-c1">7</span>, <span class="pl-c1">6</span>, <span class="pl-c1">0</span>, <span class="pl-c1">0</span>),
 datetime.datetime(<span class="pl-c1">2011</span>, <span class="pl-c1">8</span>, <span class="pl-c1">6</span>, <span class="pl-c1">0</span>, <span class="pl-c1">0</span>)]</pre></div>
<p>datetime.strptime是通过已知格式进行日期解析的最佳方式。但是每次都要编写格式定义是很麻烦的事情，尤其是对于一些常见的日期格式。这种情况下，你可以用dateutil这个第三方包中的parser.parse方法（pandas中已经自动安装好了）：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">29</span>]: <span class="pl-k">from</span> dateutil.parser <span class="pl-k">import</span> parse

In [<span class="pl-c1">30</span>]: parse(<span class="pl-s"><span class="pl-pds">'</span>2011-01-03<span class="pl-pds">'</span></span>)
Out[<span class="pl-c1">30</span>]: datetime.datetime(<span class="pl-c1">2011</span>, <span class="pl-c1">1</span>, <span class="pl-c1">3</span>, <span class="pl-c1">0</span>, <span class="pl-c1">0</span>)</pre></div>
<p>dateutil可以解析几乎所有人类能够理解的日期表示形式：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">31</span>]: parse(<span class="pl-s"><span class="pl-pds">'</span>Jan 31, 1997 10:45 PM<span class="pl-pds">'</span></span>)
Out[<span class="pl-c1">31</span>]: datetime.datetime(<span class="pl-c1">1997</span>, <span class="pl-c1">1</span>, <span class="pl-c1">31</span>, <span class="pl-c1">22</span>, <span class="pl-c1">45</span>)</pre></div>
<p>在国际通用的格式中，日出现在月的前面很普遍，传入dayfirst=True即可解决这个问题：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">32</span>]: parse(<span class="pl-s"><span class="pl-pds">'</span>6/12/2011<span class="pl-pds">'</span></span>, <span class="pl-v">dayfirst</span><span class="pl-k">=</span><span class="pl-c1">True</span>)
Out[<span class="pl-c1">32</span>]: datetime.datetime(<span class="pl-c1">2011</span>, <span class="pl-c1">12</span>, <span class="pl-c1">6</span>, <span class="pl-c1">0</span>, <span class="pl-c1">0</span>)</pre></div>
<p>pandas通常是用于处理成组日期的，不管这些日期是DataFrame的轴索引还是列。to_datetime方法可以解析多种不同的日期表示形式。对标准日期格式（如ISO8601）的解析非常快：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">33</span>]: datestrs <span class="pl-k">=</span> [<span class="pl-s"><span class="pl-pds">'</span>2011-07-06 12:00:00<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2011-08-06 00:00:00<span class="pl-pds">'</span></span>]

In [<span class="pl-c1">34</span>]: pd.to_datetime(datestrs)
Out[<span class="pl-c1">34</span>]: DatetimeIndex([<span class="pl-s"><span class="pl-pds">'</span>2011-07-06 12:00:00<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2011-08-06 00:00:00<span class="pl-pds">'</span></span>], <span class="pl-v">dtype</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>dat<span class="pl-ii"></span></span>
etime64[ns]<span class="pl-s"><span class="pl-pds">'</span>, freq=None)<span class="pl-ii"></span></span></pre></div>
<p>它还可以处理缺失值（None、空字符串等）：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">35</span>]: idx <span class="pl-k">=</span> pd.to_datetime(datestrs <span class="pl-k">+</span> [<span class="pl-c1">None</span>])

In [<span class="pl-c1">36</span>]: idx
Out[<span class="pl-c1">36</span>]: DatetimeIndex([<span class="pl-s"><span class="pl-pds">'</span>2011-07-06 12:00:00<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2011-08-06 00:00:00<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>NaT<span class="pl-pds">'</span></span>], dty
<span class="pl-v">pe</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>datetime64[ns]<span class="pl-pds">'</span></span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-c1">None</span>)

In [<span class="pl-c1">37</span>]: idx[<span class="pl-c1">2</span>]
Out[<span class="pl-c1">37</span>]: NaT

In [<span class="pl-c1">38</span>]: pd.isnull(idx)
Out[<span class="pl-c1">38</span>]: array([<span class="pl-c1">False</span>, <span class="pl-c1">False</span>,  <span class="pl-c1">True</span>], <span class="pl-v">dtype</span><span class="pl-k">=</span><span class="pl-c1">bool</span>)</pre></div>
<p>NaT（Not a Time）是pandas中时间戳数据的null值。</p>
<blockquote>
<p>注意：dateutil.parser是一个实用但不完美的工具。比如说，它会把一些原本不是日期的字符串认作是日期（比如"42"会被解析为2042年的今天）。</p>
</blockquote>
<p>datetime对象还有一些特定于当前环境（位于不同国家或使用不同语言的系统）的格式化选项。例如，德语或法语系统所用的月份简写就与英语系统所用的不同。表11-3进行了总结。</p>
<p>表11-3 特定于当前环境的日期格式</p>
<p><a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/afa55c101e7b6475f2e1ddebe07d5129de553f1e/687474703a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d636630313139333938323733653262302e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430"><img src="https://camo.githubusercontent.com/afa55c101e7b6475f2e1ddebe07d5129de553f1e/687474703a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d636630313139333938323733653262302e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430" alt="" data-canonical-src="http://upload-images.jianshu.io/upload_images/7178691-cf0119398273e2b0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="max-width:100%;"></a></p>
<h1><a id="user-content-112-时间序列基础" class="anchor" aria-hidden="true" href="#112-时间序列基础"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>11.2 时间序列基础</h1>
<p>pandas最基本的时间序列类型就是以时间戳（通常以Python字符串或datatime对象表示）为索引的Series：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">39</span>]: <span class="pl-k">from</span> datetime <span class="pl-k">import</span> datetime

In [<span class="pl-c1">40</span>]: dates <span class="pl-k">=</span> [datetime(<span class="pl-c1">2011</span>, <span class="pl-c1">1</span>, <span class="pl-c1">2</span>), datetime(<span class="pl-c1">2011</span>, <span class="pl-c1">1</span>, <span class="pl-c1">5</span>),
   <span class="pl-c1">...</span>.:          datetime(<span class="pl-c1">2011</span>, <span class="pl-c1">1</span>, <span class="pl-c1">7</span>), datetime(<span class="pl-c1">2011</span>, <span class="pl-c1">1</span>, <span class="pl-c1">8</span>),
   <span class="pl-c1">...</span>.:          datetime(<span class="pl-c1">2011</span>, <span class="pl-c1">1</span>, <span class="pl-c1">10</span>), datetime(<span class="pl-c1">2011</span>, <span class="pl-c1">1</span>, <span class="pl-c1">12</span>)]

In [<span class="pl-c1"
4000
>41</span>]: ts <span class="pl-k">=</span> pd.Series(np.random.randn(<span class="pl-c1">6</span>), <span class="pl-v">index</span><span class="pl-k">=</span>dates)

In [<span class="pl-c1">42</span>]: ts
Out[<span class="pl-c1">42</span>]: 
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.204708</span>
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span>    <span class="pl-c1">0.478943</span>
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">7</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.519439</span>
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">8</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.555730</span>
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">10</span>    <span class="pl-c1">1.965781</span>
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">12</span>    <span class="pl-c1">1.393406</span>
dtype: float64</pre></div>
<p>这些datetime对象实际上是被放在一个DatetimeIndex中的：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">43</span>]: ts.index
Out[<span class="pl-c1">43</span>]: 
DatetimeIndex([<span class="pl-s"><span class="pl-pds">'</span>2011-01-02<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2011-01-05<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2011-01-07<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2011-01-08<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2011-01-10<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2011-01-12<span class="pl-pds">'</span></span>],
              <span class="pl-v">dtype</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>datetime64[ns]<span class="pl-pds">'</span></span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-c1">None</span>)</pre></div>
<p>跟其他Series一样，不同索引的时间序列之间的算术运算会自动按日期对齐：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">44</span>]: ts <span class="pl-k">+</span> ts[::<span class="pl-c1">2</span>]
Out[<span class="pl-c1">44</span>]: 
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.409415</span>
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span>         NaN
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">7</span></span>   <span class="pl-k">-</span><span class="pl-c1">1.038877</span>
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">8</span></span>         NaN
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">10</span>    <span class="pl-c1">3.931561</span>
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">12</span>         NaN
dtype: float64</pre></div>
<p>ts[::2] 是每隔两个取一个。</p>
<p>pandas用NumPy的datetime64数据类型以纳秒形式存储时间戳：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">45</span>]: ts.index.dtype
Out[<span class="pl-c1">45</span>]: dtype(<span class="pl-s"><span class="pl-pds">'</span>&lt;M8[ns]<span class="pl-pds">'</span></span>)</pre></div>
<p>DatetimeIndex中的各个标量值是pandas的Timestamp对象：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">46</span>]: stamp <span class="pl-k">=</span> ts.index[<span class="pl-c1">0</span>]

In [<span class="pl-c1">47</span>]: stamp
Out[<span class="pl-c1">47</span>]: Timestamp(<span class="pl-s"><span class="pl-pds">'</span>2011-01-02 00:00:00<span class="pl-pds">'</span></span>)</pre></div>
<p>只要有需要，TimeStamp可以随时自动转换为datetime对象。此外，它还可以存储频率信息（如果有的话），且知道如何执行时区转换以及其他操作。稍后将对此进行详细讲解。</p>
<h2><a id="user-content-索引选取子集构造" class="anchor" aria-hidden="true" href="#索引选取子集构造"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>索引、选取、子集构造</h2>
<p>当你根据标签索引选取数据时，时间序列和其它的pandas.Series很像：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">48</span>]: stamp <span class="pl-k">=</span> ts.index[<span class="pl-c1">2</span>]

In [<span class="pl-c1">49</span>]: ts[stamp]
Out[<span class="pl-c1">49</span>]: <span class="pl-k">-</span><span class="pl-c1">0.51943871505673811</span></pre></div>
<p>还有一种更为方便的用法：传入一个可以被解释为日期的字符串：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">50</span>]: ts[<span class="pl-s"><span class="pl-pds">'</span>1/10/2011<span class="pl-pds">'</span></span>]
Out[<span class="pl-c1">50</span>]: <span class="pl-c1">1.9657805725027142</span>

In [<span class="pl-c1">51</span>]: ts[<span class="pl-s"><span class="pl-pds">'</span>20110110<span class="pl-pds">'</span></span>]
Out[<span class="pl-c1">51</span>]: <span class="pl-c1">1.9657805725027142</span></pre></div>
<p>对于较长的时间序列，只需传入“年”或“年月”即可轻松选取数据的切片：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">52</span>]: longer_ts <span class="pl-k">=</span> pd.Series(np.random.randn(<span class="pl-c1">1000</span>),
   <span class="pl-c1">...</span>.:                       <span class="pl-v">index</span><span class="pl-k">=</span>pd.date_range(<span class="pl-s"><span class="pl-pds">'</span>1/1/2000<span class="pl-pds">'</span></span>, <span class="pl-v">periods</span><span class="pl-k">=</span><span class="pl-c1">1000</span>))

In [<span class="pl-c1">53</span>]: longer_ts
Out[<span class="pl-c1">53</span>]: 
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span>    <span class="pl-c1">0.092908</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span>    <span class="pl-c1">0.281746</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span>    <span class="pl-c1">0.769023</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">4</span></span>    <span class="pl-c1">1.246435</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span>    <span class="pl-c1">1.007189</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">6</span></span>   <span class="pl-k">-</span><span class="pl-c1">1.296221</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">7</span></span>    <span class="pl-c1">0.274992</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">8</span></span>    <span class="pl-c1">0.228913</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">9</span></span>    <span class="pl-c1">1.352917</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">10</span>    <span class="pl-c1">0.886429</span>
                <span class="pl-c1">...</span>   
<span class="pl-c1">2002</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">9</span></span><span class="pl-k">-</span><span class="pl-c1">17</span>   <span class="pl-k">-</span><span class="pl-c1">0.139298</span>
<span class="pl-c1">2002</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">9</span></span><span class="pl-k">-</span><span class="pl-c1">18</span>   <span class="pl-k">-</span><span class="pl-c1">1.159926</span>
<span class="pl-c1">2002</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">9</span></span><span class="pl-k">-</span><span class="pl-c1">19</span>    <span class="pl-c1">0.618965</span>
<span class="pl-c1">2002</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">9</span></span><span class="pl-k">-</span><span class="pl-c1">20</span>    <span class="pl-c1">1.373890</span>
<span class="pl-c1">2002</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">9</span></span><span class="pl-k">-</span><span class="pl-c1">21</span>   <span class="pl-k">-</span><span class="pl-c1">0.983505</span>
<span class="pl-c1">2002</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">9</span></span><span class="pl-k">-</span><span class="pl-c1">22</span>    <span class="pl-c1">0.930944</span>
<span class="pl-c1">2002</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">9</span></span><span class="pl-k">-</span><span class="pl-c1">23</span>   <span class="pl-k">-</span><span class="pl-c1">0.811676</span>
<span class="pl-c1">2002</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">9</span></span><span class="pl-k">-</span><span class="pl-c1">24</span>   <span class="pl-k">-</span><span class="pl-c1">1.830156</span>
<span class="pl-c1">2002</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">9</span></span><span class="pl-k">-</span><span class="pl-c1">25</span>   <span class="pl-k">-</span><span class="pl-c1">0.138730</span>
<span class="pl-c1">2002</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">9</span></span><span class="pl-k">-</span><span class="pl-c1">26</span>    <span class="pl-c1">0.334088</span>
Freq: D, Length: <span class="pl-c1">1000</span>, dtype: float64

In [<span class="pl-c1">54</span>]: longer_ts[<span class="pl-s"><span class="pl-pds">'</span>2001<span class="pl-pds">'</span></span>]
Out[<span class="pl-c1">54</span>]: 
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span>    <span class="pl-c1">1.599534</span>
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span>    <span class="pl-c1">0.474071</span>
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span>    <span class="pl-c1">0.151326</span>
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">4</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.542173</span>
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.475496</span>
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">6</span></span>    <span class="pl-c1">0.106403</span>
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">7</span></span>   <span class="pl-k">-</span><span class="pl-c1">1.308228</span>
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">8</span></span>    <span class="pl-c1">2.173185</span>
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">9</span></span>    <span class="pl-c1">0.564561</span>
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">10</span>   <span class="pl-k">-</span><span class="pl-c1">0.190481</span>
                <span class="pl-c1">...</span>   
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">12</span><span class="pl-k">-</span><span class="pl-c1">22</span>    <span class="pl-c1">0.000369</span>
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">12</span><span class="pl-k">-</span><span class="pl-c1">23</span>    <span class="pl-c1">0.900885</span>
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">12</span><span class="pl-k">-</span><span class="pl-c1">24</span>   <span class="pl-k">-</span><span class="pl-c1">0.454869</span>
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">12</span><span class="pl-k">-</span><span class="pl-c1">25</span>   <span class="pl-k">-</span><span class="pl-c1">0.864547</span>
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">12</span><span class="pl-k">-</span><span class="pl-c1">26</span>    <span class="pl-c1">1.129120</span>
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">12</span><span class="pl-k">-</span><span class="p
3ff8
l-c1">27</span>    <span class="pl-c1">0.057874</span>
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">12</span><span class="pl-k">-</span><span class="pl-c1">28</span>   <span class="pl-k">-</span><span class="pl-c1">0.433739</span>
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">12</span><span class="pl-k">-</span><span class="pl-c1">29</span>    <span class="pl-c1">0.092698</span>
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">12</span><span class="pl-k">-</span><span class="pl-c1">30</span>   <span class="pl-k">-</span><span class="pl-c1">1.397820</span>
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">12</span><span class="pl-k">-</span><span class="pl-c1">31</span>    <span class="pl-c1">1.457823</span>
Freq: D, Length: <span class="pl-c1">365</span>, dtype: float64</pre></div>
<p>这里，字符串“2001”被解释成年，并根据它选取时间区间。指定月也同样奏效：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">55</span>]: longer_ts[<span class="pl-s"><span class="pl-pds">'</span>2001-05<span class="pl-pds">'</span></span>]
Out[<span class="pl-c1">55</span>]: 
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.622547</span>
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span>    <span class="pl-c1">0.936289</span>
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span>    <span class="pl-c1">0.750018</span>
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">4</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.056715</span>
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span>    <span class="pl-c1">2.300675</span>
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">6</span></span>    <span class="pl-c1">0.569497</span>
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">7</span></span>    <span class="pl-c1">1.489410</span>
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">8</span></span>    <span class="pl-c1">1.264250</span>
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">9</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.761837</span>
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span><span class="pl-k">-</span><span class="pl-c1">10</span>   <span class="pl-k">-</span><span class="pl-c1">0.331617</span>
                <span class="pl-c1">...</span>   
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span><span class="pl-k">-</span><span class="pl-c1">22</span>    <span class="pl-c1">0.503699</span>
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span><span class="pl-k">-</span><span class="pl-c1">23</span>   <span class="pl-k">-</span><span class="pl-c1">1.387874</span>
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span><span class="pl-k">-</span><span class="pl-c1">24</span>    <span class="pl-c1">0.204851</span>
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span><span class="pl-k">-</span><span class="pl-c1">25</span>    <span class="pl-c1">0.603705</span>
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span><span class="pl-k">-</span><span class="pl-c1">26</span>    <span class="pl-c1">0.545680</span>
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span><span class="pl-k">-</span><span class="pl-c1">27</span>    <span class="pl-c1">0.235477</span>
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span><span class="pl-k">-</span><span class="pl-c1">28</span>    <span class="pl-c1">0.111835</span>
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span><span class="pl-k">-</span><span class="pl-c1">29</span>   <span class="pl-k">-</span><span class="pl-c1">1.251504</span>
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span><span class="pl-k">-</span><span class="pl-c1">30</span>   <span class="pl-k">-</span><span class="pl-c1">2.949343</span>
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span><span class="pl-k">-</span><span class="pl-c1">31</span>    <span class="pl-c1">0.634634</span>
Freq: D, Length: <span class="pl-c1">31</span>, dtype: float64</pre></div>
<p>datetime对象也可以进行切片：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">56</span>]: ts[datetime(<span class="pl-c1">2011</span>, <span class="pl-c1">1</span>, <span class="pl-c1">7</span>):]
Out[<span class="pl-c1">56</span>]: 
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">7</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.519439</span>
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">8</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.555730</span>
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">10</span>    <span class="pl-c1">1.965781</span>
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">12</span>    <span class="pl-c1">1.393406</span>
dtype: float64</pre></div>
<p>由于大部分时间序列数据都是按照时间先后排序的，因此你也可以用不存在于该时间序列中的时间戳对其进行切片（即范围查询）：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">57</span>]: ts
Out[<span class="pl-c1">57</span>]: 
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.204708</span>
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span>    <span class="pl-c1">0.478943</span>
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">7</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.519439</span>
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">8</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.555730</span>
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">10</span>    <span class="pl-c1">1.965781</span>
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">12</span>    <span class="pl-c1">1.393406</span>
dtype: float64

In [<span class="pl-c1">58</span>]: ts[<span class="pl-s"><span class="pl-pds">'</span>1/6/2011<span class="pl-pds">'</span></span>:<span class="pl-s"><span class="pl-pds">'</span>1/11/2011<span class="pl-pds">'</span></span>]
Out[<span class="pl-c1">58</span>]: 
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">7</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.519439</span>
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">8</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.555730</span>
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">10</span>    <span class="pl-c1">1.965781</span>
dtype: float64</pre></div>
<p>跟之前一样，你可以传入字符串日期、datetime或Timestamp。注意，这样切片所产生的是原时间序列的视图，跟NumPy数组的切片运算是一样的。</p>
<p>这意味着，没有数据被复制，对切片进行修改会反映到原始数据上。</p>
<p>此外，还有一个等价的实例方法也可以截取两个日期之间TimeSeries：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">59</span>]: ts.truncate(<span class="pl-v">after</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>1/9/2011<span class="pl-pds">'</span></span>)
Out[<span class="pl-c1">59</span>]: 
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.204708</span>
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span>    <span class="pl-c1">0.478943</span>
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">7</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.519439</span>
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">8</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.555730</span>
dtype: float64</pre></div>
<p>面这些操作对DataFrame也有效。例如，对DataFrame的行进行索引：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">60</span>]: dates <span class="pl-k">=</span> pd.date_range(<span class="pl-s"><span class="pl-pds">'</span>1/1/2000<span class="pl-pds">'</span></span>, <span class="pl-v">periods</span><span class="pl-k">=</span><span class="pl-c1">100</span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>W-WED<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">61</span>]: long_df <span class="pl-k">=</span> pd.DataFrame(np.random.randn(<span class="pl-c1">100</span>, <span class="pl-c1">4</span>),
   <span class="pl-c1">...</span>.:                        <span class="pl-v">index</span><span class="pl-k">=</span>dates,
   <span class="pl-c1">...</span>.:                        <span class="pl-v">columns</span><span class="pl-k">=</span>[<span class="pl-s"><span class="pl-pds">'</span>Colorado<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Texas<span class="pl-pds">'</span></span>,
   <span class="pl-c1">...</span>.:                                 <span class="pl-s"><span class="pl-pds">'</span>New York<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Ohio<span class="pl-pds">'</span></span>])

In [<span class="pl-c1">62</span>]: long_df.loc[<span class="pl-s"><span class="pl-pds">'</span>5-2001<span class="pl-pds">'</span></span>]
Out[<span class="pl-c1">62</span>]: 
            Colorado     Texas  New York      Ohio
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span> <span class="pl-k">-</span><span class="pl-c1">0.006045</span>  <span class="pl-c1">0.490094</span> <span class="pl-k">-</span><span class="pl-c1">0.277186</span> <span class="pl-k">-</span><span class="pl-c1">0.707213</span>
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">9</span></span> <span class="pl-k">-</span><span class="pl-c1">0.560107</span>  <span class="pl-c1">2.735527</span>  <span class="pl-c1">0.927335</span>  <span class="pl-c1">1.513906</span>
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span><span class="pl-k">-</span><span class="pl-c1">16</span>  <span class="pl-c1">0.538600</span>  <span class="pl-c1">1.273768</span>  <span class="pl-c1">0.667876</span> <span class="pl-k">-</span><span class="pl-c1">0.969206</span>
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span><span class="pl-k">-</span><span class="pl-c1">23</span>  <span class="pl-c1">1.676091</span> <span class="pl-k">-</span><span class="pl-c1">0.817649</span>  <span class="pl-c1">0.050188</span>  <span class="pl-c1">1.951312</span>
<span class="pl-c1">2001</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span><span class="pl-k">-</span><span class="pl-c1">30</span>  <span class="pl-c1">3.260383</span>  <span class="pl-c1">0.963301</span>  <span class="pl-c1">1.201206</span> <span class="pl-k">-</span><span class="pl-c1">1.852001</span></pre></div>
<h2><a id="user-content-带有重复索引的时间序列" class="anchor" aria-hidden="true" href="#带有重复索引的时间序列"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>带有重复索引的时间序列</h2>
<p>在某些应用场景中，可能会存在多个观测数据落在同一个时间点上的情况。下面就是一个例子：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">63</span>]: dates <span class="pl-k">=</span> pd.DatetimeIndex([<span class="pl-s"><span class="pl-pds">'</span>1/1/2000<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>1/2/2000<span class="pl-pds">'</spa
4000
n></span>, <span class="pl-s"><span class="pl-pds">'</span>1/2/2000<span class="pl-pds">'</span></span>,
   <span class="pl-c1">...</span>.:                           <span class="pl-s"><span class="pl-pds">'</span>1/2/2000<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>1/3/2000<span class="pl-pds">'</span></span>])
In [<span class="pl-c1">64</span>]: dup_ts <span class="pl-k">=</span> pd.Series(np.arange(<span class="pl-c1">5</span>), <span class="pl-v">index</span><span class="pl-k">=</span>dates)

In [<span class="pl-c1">65</span>]: dup_ts
Out[<span class="pl-c1">65</span>]: 
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span>    <span class="pl-c1">0</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span>    <span class="pl-c1">1</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span>    <span class="pl-c1">2</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span>    <span class="pl-c1">3</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span>    <span class="pl-c1">4</span>
dtype: int64</pre></div>
<p>通过检查索引的is_unique属性，我们就可以知道它是不是唯一的：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">66</span>]: dup_ts.index.is_unique
Out[<span class="pl-c1">66</span>]: <span class="pl-c1">False</span></pre></div>
<p>对这个时间序列进行索引，要么产生标量值，要么产生切片，具体要看所选的时间点是否重复：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">67</span>]: dup_ts[<span class="pl-s"><span class="pl-pds">'</span>1/3/2000<span class="pl-pds">'</span></span>]  <span class="pl-c"><span class="pl-c">#</span> not duplicated</span>
Out[<span class="pl-c1">67</span>]: <span class="pl-c1">4</span>

In [<span class="pl-c1">68</span>]: dup_ts[<span class="pl-s"><span class="pl-pds">'</span>1/2/2000<span class="pl-pds">'</span></span>]  <span class="pl-c"><span class="pl-c">#</span> duplicated</span>
Out[<span class="pl-c1">68</span>]: 
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span>    <span class="pl-c1">1</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span>    <span class="pl-c1">2</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span>    <span class="pl-c1">3</span>
dtype: int64</pre></div>
<p>假设你想要对具有非唯一时间戳的数据进行聚合。一个办法是使用groupby，并传入level=0：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">69</span>]: grouped <span class="pl-k">=</span> dup_ts.groupby(<span class="pl-v">level</span><span class="pl-k">=</span><span class="pl-c1">0</span>)

In [<span class="pl-c1">70</span>]: grouped.mean()
Out[<span class="pl-c1">70</span>]: 
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span>    <span class="pl-c1">0</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span>    <span class="pl-c1">2</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span>    <span class="pl-c1">4</span>
dtype: int64

In [<span class="pl-c1">71</span>]: grouped.count()
Out[<span class="pl-c1">71</span>]: 
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span>    <span class="pl-c1">1</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span>    <span class="pl-c1">3</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span>    <span class="pl-c1">1</span>
dtype: int64</pre></div>
<h1><a id="user-content-113-日期的范围频率以及移动" class="anchor" aria-hidden="true" href="#113-日期的范围频率以及移动"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>11.3 日期的范围、频率以及移动</h1>
<p>pandas中的原生时间序列一般被认为是不规则的，也就是说，它们没有固定的频率。对于大部分应用程序而言，这是无所谓的。但是，它常常需要以某种相对固定的频率进行分析，比如每日、每月、每15分钟等（这样自然会在时间序列中引入缺失值）。幸运的是，pandas有一整套标准时间序列频率以及用于重采样、频率推断、生成固定频率日期范围的工具。例如，我们可以将之前那个时间序列转换为一个具有固定频率（每日）的时间序列，只需调用resample即可：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">72</span>]: ts
Out[<span class="pl-c1">72</span>]: 
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.204708</span>
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span>    <span class="pl-c1">0.478943</span>
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">7</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.519439</span>
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">8</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.555730</span>
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">10</span>    <span class="pl-c1">1.965781</span>
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">12</span>    <span class="pl-c1">1.393406</span>
dtype: float64

In [<span class="pl-c1">73</span>]: resampler <span class="pl-k">=</span> ts.resample(<span class="pl-s"><span class="pl-pds">'</span>D<span class="pl-pds">'</span></span>)</pre></div>
<p>字符串“D”是每天的意思。</p>
<p>频率的转换（或重采样）是一个比较大的主题，稍后将专门用一节来进行讨论（11.6小节）。这里，我将告诉你如何使用基本的频率和它的倍数。</p>
<h2><a id="user-content-生成日期范围" class="anchor" aria-hidden="true" href="#生成日期范围"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>生成日期范围</h2>
<p>虽然我之前用的时候没有明说，但你可能已经猜到pandas.date_range可用于根据指定的频率生成指定长度的DatetimeIndex：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">74</span>]: index <span class="pl-k">=</span> pd.date_range(<span class="pl-s"><span class="pl-pds">'</span>2012-04-01<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-06-01<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">75</span>]: index
Out[<span class="pl-c1">75</span>]: 
DatetimeIndex([<span class="pl-s"><span class="pl-pds">'</span>2012-04-01<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-04-02<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-04-03<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-04-04<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2012-04-05<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-04-06<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-04-07<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-04-08<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2012-04-09<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-04-10<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-04-11<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-04-12<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2012-04-13<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-04-14<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-04-15<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-04-16<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2012-04-17<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-04-18<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-04-19<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-04-20<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2012-04-21<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-04-22<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-04-23<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-04-24<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2012-04-25<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-04-26<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-04-27<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-04-28<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2012-04-29<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-04-30<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-01<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-02<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2012-05-03<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-04<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-05<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-06<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2012-05-07<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-08<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-09<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-10<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2012-05-11<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-12<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-13<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-14<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2012-05-15<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-16<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-17<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-18<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2012-05-19<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-20<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-21<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-22<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2012-05-23<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-24<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-25<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-26<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2012-05-27<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-28<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-29<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-30<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2012-05-31<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-06-01<span class="pl-pds">'</span></span>],
              <span class="pl-v">dtype</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>datetime64[ns]<span class="pl-pds">'</span></span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s
35b4
"><span class="pl-pds">'</span>D<span class="pl-pds">'</span></span>)</pre></div>
<p>默认情况下，date_range会产生按天计算的时间点。如果只传入起始或结束日期，那就还得传入一个表示一段时间的数字：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">76</span>]: pd.date_range(<span class="pl-v">start</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>2012-04-01<span class="pl-pds">'</span></span>, <span class="pl-v">periods</span><span class="pl-k">=</span><span class="pl-c1">20</span>)
Out[<span class="pl-c1">76</span>]: 
DatetimeIndex([<span class="pl-s"><span class="pl-pds">'</span>2012-04-01<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-04-02<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-04-03<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-04-04<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2012-04-05<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-04-06<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-04-07<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-04-08<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2012-04-09<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-04-10<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-04-11<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-04-12<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2012-04-13<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-04-14<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-04-15<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-04-16<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2012-04-17<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-04-18<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-04-19<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-04-20<span class="pl-pds">'</span></span>],
              <span class="pl-v">dtype</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>datetime64[ns]<span class="pl-pds">'</span></span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>D<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">77</span>]: pd.date_range(<span class="pl-v">end</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>2012-06-01<span class="pl-pds">'</span></span>, <span class="pl-v">periods</span><span class="pl-k">=</span><span class="pl-c1">20</span>)
Out[<span class="pl-c1">77</span>]: 
DatetimeIndex([<span class="pl-s"><span class="pl-pds">'</span>2012-05-13<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-14<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-15<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-16<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2012-05-17<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-18<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-19<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-20<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2012-05-21<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-22<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-23<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-24<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2012-05-25<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-26<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-27<span class="pl-pds">'</span></span>,<span class="pl-s"><span class="pl-pds">'</span>2012-05-28<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2012-05-29<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-30<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-31<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-06-01<span class="pl-pds">'</span></span>],
              <span class="pl-v">dtype</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>datetime64[ns]<span class="pl-pds">'</span></span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>D<span class="pl-pds">'</span></span>)</pre></div>
<p>起始和结束日期定义了日期索引的严格边界。例如，如果你想要生成一个由每月最后一个工作日组成的日期索引，可以传入"BM"频率（表示business end of month，表11-4是频率列表），这样就只会包含时间间隔内（或刚好在边界上的）符合频率要求的日期：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">78</span>]: pd.date_range(<span class="pl-s"><span class="pl-pds">'</span>2000-01-01<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2000-12-01<span class="pl-pds">'</span></span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>BM<span class="pl-pds">'</span></span>)
Out[<span class="pl-c1">78</span>]: 
DatetimeIndex([<span class="pl-s"><span class="pl-pds">'</span>2000-01-31<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2000-02-29<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2000-03-31<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2000-04-28<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2000-05-31<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2000-06-30<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2000-07-31<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2000-08-31<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2000-09-29<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2000-10-31<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2000-11-30<span class="pl-pds">'</span></span>],
              <span class="pl-v">dtype</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>datetime64[ns]<span class="pl-pds">'</span></span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>BM<span class="pl-pds">'</span></span>)</pre></div>
<p>表11-4 基本的时间序列频率（不完整）</p>
<p><a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/a6be2c24dcd3db7deb39f571cc273ec41fbb15ba/687474703a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d633836313464646264313037393363612e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430"><img src="https://camo.githubusercontent.com/a6be2c24dcd3db7deb39f571cc273ec41fbb15ba/687474703a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d633836313464646264313037393363612e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430" alt="" data-canonical-src="http://upload-images.jianshu.io/upload_images/7178691-c8614ddbd10793ca.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="max-width:100%;"></a></p>
<p><a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/571e975181671e1ababd22035ec082c5f724d075/687474703a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d386461343662613936353434623037312e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430"><img src="https://camo.githubusercontent.com/571e975181671e1ababd22035ec082c5f724d075/687474703a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d386461343662613936353434623037312e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430" alt="" data-canonical-src="http://upload-images.jianshu.io/upload_images/7178691-8da46ba96544b071.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="max-width:100%;"></a></p>
<p><a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/e6a53cd190932b0f2b6a8e8ab8bdb067afeb458b/687474703a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d336361343130363039313935656463342e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430"><img src="https://camo.githubusercontent.com/e6a53cd190932b0f2b6a8e8ab8bdb067afeb458b/687474703a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d336361343130363039313935656463342e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430" alt="" data-canonical-src="http://upload-images.jianshu.io/upload_images/7178691-3ca410609195edc4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="max-width:100%;"></a></p>
<p>date_range默认会保留起始和结束时间戳的时间信息（如果有的话）：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">79</span>]: pd.date_range(<span class="pl-s"><span class="pl-pds">'</span>2012-05-02 12:56:31<span class="pl-pds">'</span></span>, <span class="pl-v">periods</span><span class="pl-k">=</span><span class="pl-c1">5</span>)
Out[<span class="pl-c1">79</span>]: 
DatetimeIndex([<span class="pl-s"><span class="pl-pds">'</span>2012-05-02 12:56:31<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-03 12:56:31<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2012-05-04 12:56:31<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-05 12:56:31<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2012-05-06 12:56:31<span class="pl-pds">'</span></span>],
              <span class="pl-v">dtype</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>datetime64[ns]<span class="pl-pds">'</span></span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>D<span class="pl-pds">'</span></span>)</pre></div>
<p>有时，虽然起始和结束日期带有时间信息，但你希望产生一组被规范化（normalize）到午夜的时间戳。normalize选项即可实现该功能：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">80</span>]: pd.date_range(<span class="pl-s"><span class="pl-pds">'</span>2012-05-02 12:56:31<span class="pl-pds">'</span></span>, <span class="pl-v">periods</span><span class="pl-k">=</span><span class="pl-c1">5</span>, <span class="pl-v">normalize</span><span class="pl-k">=</span><span class="pl-c1">True</span>)
Out[<span class="pl-c1">80</span>]: 
DatetimeIndex([<span class="pl-s"><span class="pl-pds">'</span>2012-05-02<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-03<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-04<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-05-05<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2012-05-06<span class="pl-pds">'</span></span>],
              <span class="pl-v">dtype</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>datetime64[ns]<span class="pl-pds">'</span></span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>D<span class="pl-pds">'</span></span>)</pre></div>
<h2><a id="user-content-频率和日期偏移量" class="anchor" aria-hidden="true" href="#频率和日期偏移量"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-
4000
.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>频率和日期偏移量</h2>
<p>pandas中的频率是由一个基础频率（base frequency）和一个乘数组成的。基础频率通常以一个字符串别名表示，比如"M"表示每月，"H"表示每小时。对于每个基础频率，都有一个被称为日期偏移量（date offset）的对象与之对应。例如，按小时计算的频率可以用Hour类表示：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">81</span>]: <span class="pl-k">from</span> pandas.tseries.offsets <span class="pl-k">import</span> Hour, Minute

In [<span class="pl-c1">82</span>]: hour <span class="pl-k">=</span> Hour()

In [<span class="pl-c1">83</span>]: hour
Out[<span class="pl-c1">83</span>]: <span class="pl-k">&lt;</span>Hour<span class="pl-k">&gt;</span></pre></div>
<p>传入一个整数即可定义偏移量的倍数：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">84</span>]: four_hours <span class="pl-k">=</span> Hour(<span class="pl-c1">4</span>)

In [<span class="pl-c1">85</span>]: four_hours
Out[<span class="pl-c1">85</span>]: <span class="pl-k">&lt;</span><span class="pl-c1">4</span> <span class="pl-k">*</span> Hours<span class="pl-k">&gt;</span></pre></div>
<p>一般来说，无需明确创建这样的对象，只需使用诸如"H"或"4H"这样的字符串别名即可。在基础频率前面放上一个整数即可创建倍数：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">86</span>]: pd.date_range(<span class="pl-s"><span class="pl-pds">'</span>2000-01-01<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2000-01-03 23:59<span class="pl-pds">'</span></span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>4h<span class="pl-pds">'</span></span>)
Out[<span class="pl-c1">86</span>]: 
DatetimeIndex([<span class="pl-s"><span class="pl-pds">'</span>2000-01-01 00:00:00<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2000-01-01 04:00:00<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2000-01-01 08:00:00<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2000-01-01 12:00:00<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2000-01-01 16:00:00<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2000-01-01 20:00:00<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2000-01-02 00:00:00<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2000-01-02 04:00:00<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2000-01-02 08:00:00<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2000-01-02 12:00:00<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2000-01-02 16:00:00<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2000-01-02 20:00:00<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2000-01-03 00:00:00<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2000-01-03 04:00:00<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2000-01-03 08:00:00<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2000-01-03 12:00:00<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2000-01-03 16:00:00<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2000-01-03 20:00:00<span class="pl-pds">'</span></span>],
              <span class="pl-v">dtype</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>datetime64[ns]<span class="pl-pds">'</span></span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>4H<span class="pl-pds">'</span></span>)</pre></div>
<p>大部分偏移量对象都可通过加法进行连接：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">87</span>]: Hour(<span class="pl-c1">2</span>) <span class="pl-k">+</span> Minute(<span class="pl-c1">30</span>)
Out[<span class="pl-c1">87</span>]: <span class="pl-k">&lt;</span><span class="pl-c1">150</span> <span class="pl-k">*</span> Minutes<span class="pl-k">&gt;</span></pre></div>
<p>同理，你也可以传入频率字符串（如"2h30min"），这种字符串可以被高效地解析为等效的表达式：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">88</span>]: pd.date_range(<span class="pl-s"><span class="pl-pds">'</span>2000-01-01<span class="pl-pds">'</span></span>, <span class="pl-v">periods</span><span class="pl-k">=</span><span class="pl-c1">10</span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>1h30min<span class="pl-pds">'</span></span>)
Out[<span class="pl-c1">88</span>]: 
DatetimeIndex([<span class="pl-s"><span class="pl-pds">'</span>2000-01-01 00:00:00<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2000-01-01 01:30:00<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2000-01-01 03:00:00<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2000-01-01 04:30:00<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2000-01-01 06:00:00<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2000-01-01 07:30:00<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2000-01-01 09:00:00<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2000-01-01 10:30:00<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2000-01-01 12:00:00<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2000-01-01 13:30:00<span class="pl-pds">'</span></span>],
              <span class="pl-v">dtype</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>datetime64[ns]<span class="pl-pds">'</span></span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>90T<span class="pl-pds">'</span></span>)</pre></div>
<p>有些频率所描述的时间点并不是均匀分隔的。例如，"M"（日历月末）和"BM"（每月最后一个工作日）就取决于每月的天数，对于后者，还要考虑月末是不是周末。由于没有更好的术语，我将这些称为锚点偏移量（anchored offset）。</p>
<p>表11-4列出了pandas中的频率代码和日期偏移量类。</p>
<blockquote>
<p>笔记：用户可以根据实际需求自定义一些频率类以便提供pandas所没有的日期逻辑，但具体的细节超出了本书的范围。</p>
</blockquote>
<p>表11-4 时间序列的基础频率</p>
<p><a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/391f085b44026808a45eb852f0446e6ac8e46c08/687474703a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d666631333933313263643937323230342e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430"><img src="https://camo.githubusercontent.com/391f085b44026808a45eb852f0446e6ac8e46c08/687474703a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d666631333933313263643937323230342e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430" alt="" data-canonical-src="http://upload-images.jianshu.io/upload_images/7178691-ff139312cd972204.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="max-width:100%;"></a></p>
<p><a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/54b31bf8cfd6da3f1790624844b933bbdccb18fb/687474703a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d616466613537613939386330323936652e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430"><img src="https://camo.githubusercontent.com/54b31bf8cfd6da3f1790624844b933bbdccb18fb/687474703a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d616466613537613939386330323936652e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430" alt="" data-canonical-src="http://upload-images.jianshu.io/upload_images/7178691-adfa57a998c0296e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="max-width:100%;"></a></p>
<p><a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/634e9b2512cda7b42623a96b069a8c422cfe7e35/687474703a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d643039653537376131306430653665622e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430"><img src="https://camo.githubusercontent.com/634e9b2512cda7b42623a96b069a8c422cfe7e35/687474703a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d643039653537376131306430653665622e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430" alt="" data-canonical-src="http://upload-images.jianshu.io/upload_images/7178691-d09e577a10d0e6eb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="max-width:100%;"></a></p>
<h2><a id="user-content-wom日期" class="anchor" aria-hidden="true" href="#wom日期"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>WOM日期</h2>
<p>WOM（Week Of Month）是一种非常实用的频率类，它以WOM开头。它使你能获得诸如“每月第3个星期五”之类的日期：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">89</span>]: rng <span class="pl-k">=</span> pd.date_range(<span class="pl-s"><span class="pl-pds">'</span>2012-01-01<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-09-01<span class="pl-pds">'</span></span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>WOM-3FRI<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">90</span>]: <span class="pl-c1">list</span>(rng)
Out[<span class="pl-c1">90</span>]: 
[Timestamp(<span class="pl-s"><span class="pl-pds">'</span>2012-01-20 00:00:00<span class="pl-pds">'</span></span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>WOM-3FRI<span class="pl-pds">'</span></span>),
 Timestamp(<span class="pl-s"><span class="pl-pds">'</span>2012-02-17 00:00:00<span class="pl-pds">'</span></span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>WOM-3FRI<span class="pl-pds">'</span></span>),
 Timestamp(<span class="pl-s"><span class="pl-pds">'</span>2012-03-16 00:00:00<span class="pl-pds">'</span></span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>WOM-3FRI<span class="pl-pds">'</span></span>),
 Timestamp(<span class="pl-s"><span class="pl-pds">'</span>2012-04-20 00:00:00<span class="pl-pds">'</span></span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>WOM-3FRI<span class="pl-pds">'</span></span>),
 Timestamp(<span class="pl-s"><span class="pl-pds">'</span>2012-05-18 00:00:00<span class="pl-pds">'</span></span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>WOM-3FRI<span class="pl-pds">'</span></span>),
 Timestamp(<span class="pl-s"><span class="pl-pds">'</span>2012-06-15 00:00:00<span class="pl-pds">'</span></span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>WOM-3FRI<span class="pl-pds">'</span></span>),
 Timestamp(<span class="pl-s"><span class="pl-pds">'</span>2012-07-20 00:00:00<span class="pl-pds">'</span></span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>WOM-3FRI<span class="pl-pds">'</span></span>),
 Timestamp(<span class="pl-s"><span class="pl-pds">'</span>2012-08-17 00:00:00<span class="pl-pds">'</span></span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>WOM-3FRI<span class="pl-pds">'</span></span>)]</pre></div>
<h2><a id="user-content-移动超前和滞后数据" class="anchor" aria-hidden="true" href="#移动超前和滞后数据"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>移动（超前和滞后）数据</h2>
<p>移动（shifting）指的是沿着时间轴将数据前移或后移。Series和DataFrame都有一个shift方法用于执行单纯的前移或后移操作，保持索引不变：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">91</span>]: ts <span class="pl-k">=</span> pd.Series(np.random.randn(<span class="pl-c1">4</span>),
   <span class="pl-c1">...</span>.:                <span class="pl-v">index</span><span class="pl-k">=</span>pd.date_range(<span class="pl-s"><span class="pl-pds">'</span>1/1/2000<span class="pl-pds">'</span></span>, <span class="pl-v">periods</span><span class="pl-k">=</span><span class="pl-c1">4</span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>M<span class="pl-pds">'</span></span>))

In [<span class="pl-c1">92</span>]: ts
Out[<span class="pl-c1">92</span>]: 
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">31</span>   <span class="pl-k">-</span><span class="pl-c1">0.066748</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span><span class="pl-k">-</span><span class="pl-c1">29</span>    <span class="pl-c1">0.838639</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">31</span>   <span class="pl-k">-</span><span class="pl-c1">0.117388</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">4</span></span><span class="pl-k">-</span><span class="pl-c1">30</span>   <span class="pl-k">-</span><span class="pl-c1">0.517795</span>
Freq: M, dtype: float64

In [<span class="pl-c1">93</span>]: ts.shift(<span class="pl-c1
3ff8
">2</span>)
Out[<span class="pl-c1">93</span>]: 
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">31</span>         NaN
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span><span class="pl-k">-</span><span class="pl-c1">29</span>         NaN
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">31</span>   <span class="pl-k">-</span><span class="pl-c1">0.066748</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">4</span></span><span class="pl-k">-</span><span class="pl-c1">30</span>    <span class="pl-c1">0.838639</span>
Freq: M, dtype: float64

In [<span class="pl-c1">94</span>]: ts.shift(<span class="pl-k">-</span><span class="pl-c1">2</span>)
Out[<span class="pl-c1">94</span>]: 
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">31</span>   <span class="pl-k">-</span><span class="pl-c1">0.117388</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span><span class="pl-k">-</span><span class="pl-c1">29</span>   <span class="pl-k">-</span><span class="pl-c1">0.517795</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">31</span>         NaN
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">4</span></span><span class="pl-k">-</span><span class="pl-c1">30</span>         NaN
Freq: M, dtype: float64</pre></div>
<p>当我们这样进行移动时，就会在时间序列的前面或后面产生缺失数据。</p>
<p>shift通常用于计算一个时间序列或多个时间序列（如DataFrame的列）中的百分比变化。可以这样表达：</p>
<div class="highlight highlight-source-python"><pre>ts <span class="pl-k">/</span> ts.shift(<span class="pl-c1">1</span>) <span class="pl-k">-</span> <span class="pl-c1">1</span></pre></div>
<p>由于单纯的移位操作不会修改索引，所以部分数据会被丢弃。因此，如果频率已知，则可以将其传给shift以便实现对时间戳进行位移而不是对数据进行简单位移：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">95</span>]: ts.shift(<span class="pl-c1">2</span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>M<span class="pl-pds">'</span></span>)
Out[<span class="pl-c1">95</span>]: 
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">31</span>   <span class="pl-k">-</span><span class="pl-c1">0.066748</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">4</span></span><span class="pl-k">-</span><span class="pl-c1">30</span>    <span class="pl-c1">0.838639</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span><span class="pl-k">-</span><span class="pl-c1">31</span>   <span class="pl-k">-</span><span class="pl-c1">0.117388</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">6</span></span><span class="pl-k">-</span><span class="pl-c1">30</span>   <span class="pl-k">-</span><span class="pl-c1">0.517795</span>
Freq: M, dtype: float64</pre></div>
<p>这里还可以使用其他频率，于是你就能非常灵活地对数据进行超前和滞后处理了：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">96</span>]: ts.shift(<span class="pl-c1">3</span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>D<span class="pl-pds">'</span></span>)
Out[<span class="pl-c1">96</span>]: 
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.066748</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span>    <span class="pl-c1">0.838639</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">4</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.117388</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.517795</span>
dtype: float64

In [<span class="pl-c1">97</span>]: ts.shift(<span class="pl-c1">1</span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>90T<span class="pl-pds">'</span></span>)
Out[<span class="pl-c1">97</span>]: 
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">31</span> <span class="pl-c1">0<span class="pl-ii">1</span></span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span>   <span class="pl-k">-</span><span class="pl-c1">0.066748</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span><span class="pl-k">-</span><span class="pl-c1">29</span> <span class="pl-c1">0<span class="pl-ii">1</span></span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span>    <span class="pl-c1">0.838639</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">31</span> <span class="pl-c1">0<span class="pl-ii">1</span></span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span>   <span class="pl-k">-</span><span class="pl-c1">0.117388</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">4</span></span><span class="pl-k">-</span><span class="pl-c1">30</span> <span class="pl-c1">0<span class="pl-ii">1</span></span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span>   <span class="pl-k">-</span><span class="pl-c1">0.517795</span>
Freq: M, dtype: float64</pre></div>
<h2><a id="user-content-通过偏移量对日期进行位移" class="anchor" aria-hidden="true" href="#通过偏移量对日期进行位移"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>通过偏移量对日期进行位移</h2>
<p>pandas的日期偏移量还可以用在datetime或Timestamp对象上：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">98</span>]: <span class="pl-k">from</span> pandas.tseries.offsets <span class="pl-k">import</span> Day, MonthEnd

In [<span class="pl-c1">99</span>]: now <span class="pl-k">=</span> datetime(<span class="pl-c1">2011</span>, <span class="pl-c1">11</span>, <span class="pl-c1">17</span>)

In [<span class="pl-c1">100</span>]: now <span class="pl-k">+</span> <span class="pl-c1">3</span> <span class="pl-k">*</span> Day()
Out[<span class="pl-c1">100</span>]: Timestamp(<span class="pl-s"><span class="pl-pds">'</span>2011-11-20 00:00:00<span class="pl-pds">'</span></span>)</pre></div>
<p>如果加的是锚点偏移量（比如MonthEnd），第一次增量会将原日期向前滚动到符合频率规则的下一个日期：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">101</span>]: now <span class="pl-k">+</span> MonthEnd()
Out[<span class="pl-c1">101</span>]: Timestamp(<span class="pl-s"><span class="pl-pds">'</span>2011-11-30 00:00:00<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">102</span>]: now <span class="pl-k">+</span> MonthEnd(<span class="pl-c1">2</span>)
Out[<span class="pl-c1">102</span>]: Timestamp(<span class="pl-s"><span class="pl-pds">'</span>2011-12-31 00:00:00<span class="pl-pds">'</span></span>)</pre></div>
<p>通过锚点偏移量的rollforward和rollback方法，可明确地将日期向前或向后“滚动”：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">103</span>]: offset <span class="pl-k">=</span> MonthEnd()

In [<span class="pl-c1">104</span>]: offset.rollforward(now)
Out[<span class="pl-c1">104</span>]: Timestamp(<span class="pl-s"><span class="pl-pds">'</span>2011-11-30 00:00:00<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">105</span>]: offset.rollback(now)
Out[<span class="pl-c1">105</span>]: Timestamp(<span class="pl-s"><span class="pl-pds">'</span>2011-10-31 00:00:00<span class="pl-pds">'</span></span>)</pre></div>
<p>日期偏移量还有一个巧妙的用法，即结合groupby使用这两个“滚动”方法：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">106</span>]: ts <span class="pl-k">=</span> pd.Series(np.random.randn(<span class="pl-c1">20</span>),
   <span class="pl-c1">...</span>..:                <span class="pl-v">index</span><span class="pl-k">=</span>pd.date_range(<span class="pl-s"><span class="pl-pds">'</span>1/15/2000<span class="pl-pds">'</span></span>, <span class="pl-v">periods</span><span class="pl-k">=</span><span class="pl-c1">20</span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>4d<span class="pl-pds">'</span></span>))

In [<span class="pl-c1">107</span>]: ts
Out[<span class="pl-c1">107</span>]: 
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">15</span>   <span class="pl-k">-</span><span class="pl-c1">0.116696</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">19</span>    <span class="pl-c1">2.389645</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">23</span>   <span class="pl-k">-</span><span class="pl-c1">0.932454</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">27</span>   <span class="pl-k">-</span><span class="pl-c1">0.229331</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">31</span>   <span class="pl-k">-</span><span class="pl-c1">1.140330</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">4</span></span>    <span class="pl-c1">0.439920</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">8</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.823758</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span><span class="pl-k">-</span><span class="pl-c1">12</span>   <span class="pl-k">-</span><span class="pl-c1">0.520930</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span><span class="pl-k">-</span><span class="pl-c1">16</span>    <span class="pl-c1">0.350282</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span><span class="pl-k">-</span><span class="pl-c1">20</span>    <span class="pl-c1">0.204395</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span><span class="pl-k">-</span><span class="pl-c1">24</span>    <span class="pl-c1">0.133445</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span><span class="pl-k">-</span><span class="pl-c1">28</span>    <span class="pl-c1">0.327905</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span>    <span class="pl-c1">0.072153</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">7</span></span>    <span class="pl-c1">0.131678</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">11</span>   <span class="pl-k">-</span><span class="pl-c1">1.297459</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">15</span>    <span class="pl-c1">0.997747</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">19</span>    <span class="pl-c1">0.870955</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">23</span>   <span class="pl-k">-</span><span class="pl-c1">0.991253</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">27</span>    <span class="pl-c1">0.151699</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">31</span>    <span class="pl-c1">1.266151</span>
Freq: <span class="pl-ii">4D</span>, dtype: float64

In [<span class="pl-c1">108</span>]: ts.groupby(offset.rollforward).mean()
Out[<span class="pl-c1">108</span>]: 
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">31</span>   <span class="pl-k">-</span><span class="pl-c1">0.005833</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span><span class="pl-k">-</span><span class="pl-c1">29</span>    <span class="pl-c1">0.015894</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">31</span>    <span class="pl-c1">0.150209</span>
dtype: float64</pre></div>
<p>当然，更简单、更快速地实现该功能的办法是使用resample（11.6小节将对此进行详细介绍）：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">109</span>]: ts.resample(<span class="pl-s"><span class="pl-pds">'</span>M<span class="pl-pds">'</span></span>).mean()
Out[<span class="pl-c1">109</span>]: 
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-
4000
c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">31</span>   <span class="pl-k">-</span><span class="pl-c1">0.005833</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span><span class="pl-k">-</span><span class="pl-c1">29</span>    <span class="pl-c1">0.015894</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">31</span>    <span class="pl-c1">0.150209</span>
Freq: M, dtype: float64</pre></div>
<h1><a id="user-content-114-时区处理" class="anchor" aria-hidden="true" href="#114-时区处理"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>11.4 时区处理</h1>
<p>时间序列处理工作中最让人不爽的就是对时区的处理。许多人都选择以协调世界时（UTC，它是格林尼治标准时间（Greenwich Mean Time）的接替者，目前已经是国际标准了）来处理时间序列。时区是以UTC偏移量的形式表示的。例如，夏令时期间，纽约比UTC慢4小时，而在全年其他时间则比UTC慢5小时。</p>
<p>在Python中，时区信息来自第三方库pytz，它使Python可以使用Olson数据库（汇编了世界时区信息）。这对历史数据非常重要，这是因为由于各地政府的各种突发奇想，夏令时转变日期（甚至UTC偏移量）已经发生过多次改变了。就拿美国来说，DST转变时间自1900年以来就改变过多次！</p>
<p>有关pytz库的更多信息，请查阅其文档。就本书而言，由于pandas包装了pytz的功能，因此你可以不用记忆其API，只要记得时区的名称即可。时区名可以在shell中看到，也可以通过文档查看：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">110</span>]: <span class="pl-k">import</span> pytz

In [<span class="pl-c1">111</span>]: pytz.common_timezones[<span class="pl-k">-</span><span class="pl-c1">5</span>:]
Out[<span class="pl-c1">111</span>]: [<span class="pl-s"><span class="pl-pds">'</span>US/Eastern<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>US/Hawaii<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>US/Mountain<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>US/Pacific<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>UTC<span class="pl-pds">'</span></span>]</pre></div>
<p>要从pytz中获取时区对象，使用pytz.timezone即可：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">112</span>]: tz <span class="pl-k">=</span> pytz.timezone(<span class="pl-s"><span class="pl-pds">'</span>America/New_York<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">113</span>]: tz
Out[<span class="pl-c1">113</span>]: <span class="pl-k">&lt;</span>DstTzInfo <span class="pl-s"><span class="pl-pds">'</span>America/New_York<span class="pl-pds">'</span></span> <span class="pl-c1">LMT</span><span class="pl-k">-</span><span class="pl-c1">1</span> day, <span class="pl-c1">19</span>:<span class="pl-c1">0<span class="pl-ii">4</span></span>:<span class="pl-c1">00</span> <span class="pl-c1">STD</span><span class="pl-k">&gt;</span></pre></div>
<p>pandas中的方法既可以接受时区名也可以接受这些对象。</p>
<h1><a id="user-content-时区本地化和转换" class="anchor" aria-hidden="true" href="#时区本地化和转换"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>时区本地化和转换</h1>
<p>默认情况下，pandas中的时间序列是单纯（naive）的时区。看看下面这个时间序列：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">114</span>]: rng <span class="pl-k">=</span> pd.date_range(<span class="pl-s"><span class="pl-pds">'</span>3/9/2012 9:30<span class="pl-pds">'</span></span>, <span class="pl-v">periods</span><span class="pl-k">=</span><span class="pl-c1">6</span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>D<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">115</span>]: ts <span class="pl-k">=</span> pd.Series(np.random.randn(<span class="pl-c1">len</span>(rng)), <span class="pl-v">index</span><span class="pl-k">=</span>rng)

In [<span class="pl-c1">116</span>]: ts
Out[<span class="pl-c1">116</span>]: 
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">9</span></span> <span class="pl-c1">0<span class="pl-ii">9</span></span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span>   <span class="pl-k">-</span><span class="pl-c1">0.202469</span>
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">10</span> <span class="pl-c1">0<span class="pl-ii">9</span></span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span>    <span class="pl-c1">0.050718</span>
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">11</span> <span class="pl-c1">0<span class="pl-ii">9</span></span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span>    <span class="pl-c1">0.639869</span>
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">12</span> <span class="pl-c1">0<span class="pl-ii">9</span></span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span>    <span class="pl-c1">0.597594</span>
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">13</span> <span class="pl-c1">0<span class="pl-ii">9</span></span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span>   <span class="pl-k">-</span><span class="pl-c1">0.797246</span>
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">14</span> <span class="pl-c1">0<span class="pl-ii">9</span></span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span>    <span class="pl-c1">0.472879</span>
Freq: D, dtype: float64</pre></div>
<p>其索引的tz字段为None：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">117</span>]: <span class="pl-c1">print</span>(ts.index.tz)
<span class="pl-c1">None</span></pre></div>
<p>可以用时区集生成日期范围：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">118</span>]: pd.date_range(<span class="pl-s"><span class="pl-pds">'</span>3/9/2012 9:30<span class="pl-pds">'</span></span>, <span class="pl-v">periods</span><span class="pl-k">=</span><span class="pl-c1">10</span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>D<span class="pl-pds">'</span></span>, <span class="pl-v">tz</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>UTC<span class="pl-pds">'</span></span>)
Out[<span class="pl-c1">118</span>]: 
DatetimeIndex([<span class="pl-s"><span class="pl-pds">'</span>2012-03-09 09:30:00+00:00<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-03-10 09:30:00+00:00<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2012-03-11 09:30:00+00:00<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-03-12 09:30:00+00:00<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2012-03-13 09:30:00+00:00<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-03-14 09:30:00+00:00<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2012-03-15 09:30:00+00:00<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-03-16 09:30:00+00:00<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2012-03-17 09:30:00+00:00<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-03-18 09:30:00+00:00<span class="pl-pds">'</span></span>],
              <span class="pl-v">dtype</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>datetime64[ns, UTC]<span class="pl-pds">'</span></span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>D<span class="pl-pds">'</span></span>)</pre></div>
<p>从单纯到本地化的转换是通过tz_localize方法处理的：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">119</span>]: ts
Out[<span class="pl-c1">119</span>]: 
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">9</span></span> <span class="pl-c1">0<span class="pl-ii">9</span></span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span>   <span class="pl-k">-</span><span class="pl-c1">0.202469</span>
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">10</span> <span class="pl-c1">0<span class="pl-ii">9</span></span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span>    <span class="pl-c1">0.050718</span>
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">11</span> <span class="pl-c1">0<span class="pl-ii">9</span></span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span>    <span class="pl-c1">0.639869</span>
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">12</span> <span class="pl-c1">0<span class="pl-ii">9</span></span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span>    <span class="pl-c1">0.597594</span>
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">13</span> <span class="pl-c1">0<span class="pl-ii">9</span></span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span>   <span class="pl-k">-</span><span class="pl-c1">0.797246</span>
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">14</span> <span class="pl-c1">0<span class="pl-ii">9</span></span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span>    <span class="pl-c1">0.472879</span>
Freq: D, dtype: float64

In [<span class="pl-c1">120</span>]: ts_utc <span class="pl-k">=</span> ts.tz_localize(<span class="pl-s"><span class="pl-pds">'</span>UTC<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">121</span>]: ts_utc
Out[<span class="pl-c1">121</span>]: 
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">9</span></span> <span class="pl-c1">0<span class="pl-ii">9</span></span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span><span class="pl-k">+</span><span class="pl-c1">00</span>:<span class="pl-c1">00</span>   <span class="pl-k">-</span><span class="pl-c1">0.202469</span>
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">10</span> <span class="pl-c1">0<span class="pl-ii">9</span></span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span><span class="pl-k">+</span><span class="pl-c1">00</span>:<span class="pl-c1">00</span>    <span class="pl-c1">0.050718</span>
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">11</span> <span class="pl-c1">0<span class="pl-ii">9</span></span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span><span class="pl-k">+</span><span class="pl-c1">00</span>:<span class="pl-c1">00</span>    <span class="pl-c1">0.639869</span>
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">12</span> <span class="pl-c1">0<span class="pl-ii">9</span></span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span><span class="pl-k">+</span><span class="pl-c1">00</span>:<span class="pl-c1">00</span>    <span class="pl-c1">0.597594</span>
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">13</span> <span class="pl-c1">0<span class="pl-ii">9</span></span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span><span class="pl-k">+</span><span class="pl-c1">00</span>:<span class="pl-c1">00</span>   <span class="pl-k">-</span><span class="pl-c1">0.797246</span>
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">14</span> <span class="pl-c1">0<span class="pl-ii">9</span></span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span><span class="pl-k">+</span><span class="pl-c1">00</span>:<span class="pl-c1">00</span>    <span class="pl-c1">0.472879</span>
Freq: D, dtype: float64

In [<span class="pl-c1">122</span>]: ts_utc.index
Out[<span class="pl-c1">122</span>]: 
DatetimeIndex([<span class="pl-s"><span class="pl-pds">'</span>2012-03-09 09:30:00+00:00<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-03-10 09:30:00+00:00<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2012-03-11 09:30:00+00:00<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-03-12 09:30:00+00:00<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2012-03-13 09:30:00+00:00<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-03-14 09:30:00+00:00<span class="pl-pds">'</span></span>],
              <span class="pl-v">dtype</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>datetime64[ns, UTC]<span class="pl-pds">'</span></span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>D<span class="pl-pds">'</span></span>)</pre></div>
<p>一旦时间序列被本地化到某个特定时区，就可以用tz_convert将其转换到别的时区了：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">123</span>]: ts_utc.tz_convert(<span class="pl-s"><span class="p
3ff8
l-pds">'</span>America/New_York<span class="pl-pds">'</span></span>)
Out[<span class="pl-c1">123</span>]: 
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">9</span></span> <span class="pl-c1">0<span class="pl-ii">4</span></span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span>:<span class="pl-c1">00</span>   <span class="pl-k">-</span><span class="pl-c1">0.202469</span>
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">10</span> <span class="pl-c1">0<span class="pl-ii">4</span></span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span>:<span class="pl-c1">00</span>    <span class="pl-c1">0.050718</span>
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">11</span> <span class="pl-c1">0<span class="pl-ii">5</span></span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">4</span></span>:<span class="pl-c1">00</span>    <span class="pl-c1">0.639869</span>
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">12</span> <span class="pl-c1">0<span class="pl-ii">5</span></span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">4</span></span>:<span class="pl-c1">00</span>    <span class="pl-c1">0.597594</span>
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">13</span> <span class="pl-c1">0<span class="pl-ii">5</span></span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">4</span></span>:<span class="pl-c1">00</span>   <span class="pl-k">-</span><span class="pl-c1">0.797246</span>
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">14</span> <span class="pl-c1">0<span class="pl-ii">5</span></span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">4</span></span>:<span class="pl-c1">00</span>    <span class="pl-c1">0.472879</span>
Freq: D, dtype: float64</pre></div>
<p>对于上面这种时间序列（它跨越了美国东部时区的夏令时转变期），我们可以将其本地化到EST，然后转换为UTC或柏林时间：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">124</span>]: ts_eastern <span class="pl-k">=</span> ts.tz_localize(<span class="pl-s"><span class="pl-pds">'</span>America/New_York<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">125</span>]: ts_eastern.tz_convert(<span class="pl-s"><span class="pl-pds">'</span>UTC<span class="pl-pds">'</span></span>)
Out[<span class="pl-c1">125</span>]: 
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">9</span></span> <span class="pl-c1">14</span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span><span class="pl-k">+</span><span class="pl-c1">00</span>:<span class="pl-c1">00</span>   <span class="pl-k">-</span><span class="pl-c1">0.202469</span>
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">10</span> <span class="pl-c1">14</span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span><span class="pl-k">+</span><span class="pl-c1">00</span>:<span class="pl-c1">00</span>    <span class="pl-c1">0.050718</span>
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">11</span> <span class="pl-c1">13</span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span><span class="pl-k">+</span><span class="pl-c1">00</span>:<span class="pl-c1">00</span>    <span class="pl-c1">0.639869</span>
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">12</span> <span class="pl-c1">13</span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span><span class="pl-k">+</span><span class="pl-c1">00</span>:<span class="pl-c1">00</span>    <span class="pl-c1">0.597594</span>
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">13</span> <span class="pl-c1">13</span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span><span class="pl-k">+</span><span class="pl-c1">00</span>:<span class="pl-c1">00</span>   <span class="pl-k">-</span><span class="pl-c1">0.797246</span>
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">14</span> <span class="pl-c1">13</span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span><span class="pl-k">+</span><span class="pl-c1">00</span>:<span class="pl-c1">00</span>    <span class="pl-c1">0.472879</span>
Freq: D, dtype: float64

In [<span class="pl-c1">126</span>]: ts_eastern.tz_convert(<span class="pl-s"><span class="pl-pds">'</span>Europe/Berlin<span class="pl-pds">'</span></span>)
Out[<span class="pl-c1">126</span>]: 
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">9</span></span> <span class="pl-c1">15</span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span><span class="pl-k">+</span><span class="pl-c1">0<span class="pl-ii">1</span></span>:<span class="pl-c1">00</span>   <span class="pl-k">-</span><span class="pl-c1">0.202469</span>
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">10</span> <span class="pl-c1">15</span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span><span class="pl-k">+</span><span class="pl-c1">0<span class="pl-ii">1</span></span>:<span class="pl-c1">00</span>    <span class="pl-c1">0.050718</span>
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">11</span> <span class="pl-c1">14</span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span><span class="pl-k">+</span><span class="pl-c1">0<span class="pl-ii">1</span></span>:<span class="pl-c1">00</span>    <span class="pl-c1">0.639869</span>
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">12</span> <span class="pl-c1">14</span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span><span class="pl-k">+</span><span class="pl-c1">0<span class="pl-ii">1</span></span>:<span class="pl-c1">00</span>    <span class="pl-c1">0.597594</span>
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">13</span> <span class="pl-c1">14</span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span><span class="pl-k">+</span><span class="pl-c1">0<span class="pl-ii">1</span></span>:<span class="pl-c1">00</span>   <span class="pl-k">-</span><span class="pl-c1">0.797246</span>
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">14</span> <span class="pl-c1">14</span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span><span class="pl-k">+</span><span class="pl-c1">0<span class="pl-ii">1</span></span>:<span class="pl-c1">00</span>    <span class="pl-c1">0.472879</span>
Freq: D, dtype: float64</pre></div>
<p>tz_localize和tz_convert也是DatetimeIndex的实例方法：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">127</span>]: ts.index.tz_localize(<span class="pl-s"><span class="pl-pds">'</span>Asia/Shanghai<span class="pl-pds">'</span></span>)
Out[<span class="pl-c1">127</span>]: 
DatetimeIndex([<span class="pl-s"><span class="pl-pds">'</span>2012-03-09 09:30:00+08:00<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-03-10 09:30:00+08:00<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2012-03-11 09:30:00+08:00<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-03-12 09:30:00+08:00<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2012-03-13 09:30:00+08:00<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-03-14 09:30:00+08:00<span class="pl-pds">'</span></span>],
              <span class="pl-v">dtype</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>datetime64[ns, Asia/Shanghai]<span class="pl-pds">'</span></span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>D<span class="pl-pds">'</span></span>)</pre></div>
<blockquote>
<p>注意：对单纯时间戳的本地化操作还会检查夏令时转变期附近容易混淆或不存在的时间。</p>
</blockquote>
<h2><a id="user-content-操作时区意识型timestamp对象" class="anchor" aria-hidden="true" href="#操作时区意识型timestamp对象"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>操作时区意识型Timestamp对象</h2>
<p>跟时间序列和日期范围差不多，独立的Timestamp对象也能被从单纯型（naive）本地化为时区意识型（time zone-aware），并从一个时区转换到另一个时区：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">128</span>]: stamp <span class="pl-k">=</span> pd.Timestamp(<span class="pl-s"><span class="pl-pds">'</span>2011-03-12 04:00<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">129</span>]: stamp_utc <span class="pl-k">=</span> stamp.tz_localize(<span class="pl-s"><span class="pl-pds">'</span>utc<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">130</span>]: stamp_utc.tz_convert(<span class="pl-s"><span class="pl-pds">'</span>America/New_York<span class="pl-pds">'</span></span>)
Out[<span class="pl-c1">130</span>]: Timestamp(<span class="pl-s"><span class="pl-pds">'</span>2011-03-11 23:00:00-0500<span class="pl-pds">'</span></span>, <span class="pl-v">tz</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>America/New_York<span class="pl-pds">'</span></span>)</pre></div>
<p>在创建Timestamp时，还可以传入一个时区信息：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">131</span>]: stamp_moscow <span class="pl-k">=</span> pd.Timestamp(<span class="pl-s"><span class="pl-pds">'</span>2011-03-12 04:00<span class="pl-pds">'</span></span>, <span class="pl-v">tz</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>Europe/Moscow<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">132</span>]: stamp_moscow
Out[<span class="pl-c1">132</span>]: Timestamp(<span class="pl-s"><span class="pl-pds">'</span>2011-03-12 04:00:00+0300<span class="pl-pds">'</span></span>, <span class="pl-v">tz</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>Europe/Moscow<span class="pl-pds">'</span></span>)</pre></div>
<p>时区意识型Timestamp对象在内部保存了一个UTC时间戳值（自UNIX纪元（1970年1月1日）算起的纳秒数）。这个UTC值在时区转换过程中是不会发生变化的：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">133</span>]: stamp_utc.value
Out[<span class="pl-c1">133</span>]: <span class="pl-c1">1299902400000000000</span>

In [<span class="pl-c1">134</span>]: stamp_utc.tz_convert(<span class="pl-s"><span class="pl-pds">'</span>America/New_York<span class="pl-pds">'</span></span>).value
Out[<span class="pl-c1">134</span>]: <span class="pl-c1">1299902400000000000</span></pre></div>
<p>当使用pandas的DateOffset对象执行时间算术运算时，运算过程会自动关注是否存在夏令时转变期。这里，我们创建了在DST转变之前的时间戳。首先，来看夏令时转变前的30分钟：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">135</span>]: <span class="pl-k">from</span> pandas.tseries.offsets <span class="pl-k">import</span> Hour

In [<span class="pl-c1">136</span>]: stamp <span class="pl-k">=</span> pd.Timestamp(<span class="pl-s"><span class="pl-pds">'</span>2012-03-12 01:30<span class="pl-pds">'</span></span>, <span class="pl-v">tz</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>US/Eastern<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">137</span>]: stamp
Out[<span class="pl-c1">137</span>]: Timestamp(<span class="pl-s"><span class="pl-pds">'</span>2012-03-12 01:30:00-0400<span class="pl-pds">'</span></span>, <span class="pl-v">tz</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>US/Eastern<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">138</span>]: stamp <span class="pl-k">+</span> Hour()
Out[<span class="pl-c1">138</span>]: Timestamp(<span class="pl-s"><span class="pl-pds">'</span>2012-03-12 02:30:00-0400<span class="pl-pds">'</span></span>, <span class="pl-v">tz</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>US/Eastern<span class="pl-pds">'</span></span>)</pre></div>
<p>然后，夏令时转变前90分钟：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">139</span>]: stamp <span class="pl-k">=</span> pd.Timestamp(<span class="pl-s"><span class="pl-pds">'</span>2012-11-04 00:30<span class="pl-pds">'</span></span>, <span class="pl-v">tz</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>US/Eastern<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">140</span>]: stamp
Out[<span class="pl-c1">140</span>]: Timestamp(<span class="pl-s"><span class="pl-pds">'</span>2012-11-04 00:30:00-0400<span class="pl-pds">'</span></span>, <span class="pl-v">tz</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>US/Eastern<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">141</span>]: stamp <span class="pl-k">+</span> <span class="pl-c1">2</span> <span class="pl-k">*</span> Hour()
Out[<span class="pl-c1">141</span>]: Timestamp(<span class="pl-s"><span class="pl-pds">'</span>2012-11-04 01:30:00-0500<span class="pl-pds">'</span></span>, <span class="pl-v">tz</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>US/Eastern<span class="pl-pds">'</span></span>)</pre></div>
<h2><a id="user-content-不同时区之间的运算" class="anchor" aria-hidden="true" href="#不同时区之间的运算"><svg class="octicon octicon-li
4000
nk" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>不同时区之间的运算</h2>
<p>如果两个时间序列的时区不同，在将它们合并到一起时，最终结果就会是UTC。由于时间戳其实是以UTC存储的，所以这是一个很简单的运算，并不需要发生任何转换：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">142</span>]: rng <span class="pl-k">=</span> pd.date_range(<span class="pl-s"><span class="pl-pds">'</span>3/7/2012 9:30<span class="pl-pds">'</span></span>, <span class="pl-v">periods</span><span class="pl-k">=</span><span class="pl-c1">10</span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>B<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">143</span>]: ts <span class="pl-k">=</span> pd.Series(np.random.randn(<span class="pl-c1">len</span>(rng)), <span class="pl-v">index</span><span class="pl-k">=</span>rng)

In [<span class="pl-c1">144</span>]: ts
Out[<span class="pl-c1">144</span>]: 
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">7</span></span> <span class="pl-c1">0<span class="pl-ii">9</span></span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span>    <span class="pl-c1">0.522356</span>
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">8</span></span> <span class="pl-c1">0<span class="pl-ii">9</span></span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span>   <span class="pl-k">-</span><span class="pl-c1">0.546348</span>
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">9</span></span> <span class="pl-c1">0<span class="pl-ii">9</span></span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span>   <span class="pl-k">-</span><span class="pl-c1">0.733537</span>
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">12</span> <span class="pl-c1">0<span class="pl-ii">9</span></span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span>    <span class="pl-c1">1.302736</span>
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">13</span> <span class="pl-c1">0<span class="pl-ii">9</span></span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span>    <span class="pl-c1">0.022199</span>
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">14</span> <span class="pl-c1">0<span class="pl-ii">9</span></span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span>    <span class="pl-c1">0.364287</span>
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">15</span> <span class="pl-c1">0<span class="pl-ii">9</span></span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span>   <span class="pl-k">-</span><span class="pl-c1">0.922839</span>
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">16</span> <span class="pl-c1">0<span class="pl-ii">9</span></span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span>    <span class="pl-c1">0.312656</span>
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">19</span> <span class="pl-c1">0<span class="pl-ii">9</span></span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span>   <span class="pl-k">-</span><span class="pl-c1">1.128497</span>
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">20</span> <span class="pl-c1">0<span class="pl-ii">9</span></span>:<span class="pl-c1">30</span>:<span class="pl-c1">00</span>   <span class="pl-k">-</span><span class="pl-c1">0.333488</span>
Freq: B, dtype: float64

In [<span class="pl-c1">145</span>]: ts1 <span class="pl-k">=</span> ts[:<span class="pl-c1">7</span>].tz_localize(<span class="pl-s"><span class="pl-pds">'</span>Europe/London<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">146</span>]: ts2 <span class="pl-k">=</span> ts1[<span class="pl-c1">2</span>:].tz_convert(<span class="pl-s"><span class="pl-pds">'</span>Europe/Moscow<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">147</span>]: result <span class="pl-k">=</span> ts1 <span class="pl-k">+</span> ts2

In [<span class="pl-c1">148</span>]: result.index
Out[<span class="pl-c1">148</span>]: 
DatetimeIndex([<span class="pl-s"><span class="pl-pds">'</span>2012-03-07 09:30:00+00:00<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-03-08 09:30:00+00:00<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2012-03-09 09:30:00+00:00<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-03-12 09:30:00+00:00<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2012-03-13 09:30:00+00:00<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012-03-14 09:30:00+00:00<span class="pl-pds">'</span></span>,
               <span class="pl-s"><span class="pl-pds">'</span>2012-03-15 09:30:00+00:00<span class="pl-pds">'</span></span>],
              <span class="pl-v">dtype</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>datetime64[ns, UTC]<span class="pl-pds">'</span></span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>B<span class="pl-pds">'</span></span>)</pre></div>
<h1><a id="user-content-115-时期及其算术运算" class="anchor" aria-hidden="true" href="#115-时期及其算术运算"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>11.5 时期及其算术运算</h1>
<p>时期（period）表示的是时间区间，比如数日、数月、数季、数年等。Period类所表示的就是这种数据类型，其构造函数需要用到一个字符串或整数，以及表11-4中的频率：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">149</span>]: p <span class="pl-k">=</span> pd.Period(<span class="pl-c1">2007</span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>A-DEC<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">150</span>]: p
Out[<span class="pl-c1">150</span>]: Period(<span class="pl-s"><span class="pl-pds">'</span>2007<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>A-DEC<span class="pl-pds">'</span></span>)</pre></div>
<p>这里，这个Period对象表示的是从2007年1月1日到2007年12月31日之间的整段时间。只需对Period对象加上或减去一个整数即可达到根据其频率进行位移的效果：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">151</span>]: p <span class="pl-k">+</span> <span class="pl-c1">5</span>
Out[<span class="pl-c1">151</span>]: Period(<span class="pl-s"><span class="pl-pds">'</span>2012<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>A-DEC<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">152</span>]: p <span class="pl-k">-</span> <span class="pl-c1">2</span>
Out[<span class="pl-c1">152</span>]: Period(<span class="pl-s"><span class="pl-pds">'</span>2005<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>A-DEC<span class="pl-pds">'</span></span>)</pre></div>
<p>如果两个Period对象拥有相同的频率，则它们的差就是它们之间的单位数量：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">153</span>]: pd.Period(<span class="pl-s"><span class="pl-pds">'</span>2014<span class="pl-pds">'</span></span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>A-DEC<span class="pl-pds">'</span></span>) <span class="pl-k">-</span> p
Out[<span class="pl-c1">153</span>]: <span class="pl-c1">7</span></pre></div>
<p>period_range函数可用于创建规则的时期范围：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">154</span>]: rng <span class="pl-k">=</span> pd.period_range(<span class="pl-s"><span class="pl-pds">'</span>2000-01-01<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2000-06-30<span class="pl-pds">'</span></span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>M<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">155</span>]: rng
Out[<span class="pl-c1">155</span>]: PeriodIndex([<span class="pl-s"><span class="pl-pds">'</span>2000-01<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2000-02<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2000-03<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2000-04<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2000-05<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>20<span class="pl-ii"></span></span>
<span class="pl-c1">00</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">6</span></span><span class="pl-s"><span class="pl-pds">'</span>], dtype=<span class="pl-pds">'</span></span>period[M]<span class="pl-s"><span class="pl-pds">'</span>, freq=<span class="pl-pds">'</span></span>M<span class="pl-s"><span class="pl-pds">'</span>)<span class="pl-ii"></span></span></pre></div>
<p>PeriodIndex类保存了一组Period，它可以在任何pandas数据结构中被用作轴索引：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">156</span>]: pd.Series(np.random.randn(<span class="pl-c1">6</span>), <span class="pl-v">index</span><span class="pl-k">=</span>rng)
Out[<span class="pl-c1">156</span>]: 
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.514551</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.559782</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.783408</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">4</span></span>   <span class="pl-k">-</span><span class="pl-c1">1.797685</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.172670</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">6</span></span>    <span class="pl-c1">0.680215</span>
Freq: M, dtype: float64</pre></div>
<p>如果你有一个字符串数组，你也可以使用PeriodIndex类：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">157</span>]: values <span class="pl-k">=</span> [<span class="pl-s"><span class="pl-pds">'</span>2001Q3<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2002Q2<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2003Q1<span class="pl-pds">'</span></span>]

In [<span class="pl-c1">158</span>]: index <span class="pl-k">=</span> pd.PeriodIndex(values, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>Q-DEC<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">159</span>]: index
Out[<span class="pl-c1">159</span>]: PeriodIndex([<span class="pl-s"><span class="pl-pds">'</span>2001Q3<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2002Q2<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2003Q1<span class="pl-pds">'</span></span>], <span class="pl-v">dtype</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>period[Q-DEC]<span class="pl-pds">'</span></span>, freq
<span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>Q-DEC<span class="pl-pds">'</span></span>)</pre></div>
<h2><a id="user-content-时期的频率转换" class="anchor" aria-hidden="true" href="#时期的频率转换"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>时期的频率转换</h2>
<p>Period和PeriodIndex对象都可以通过其asfreq方法被转换成别的频率。假设我们有一个年度时期，希望将其转换为当年年初或年末的一个月度时期。该任务非常简单：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">160</span>]: p <span class="pl-k">=</span> pd.Period(<span class="pl-s"><span class="pl-pds">'</span>2007<span class="pl-pds">'</span></span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>A-DEC<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">161</span>]: p
Out[<span class="pl-c1">161</span>]: Period(<span class="pl-s"><span class="pl-pds">'</span>2007<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>A-DEC<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">162</span>]: p.asfreq(<span class="pl-s"><span class="pl-pds">'</span>M<span class="pl-pds">'</span></span>, <span class="pl-v">how</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>start<span class="pl-pds">'</span></span>)
Out[<span class="pl-c1">162</span>]: Period(<span class="pl-s"><span class="pl-pds">'</span>2007-01<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>M<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">163</span>]: p.asfreq(<span class="pl-s"><span class="pl-pds">'</span>M<span class="pl-pds">'</span></span>, <span class="pl-v">how</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>end<span class="pl-pds">'</span></span>)
Out[<span cl
3ff8
ass="pl-c1">163</span>]: Period(<span class="pl-s"><span class="pl-pds">'</span>2007-12<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>M<span class="pl-pds">'</span></span>)</pre></div>
<p>你可以将Period('2007','A-DEC')看做一个被划分为多个月度时期的时间段中的游标。图11-1对此进行了说明。对于一个不以12月结束的财政年度，月度子时期的归属情况就不一样了：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">164</span>]: p <span class="pl-k">=</span> pd.Period(<span class="pl-s"><span class="pl-pds">'</span>2007<span class="pl-pds">'</span></span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>A-JUN<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">165</span>]: p
Out[<span class="pl-c1">165</span>]: Period(<span class="pl-s"><span class="pl-pds">'</span>2007<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>A-JUN<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">166</span>]: p.asfreq(<span class="pl-s"><span class="pl-pds">'</span>M<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>start<span class="pl-pds">'</span></span>)
Out[<span class="pl-c1">166</span>]: Period(<span class="pl-s"><span class="pl-pds">'</span>2006-07<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>M<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">167</span>]: p.asfreq(<span class="pl-s"><span class="pl-pds">'</span>M<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>end<span class="pl-pds">'</span></span>)
Out[<span class="pl-c1">167</span>]: Period(<span class="pl-s"><span class="pl-pds">'</span>2007-06<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>M<span class="pl-pds">'</span></span>)</pre></div>
<p><a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/48a64c472c396051eb37cbf2f105feb14cdc46ff/687474703a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d643230313230306430653635363736662e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430"><img src="https://camo.githubusercontent.com/48a64c472c396051eb37cbf2f105feb14cdc46ff/687474703a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d643230313230306430653635363736662e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430" alt="图11-1 Period频率转换示例" data-canonical-src="http://upload-images.jianshu.io/upload_images/7178691-d201200d0e65676f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="max-width:100%;"></a></p>
<p>在将高频率转换为低频率时，超时期（superperiod）是由子时期（subperiod）所属的位置决定的。例如，在A-JUN频率中，月份“2007年8月”实际上是属于周期“2008年”的：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">168</span>]: p <span class="pl-k">=</span> pd.Period(<span class="pl-s"><span class="pl-pds">'</span>Aug-2007<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>M<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">169</span>]: p.asfreq(<span class="pl-s"><span class="pl-pds">'</span>A-JUN<span class="pl-pds">'</span></span>)
Out[<span class="pl-c1">169</span>]: Period(<span class="pl-s"><span class="pl-pds">'</span>2008<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>A-JUN<span class="pl-pds">'</span></span>)</pre></div>
<p>完整的PeriodIndex或TimeSeries的频率转换方式也是如此：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">170</span>]: rng <span class="pl-k">=</span> pd.period_range(<span class="pl-s"><span class="pl-pds">'</span>2006<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2009<span class="pl-pds">'</span></span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>A-DEC<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">171</span>]: ts <span class="pl-k">=</span> pd.Series(np.random.randn(<span class="pl-c1">len</span>(rng)), <span class="pl-v">index</span><span class="pl-k">=</span>rng)

In [<span class="pl-c1">172</span>]: ts
Out[<span class="pl-c1">172</span>]: 
<span class="pl-c1">2006</span>    <span class="pl-c1">1.607578</span>
<span class="pl-c1">2007</span>    <span class="pl-c1">0.200381</span>
<span class="pl-c1">2008</span>   <span class="pl-k">-</span><span class="pl-c1">0.834068</span>
<span class="pl-c1">2009</span>   <span class="pl-k">-</span><span class="pl-c1">0.302988</span>
Freq: A<span class="pl-k">-</span><span class="pl-c1">DEC</span>, dtype: float64

In [<span class="pl-c1">173</span>]: ts.asfreq(<span class="pl-s"><span class="pl-pds">'</span>M<span class="pl-pds">'</span></span>, <span class="pl-v">how</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>start<span class="pl-pds">'</span></span>)
Out[<span class="pl-c1">173</span>]: 
<span class="pl-c1">2006</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span>    <span class="pl-c1">1.607578</span>
<span class="pl-c1">2007</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span>    <span class="pl-c1">0.200381</span>
<span class="pl-c1">2008</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.834068</span>
<span class="pl-c1">2009</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.302988</span>
Freq: M, dtype: float64</pre></div>
<p>这里，根据年度时期的第一个月，每年的时期被取代为每月的时期。如果我们想要每年的最后一个工作日，我们可以使用“B”频率，并指明想要该时期的末尾：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">174</span>]: ts.asfreq(<span class="pl-s"><span class="pl-pds">'</span>B<span class="pl-pds">'</span></span>, <span class="pl-v">how</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>end<span class="pl-pds">'</span></span>)

Out[<span class="pl-c1">174</span>]: 
<span class="pl-c1">2006</span><span class="pl-k">-</span><span class="pl-c1">12</span><span class="pl-k">-</span><span class="pl-c1">29</span>    <span class="pl-c1">1.607578</span>
<span class="pl-c1">2007</span><span class="pl-k">-</span><span class="pl-c1">12</span><span class="pl-k">-</span><span class="pl-c1">31</span>    <span class="pl-c1">0.200381</span>
<span class="pl-c1">2008</span><span class="pl-k">-</span><span class="pl-c1">12</span><span class="pl-k">-</span><span class="pl-c1">31</span>   <span class="pl-k">-</span><span class="pl-c1">0.834068</span>
<span class="pl-c1">2009</span><span class="pl-k">-</span><span class="pl-c1">12</span><span class="pl-k">-</span><span class="pl-c1">31</span>   <span class="pl-k">-</span><span class="pl-c1">0.302988</span>
Freq: B, dtype: float64</pre></div>
<h2><a id="user-content-按季度计算的时期频率" class="anchor" aria-hidden="true" href="#按季度计算的时期频率"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>按季度计算的时期频率</h2>
<p>季度型数据在会计、金融等领域中很常见。许多季度型数据都会涉及“财年末”的概念，通常是一年12个月中某月的最后一个日历日或工作日。就这一点来说，时期"2012Q4"根据财年末的不同会有不同的含义。pandas支持12种可能的季度型频率，即Q-JAN到Q-DEC：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">175</span>]: p <span class="pl-k">=</span> pd.Period(<span class="pl-s"><span class="pl-pds">'</span>2012Q4<span class="pl-pds">'</span></span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>Q-JAN<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">176</span>]: p
Out[<span class="pl-c1">176</span>]: Period(<span class="pl-s"><span class="pl-pds">'</span>2012Q4<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Q-JAN<span class="pl-pds">'</span></span>)</pre></div>
<p>在以1月结束的财年中，2012Q4是从11月到1月（将其转换为日型频率就明白了）。图11-2对此进行了说明：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">177</span>]: p.asfreq(<span class="pl-s"><span class="pl-pds">'</span>D<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>start<span class="pl-pds">'</span></span>)
Out[<span class="pl-c1">177</span>]: Period(<span class="pl-s"><span class="pl-pds">'</span>2011-11-01<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>D<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">178</span>]: p.asfreq(<span class="pl-s"><span class="pl-pds">'</span>D<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>end<span class="pl-pds">'</span></span>)
Out[<span class="pl-c1">178</span>]: Period(<span class="pl-s"><span class="pl-pds">'</span>2012-01-31<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>D<span class="pl-pds">'</span></span>)</pre></div>
<p><a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/70c759db53aefd1dfd9e1aef417d05a24f1f8698/687474703a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d653265316435326339373636663666662e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430"><img src="https://camo.githubusercontent.com/70c759db53aefd1dfd9e1aef417d05a24f1f8698/687474703a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d653265316435326339373636663666662e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430" alt="图11.2 不同季度型频率之间的转换" data-canonical-src="http://upload-images.jianshu.io/upload_images/7178691-e2e1d52c9766f6ff.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="max-width:100%;"></a></p>
<p>因此，Period之间的算术运算会非常简单。例如，要获取该季度倒数第二个工作日下午4点的时间戳，你可以这样：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">179</span>]: p4pm <span class="pl-k">=</span> (p.asfreq(<span class="pl-s"><span class="pl-pds">'</span>B<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>e<span class="pl-pds">'</span></span>) <span class="pl-k">-</span> <span class="pl-c1">1</span>).asfreq(<span class="pl-s"><span class="pl-pds">'</span>T<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>s<span class="pl-pds">'</span></span>) <span class="pl-k">+</span> <span class="pl-c1">16</span> <span class="pl-k">*</span> <span class="pl-c1">60</span>

In [<span class="pl-c1">180</span>]: p4pm
Out[<span class="pl-c1">180</span>]: Period(<span class="pl-s"><span class="pl-pds">'</span>2012-01-30 16:00<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>T<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">181</span>]: p4pm.to_timestamp()
Out[<span class="pl-c1">181</span>]: Timestamp(<span class="pl-s"><span class="pl-pds">'</span>2012-01-30 16:00:00<span class="pl-pds">'</span></span>)</pre></div>
<p>period_range可用于生成季度型范围。季度型范围的算术运算也跟上面是一样的：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">182</span>]: rng <span class="pl-k">=</span> pd.period_range(<span class="pl-s"><span class="pl-pds">'</span>2011Q3<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2012Q4<span class="pl-pds">'</span></span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>Q-JAN<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">183</span>]: ts <span class="pl-k">=</span> pd.Series(np.arange(<span class="pl-c1">len</span>(rng)), <span class="pl-v">index</span><span class="pl-k">=</span>rng)

In [<span class="pl-c1">184</span>]: ts
Out[<span class="pl-c1">184</span>]: 
<span class="pl-ii">2011Q3</span>    <span class="pl-c1">0</span>
<span class="pl-ii">2011Q4</span>    <span class="pl-c1">1</span>
<span class="pl-ii">2012Q1</span>    <span class="pl-c1">2</span>
<span class="pl-ii">2012Q2</span>    <span class="pl-c1">3</span>
<span class="pl-ii">2012Q3</span>    <span class="pl-c1">4</span>
<span class="pl-ii">2012Q4</span>    <span class="pl-c1">5</span>
Freq: Q<span class="pl-k">-</span><span class="pl-c1">JAN</span>, dtype: int64

In [<span class="pl-c1">185</span>]: new_rng <span class="pl-k">=</span> (rng.asfreq(<span class="pl-s"><span class="pl-pds">'</span>B<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>e<span class="pl-pds">'</span></span>) <span class="pl-k">-</span> <span class="pl-c1">1</span>).asfreq(<span class="pl-s"><span class="pl-pds">'</span>T<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>s<span class="pl-pds">'</span></span>) <span class="pl-k">+</span> <span class="pl-c1">16</span> <span class="pl-k">*</span> <span class="pl-c1">60</span>

In [<span class="pl-c1">186</span>]: ts.index <span class="pl-k">=</span> new_rng.to_timestamp()

In [<span class="pl-c1">187</span>]: ts
Out[<span class="pl-c1">187</span>]:
<span class="pl-c1">2010</span><span class="pl-k">-</span><span class="pl-c1">10</span><span class="pl-k">-</span><span class="pl-c1">28</span> <span class="pl-c1">16</span>:<span class="pl-c1">00</span>:<span class="pl-c1">00</span>    <span class="pl-c1">0</span>
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">28</span> <span class="pl-c1">16</span>:<span class="pl-c1">00</span>:<span class="pl-c1">00</span>    <span class="pl-c1">1</span>
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">4</span></span><span class="pl-k">-</span><span class="pl-c1">28</span> <span class="pl-c1">16</span>:<span class="pl-c1">00</span>:<span class="pl-c1">00</span>    <span class="pl-c1">2</span>
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">7</span></span><span class="pl-k">-</span><span class="pl-c1">28</span> <span class="pl-c1">16</span>:<span class="pl-c1">00</span>:<span class="pl-c1">00</span>    <span class="pl-c1">3</span>
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">10</span><span class="pl-k">-</span><span class="pl-c1">28</span> <span class="pl-c1">16</span>:<span class="pl-c1">00</span>:<span class="pl-c1">00</span>    <span class="pl-c1">4</span>
<span class="pl-c1">2012</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">30</span> <span class="pl-c1">16</span>:<span class="pl-c1">00</span>:<span class="pl-c1">00</span>    <span class="pl-c1">5</span>
dtype: int64</pre></di
4000
v>
<h2><a id="user-content-将timestamp转换为period及其反向过程" class="anchor" aria-hidden="true" href="#将timestamp转换为period及其反向过程"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>将Timestamp转换为Period（及其反向过程）</h2>
<p>通过使用to_period方法，可以将由时间戳索引的Series和DataFrame对象转换为以时期索引：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">188</span>]: rng <span class="pl-k">=</span> pd.date_range(<span class="pl-s"><span class="pl-pds">'</span>2000-01-01<span class="pl-pds">'</span></span>, <span class="pl-v">periods</span><span class="pl-k">=</span><span class="pl-c1">3</span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>M<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">189</span>]: ts <span class="pl-k">=</span> pd.Series(np.random.randn(<span class="pl-c1">3</span>), <span class="pl-v">index</span><span class="pl-k">=</span>rng)

In [<span class="pl-c1">190</span>]: ts
Out[<span class="pl-c1">190</span>]: 
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">31</span>    <span class="pl-c1">1.663261</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span><span class="pl-k">-</span><span class="pl-c1">29</span>   <span class="pl-k">-</span><span class="pl-c1">0.996206</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">31</span>    <span class="pl-c1">1.521760</span>
Freq: M, dtype: float64

In [<span class="pl-c1">191</span>]: pts <span class="pl-k">=</span> ts.to_period()

In [<span class="pl-c1">192</span>]: pts
Out[<span class="pl-c1">192</span>]: 
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span>    <span class="pl-c1">1.663261</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.996206</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span>    <span class="pl-c1">1.521760</span>
Freq: M, dtype: float64</pre></div>
<p>由于时期指的是非重叠时间区间，因此对于给定的频率，一个时间戳只能属于一个时期。新PeriodIndex的频率默认是从时间戳推断而来的，你也可以指定任何别的频率。结果中允许存在重复时期：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">193</span>]: rng <span class="pl-k">=</span> pd.date_range(<span class="pl-s"><span class="pl-pds">'</span>1/29/2000<span class="pl-pds">'</span></span>, <span class="pl-v">periods</span><span class="pl-k">=</span><span class="pl-c1">6</span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>D<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">194</span>]: ts2 <span class="pl-k">=</span> pd.Series(np.random.randn(<span class="pl-c1">6</span>), <span class="pl-v">index</span><span class="pl-k">=</span>rng)

In [<span class="pl-c1">195</span>]: ts2
Out[<span class="pl-c1">195</span>]: 
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">29</span>    <span class="pl-c1">0.244175</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">30</span>    <span class="pl-c1">0.423331</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">31</span>   <span class="pl-k">-</span><span class="pl-c1">0.654040</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span>    <span class="pl-c1">2.089154</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.060220</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.167933</span>
Freq: D, dtype: float64

In [<span class="pl-c1">196</span>]: ts2.to_period(<span class="pl-s"><span class="pl-pds">'</span>M<span class="pl-pds">'</span></span>)
Out[<span class="pl-c1">196</span>]: 
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span>    <span class="pl-c1">0.244175</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span>    <span class="pl-c1">0.423331</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.654040</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span>    <span class="pl-c1">2.089154</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.060220</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.167933</span>
Freq: M, dtype: float64</pre></div>
<p>要转换回时间戳，使用to_timestamp即可：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">197</span>]: pts <span class="pl-k">=</span> ts2.to_period()

In [<span class="pl-c1">198</span>]: pts
Out[<span class="pl-c1">198</span>]: 
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">29</span>    <span class="pl-c1">0.244175</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">30</span>    <span class="pl-c1">0.423331</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">31</span>   <span class="pl-k">-</span><span class="pl-c1">0.654040</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span>    <span class="pl-c1">2.089154</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.060220</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.167933</span>
Freq: D, dtype: float64

In [<span class="pl-c1">199</span>]: pts.to_timestamp(<span class="pl-v">how</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>end<span class="pl-pds">'</span></span>)
Out[<span class="pl-c1">199</span>]: 
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">29</span>    <span class="pl-c1">0.244175</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">30</span>    <span class="pl-c1">0.423331</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">31</span>   <span class="pl-k">-</span><span class="pl-c1">0.654040</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span>    <span class="pl-c1">2.089154</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.060220</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.167933</span>
Freq: D, dtype: float64</pre></div>
<h2><a id="user-content-通过数组创建periodindex" class="anchor" aria-hidden="true" href="#通过数组创建periodindex"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>通过数组创建PeriodIndex</h2>
<p>固定频率的数据集通常会将时间信息分开存放在多个列中。例如，在下面这个宏观经济数据集中，年度和季度就分别存放在不同的列中：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">200</span>]: data <span class="pl-k">=</span> pd.read_csv(<span class="pl-s"><span class="pl-pds">'</span>examples/macrodata.csv<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">201</span>]: data.head(<span class="pl-c1">5</span>)
Out[<span class="pl-c1">201</span>]: 
     year  quarter   realgdp  realcons  realinv  realgovt  realdpi    cpi  \
<span class="pl-c1">0</span>  <span class="pl-c1">1959.0</span>      <span class="pl-c1">1.0</span>  <span class="pl-c1">2710.349</span>    <span class="pl-c1">1707.4</span>  <span class="pl-c1">286.898</span>   <span class="pl-c1">470.045</span>   <span class="pl-c1">1886.9</span>  <span class="pl-c1">28.98</span>   
<span class="pl-c1">1</span>  <span class="pl-c1">1959.0</span>      <span class="pl-c1">2.0</span>  <span class="pl-c1">2778.801</span>    <span class="pl-c1">1733.7</span>  <span class="pl-c1">310.859</span>   <span class="pl-c1">481.301</span>   <span class="pl-c1">1919.7</span>  <span class="pl-c1">29.15</span>   
<span class="pl-c1">2</span>  <span class="pl-c1">1959.0</span>      <span class="pl-c1">3.0</span>  <span class="pl-c1">2775.488</span>    <span class="pl-c1">1751.8</span>  <span class="pl-c1">289.226</span>   <span class="pl-c1">491.260</span>   <span class="pl-c1">1916.4</span>  <span class="pl-c1">29.35</span>   
<span class="pl-c1">3</span>  <span class="pl-c1">1959.0</span>      <span class="pl-c1">4.0</span>  <span class="pl-c1">2785.204</span>    <span class="pl-c1">1753.7</span>  <span class="pl-c1">299.356</span>   <span class="pl-c1">484.052</span>   <span class="pl-c1">1931.3</span>  <span class="pl-c1">29.37</span>   
<span class="pl-c1">4</span>  <span class="pl-c1">1960.0</span>      <span class="pl-c1">1.0</span>  <span class="pl-c1">2847.699</span>    <span class="pl-c1">1770.5</span>  <span class="pl-c1">331.722</span>   <span class="pl-c1">462.199</span>   <span class="pl-c1">1955.5</span>  <span class="pl-c1">29.54</span>   
      m1  tbilrate  unemp      pop  infl  realint  
<span class="pl-c1">0</span>  <span class="pl-c1">139.7</span>      <span class="pl-c1">2.82</span>    <span class="pl-c1">5.8</span>  <span class="pl-c1">177.146</span>  <span class="pl-c1">0.00</span>     <span class="pl-c1">0.00</span>  
<span class="pl-c1">1</span>  <span class="pl-c1">141.7</span>      <span class="pl-c1">3.08</span>    <span class="pl-c1">5.1</span>  <span class="pl-c1">177.830</span>  <span class="pl-c1">2.34</span>     <span class="pl-c1">0.74</span>  
<span class="pl-c1">2</span>  <span class="pl-c1">140.5</span>      <span class="pl-c1">3.82</span>    <span class="pl-c1">5.3</span>  <span class="pl-c1">178.657</span>  <span class="pl-c1">2.74</span>     <span class="pl-c1">1.09</span>  
<span class="pl-c1">3</span>  <span class="pl-c1">140.0</span>      <span class="pl-c1">4.33</span>    <span class="pl-c1">5.6</span>  <span class="pl-c1">179.386</span>  <span class="pl-c1">0.27</span>     <span class="pl-c1">4.06</span>  
<span class="pl-c1">4</span>  <span class="pl-c1">139.6</span>      <span class="pl-c1">3.50</span>    <span class="pl-c1">5.2</span>  <span class="pl-c1">180.007</span>  <span class="pl-c1">2.31</span>     <span class="pl-c1">1.19</span>  

In [<span class="pl-c1">202</span>]: data.year
Out[<span class="pl-c1">202</span>]: 
<span class="pl-c1">0</span>      <span class="pl-c1">1959.0</span>
<span class="pl-c1">1</span>      <span class="pl-c1">1959.0</span>
<span class="pl-c1">2</span>      <span class="pl-c1">1959.0</span>
<span class="pl-c1">3</span>      <span class="pl-c1">1959.0</span>
<span class="pl-c1">4</span>      <span class="pl-c1">1960.0</span>
<span class="pl-c1">5</span>      <span class="pl-c1">1960.0</span>
<span class="pl-c1">6</span>      <span class="pl-c1">1960.0</span>
<span class="pl-c1">7</span>      <span class="pl-c1">1960.0</span>
<span class="pl-c1">8</span>      <span class="pl-c1">1961.0</span>
<span class="pl-c1">9</span>      <span class="pl-c1">1961.0</span>
        <span class="pl-c1">...</span>  
<span class="pl-c1">193</span>    <span class="pl-c1">2007.0</span>
<span class="pl-c1">194</span>    <span class="pl-c1">2007.0</span>
<span class="pl-c1">195</span>    <span class="pl-c1">2007.0</span>
<span class="pl-c1">196</span>    <span class="pl-c1">2008.0</span>
<span class="pl-c1">197</span>    <span class="pl-c1">2008.0</span>
<span class="pl-c1">198</span>    <span class="pl-c1">2008.0</span>
<span class="pl-c1">199</span>    <span class="pl-c1">2008.0</span>
<span class="pl-c1">200</span>    <span class="pl-c1">2009.0</span>
<span class="pl-c1">201</span>    <span class="pl-c1">2009.0</span>
<span class="pl-c1">202</span>    <span class="pl-c1">2009.0</span>
Name: year, Length: <span class="pl-c1">203</span>, dtype: float64

In [<span class="pl-c1">203</span>]: data.quarter
Out[<span class="pl-c1">203</span>]: 
<span class="pl-c1">0</span>      <span class="pl-c1">1.0</span>
<span class="pl-c1">1</span>      <span class="pl-c1">2.0</span>
<span class="pl-c1">2</span>      <span class="pl-c1">3.0</span>
<span class="pl-c1">3</span>      <span class="pl-c1">4.0</span>
<span class="pl-c1">4</span>      <span class="pl-c1">1.0</span>
<span class="pl-c1">5</span>      <span class="pl-c1">2.0</span>
<span class="pl-c1">6</span>      <span class="pl-c1">3.0</span>
<span class="pl-c1">7</span>      <span class="pl-c1">4.0</span>
<span class="pl-c1">8</span>      <span class="pl-c1">1.0</span>
<span class="pl-c1">9</spa
3ff8
n>      <span class="pl-c1">2.0</span>
      <span class="pl-c1">...</span> 
<span class="pl-c1">193</span>    <span class="pl-c1">2.0</span>
<span class="pl-c1">194</span>    <span class="pl-c1">3.0</span>
<span class="pl-c1">195</span>    <span class="pl-c1">4.0</span>
<span class="pl-c1">196</span>    <span class="pl-c1">1.0</span>
<span class="pl-c1">197</span>    <span class="pl-c1">2.0</span>
<span class="pl-c1">198</span>    <span class="pl-c1">3.0</span>
<span class="pl-c1">199</span>    <span class="pl-c1">4.0</span>
<span class="pl-c1">200</span>    <span class="pl-c1">1.0</span>
<span class="pl-c1">201</span>    <span class="pl-c1">2.0</span>
<span class="pl-c1">202</span>    <span class="pl-c1">3.0</span>
Name: quarter, Length: <span class="pl-c1">203</span>, dtype: float64</pre></div>
<p>通过将这些数组以及一个频率传入PeriodIndex，就可以将它们合并成DataFrame的一个索引：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">204</span>]: index <span class="pl-k">=</span> pd.PeriodIndex(<span class="pl-v">year</span><span class="pl-k">=</span>data.year, <span class="pl-v">quarter</span><span class="pl-k">=</span>data.quarter,
   <span class="pl-c1">...</span>..:                        <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>Q-DEC<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">205</span>]: index
Out[<span class="pl-c1">205</span>]: 
PeriodIndex([<span class="pl-s"><span class="pl-pds">'</span>1959Q1<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>1959Q2<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>1959Q3<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>1959Q4<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>1960Q1<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>1960Q2<span class="pl-pds">'</span></span>,
             <span class="pl-s"><span class="pl-pds">'</span>1960Q3<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>1960Q4<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>1961Q1<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>1961Q2<span class="pl-pds">'</span></span>,
             <span class="pl-c1">...</span>
             <span class="pl-s"><span class="pl-pds">'</span>2007Q2<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2007Q3<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2007Q4<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2008Q1<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2008Q2<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2008Q3<span class="pl-pds">'</span></span>,
             <span class="pl-s"><span class="pl-pds">'</span>2008Q4<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2009Q1<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2009Q2<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>2009Q3<span class="pl-pds">'</span></span>],
            <span class="pl-v">dtype</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>period[Q-DEC]<span class="pl-pds">'</span></span>, <span class="pl-v">length</span><span class="pl-k">=</span><span class="pl-c1">203</span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>Q-DEC<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">206</span>]: data.index <span class="pl-k">=</span> index

In [<span class="pl-c1">207</span>]: data.infl
Out[<span class="pl-c1">207</span>]: 
<span class="pl-ii">1959Q1</span>    <span class="pl-c1">0.00</span>
<span class="pl-ii">1959Q2</span>    <span class="pl-c1">2.34</span>
<span class="pl-ii">1959Q3</span>    <span class="pl-c1">2.74</span>
<span class="pl-ii">1959Q4</span>    <span class="pl-c1">0.27</span>
<span class="pl-ii">1960Q1</span>    <span class="pl-c1">2.31</span>
<span class="pl-ii">1960Q2</span>    <span class="pl-c1">0.14</span>
<span class="pl-ii">1960Q3</span>    <span class="pl-c1">2.70</span>
<span class="pl-ii">1960Q4</span>    <span class="pl-c1">1.21</span>
<span class="pl-ii">1961Q1</span>   <span class="pl-k">-</span><span class="pl-c1">0.40</span>
<span class="pl-ii">1961Q2</span>    <span class="pl-c1">1.47</span>
          <span class="pl-c1">...</span> 
<span class="pl-ii">2007Q2</span>    <span class="pl-c1">2.75</span>
<span class="pl-ii">2007Q3</span>    <span class="pl-c1">3.45</span>
<span class="pl-ii">2007Q4</span>    <span class="pl-c1">6.38</span>
<span class="pl-ii">2008Q1</span>    <span class="pl-c1">2.82</span>
<span class="pl-ii">2008Q2</span>    <span class="pl-c1">8.53</span>
<span class="pl-ii">2008Q3</span>   <span class="pl-k">-</span><span class="pl-c1">3.16</span>
<span class="pl-ii">2008Q4</span>   <span class="pl-k">-</span><span class="pl-c1">8.79</span>
<span class="pl-ii">2009Q1</span>    <span class="pl-c1">0.94</span>
<span class="pl-ii">2009Q2</span>    <span class="pl-c1">3.37</span>
<span class="pl-ii">2009Q3</span>    <span class="pl-c1">3.56</span>
Freq: Q<span class="pl-k">-</span><span class="pl-c1">DEC</span>, Name: infl, Length: <span class="pl-c1">203</span>, dtype: float64</pre></div>
<h1><a id="user-content-116-重采样及频率转换" class="anchor" aria-hidden="true" href="#116-重采样及频率转换"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>11.6 重采样及频率转换</h1>
<p>重采样（resampling）指的是将时间序列从一个频率转换到另一个频率的处理过程。将高频率数据聚合到低频率称为降采样（downsampling），而将低频率数据转换到高频率则称为升采样（upsampling）。并不是所有的重采样都能被划分到这两个大类中。例如，将W-WED（每周三）转换为W-FRI既不是降采样也不是升采样。</p>
<p>pandas对象都带有一个resample方法，它是各种频率转换工作的主力函数。resample有一个类似于groupby的API，调用resample可以分组数据，然后会调用一个聚合函数：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">208</span>]: rng <span class="pl-k">=</span> pd.date_range(<span class="pl-s"><span class="pl-pds">'</span>2000-01-01<span class="pl-pds">'</span></span>, <span class="pl-v">periods</span><span class="pl-k">=</span><span class="pl-c1">100</span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>D<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">209</span>]: ts <span class="pl-k">=</span> pd.Series(np.random.randn(<span class="pl-c1">len</span>(rng)), <span class="pl-v">index</span><span class="pl-k">=</span>rng)

In [<span class="pl-c1">210</span>]: ts
Out[<span class="pl-c1">210</span>]: 
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span>    <span class="pl-c1">0.631634</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span>   <span class="pl-k">-</span><span class="pl-c1">1.594313</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span>   <span class="pl-k">-</span><span class="pl-c1">1.519937</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">4</span></span>    <span class="pl-c1">1.108752</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span>    <span class="pl-c1">1.255853</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">6</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.024330</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">7</span></span>   <span class="pl-k">-</span><span class="pl-c1">2.047939</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">8</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.272657</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">9</span></span>   <span class="pl-k">-</span><span class="pl-c1">1.692615</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">10</span>    <span class="pl-c1">1.423830</span>
                <span class="pl-c1">...</span>   
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">31</span>   <span class="pl-k">-</span><span class="pl-c1">0.007852</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">4</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span>   <span class="pl-k">-</span><span class="pl-c1">1.638806</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">4</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span>    <span class="pl-c1">1.401227</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">4</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span>    <span class="pl-c1">1.758539</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">4</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">4</span></span>    <span class="pl-c1">0.628932</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">4</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.423776</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">4</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">6</span></span>    <span class="pl-c1">0.789740</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">4</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">7</span></span>    <span class="pl-c1">0.937568</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">4</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">8</span></span>   <span class="pl-k">-</span><span class="pl-c1">2.253294</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">4</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">9</span></span>   <span class="pl-k">-</span><span class="pl-c1">1.772919</span>
Freq: D, Length: <span class="pl-c1">100</span>, dtype: float64

In [<span class="pl-c1">211</span>]: ts.resample(<span class="pl-s"><span class="pl-pds">'</span>M<span class="pl-pds">'</span></span>).mean()
Out[<span class="pl-c1">211</span>]: 
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">31</span>   <span class="pl-k">-</span><span class="pl-c1">0.165893</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span><span class="pl-k">-</span><span class="pl-c1">29</span>    <span class="pl-c1">0.078606</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span><span class="pl-k">-</span><span class="pl-c1">31</span>    <span class="pl-c1">0.223811</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">4</span></span><span class="pl-k">-</span><span class="pl-c1">30</span>   <span class="pl-k">-</span><span class="pl-c1">0.063643</span>
Freq: M, dtype: float64

In [<span class="pl-c1">212</span>]: ts.resample(<span class="pl-s"><span class="pl-pds">'</span>M<span class="pl-pds">'</span></span>, <span class="pl-v">kind</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>period<span class="pl-pds">'</span></span>).mean()
Out[<span class="pl-c1">212</span>]: 
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.165893</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span>    <span class="pl-c1">0.078606</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span>    <span class="pl-c1">0.223811</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">4</span></span>   <span class="pl-k">-</span><span class="pl-c1">0.063643</span>
Freq: M, dtype: float64</pre></div>
<p>resample是一个灵活高效的方法，可用于处理非常大的时间序列。我将通过一系列的示例说明其用法。表11-5总结它的一些选项。</p>
<p>表11-5 resample方法的参数
<a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/a4706e8956169df487cf94011a64c3e9cb1ce25d/68747470733a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d623430613537303836633930346538332e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430"><img src="https://camo.githubusercontent.com/a4706e8956169df487cf94011a64c3e9cb1ce25d/68747470733a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d623430613537303836633930346538332e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430" alt="" data-canonical-src="https://upload-images.jianshu.io/upload_images/7178691-b40a57086c904e83.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="max-width:100%;"></a></p>
<h2><a id="user-content-降采样" class="anchor" aria-hidden="true" href="#降采样"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-
4000
.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>降采样</h2>
<p>将数据聚合到规律的低频率是一件非常普通的时间序列处理任务。待聚合的数据不必拥有固定的频率，期望的频率会自动定义聚合的面元边界，这些面元用于将时间序列拆分为多个片段。例如，要转换到月度频率（'M'或'BM'），数据需要被划分到多个单月时间段中。各时间段都是半开放的。一个数据点只能属于一个时间段，所有时间段的并集必须能组成整个时间帧。在用resample对数据进行降采样时，需要考虑两样东西：</p>
<ul>
<li>各区间哪边是闭合的。</li>
<li>如何标记各个聚合面元，用区间的开头还是末尾。</li>
</ul>
<p>为了说明，我们来看一些“1分钟”数据：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">213</span>]: rng <span class="pl-k">=</span> pd.date_range(<span class="pl-s"><span class="pl-pds">'</span>2000-01-01<span class="pl-pds">'</span></span>, <span class="pl-v">periods</span><span class="pl-k">=</span><span class="pl-c1">12</span>, <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>T<span class="pl-pds">'</span></span>)

In [<span class="pl-c1">214</span>]: ts <span class="pl-k">=</span> pd.Series(np.arange(<span class="pl-c1">12</span>), <span class="pl-v">index</span><span class="pl-k">=</span>rng)

In [<span class="pl-c1">215</span>]: ts
Out[<span class="pl-c1">215</span>]: 
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span> <span class="pl-c1">00</span>:<span class="pl-c1">00</span>:<span class="pl-c1">00</span>     <span class="pl-c1">0</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span> <span class="pl-c1">00</span>:<span class="pl-c1">0<span class="pl-ii">1</span></span>:<span class="pl-c1">00</span>     <span class="pl-c1">1</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span> <span class="pl-c1">00</span>:<span class="pl-c1">0<span class="pl-ii">2</span></span>:<span class="pl-c1">00</span>     <span class="pl-c1">2</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span> <span class="pl-c1">00</span>:<span class="pl-c1">0<span class="pl-ii">3</span></span>:<span class="pl-c1">00</span>     <span class="pl-c1">3</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span> <span class="pl-c1">00</span>:<span class="pl-c1">0<span class="pl-ii">4</span></span>:<span class="pl-c1">00</span>     <span class="pl-c1">4</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span> <span class="pl-c1">00</span>:<span class="pl-c1">0<span class="pl-ii">5</span></span>:<span class="pl-c1">00</span>     <span class="pl-c1">5</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span> <span class="pl-c1">00</span>:<span class="pl-c1">0<span class="pl-ii">6</span></span>:<span class="pl-c1">00</span>     <span class="pl-c1">6</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span> <span class="pl-c1">00</span>:<span class="pl-c1">0<span class="pl-ii">7</span></span>:<span class="pl-c1">00</span>     <span class="pl-c1">7</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span> <span class="pl-c1">00</span>:<span class="pl-c1">0<span class="pl-ii">8</span></span>:<span class="pl-c1">00</span>     <span class="pl-c1">8</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span> <span class="pl-c1">00</span>:<span class="pl-c1">0<span class="pl-ii">9</span></span>:<span class="pl-c1">00</span>     <span class="pl-c1">9</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span> <span class="pl-c1">00</span>:<span class="pl-c1">10</span>:<span class="pl-c1">00</span>    <span class="pl-c1">10</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span> <span class="pl-c1">00</span>:<span class="pl-c1">11</span>:<span class="pl-c1">00</span>    <span class="pl-c1">11</span>
Freq: T, dtype: int64</pre></div>
<p>假设你想要通过求和的方式将这些数据聚合到“5分钟”块中：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">216</span>]: ts.resample(<span class="pl-s"><span class="pl-pds">'</span>5min<span class="pl-pds">'</span></span>, <span class="pl-v">closed</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>right<span class="pl-pds">'</span></span>).sum()
Out[<span class="pl-c1">216</span>]: 
<span class="pl-c1">1999</span><span class="pl-k">-</span><span class="pl-c1">12</span><span class="pl-k">-</span><span class="pl-c1">31</span> <span class="pl-c1">23</span>:<span class="pl-c1">55</span>:<span class="pl-c1">00</span>     <span class="pl-c1">0</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span> <span class="pl-c1">00</span>:<span class="pl-c1">00</span>:<span class="pl-c1">00</span>    <span class="pl-c1">15</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span> <span class="pl-c1">00</span>:<span class="pl-c1">0<span class="pl-ii">5</span></span>:<span class="pl-c1">00</span>    <span class="pl-c1">40</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span> <span class="pl-c1">00</span>:<span class="pl-c1">10</span>:<span class="pl-c1">00</span>    <span class="pl-c1">11</span>
Freq: <span class="pl-ii">5T</span>, dtype: int64</pre></div>
<p>传入的频率将会以“5分钟”的增量定义面元边界。默认情况下，面元的右边界是包含的，因此00:00到00:05的区间中是包含00:05的。传入closed='left'会让区间以左边界闭合：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">217</span>]: ts.resample(<span class="pl-s"><span class="pl-pds">'</span>5min<span class="pl-pds">'</span></span>, <span class="pl-v">closed</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>right<span class="pl-pds">'</span></span>).sum()
Out[<span class="pl-c1">217</span>]: 
<span class="pl-c1">1999</span><span class="pl-k">-</span><span class="pl-c1">12</span><span class="pl-k">-</span><span class="pl-c1">31</span> <span class="pl-c1">23</span>:<span class="pl-c1">55</span>:<span class="pl-c1">00</span>     <span class="pl-c1">0</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span> <span class="pl-c1">00</span>:<span class="pl-c1">00</span>:<span class="pl-c1">00</span>    <span class="pl-c1">15</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span> <span class="pl-c1">00</span>:<span class="pl-c1">0<span class="pl-ii">5</span></span>:<span class="pl-c1">00</span>    <span class="pl-c1">40</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span> <span class="pl-c1">00</span>:<span class="pl-c1">10</span>:<span class="pl-c1">00</span>    <span class="pl-c1">11</span>
Freq: <span class="pl-ii">5T</span>, dtype: int64</pre></div>
<p>如你所见，最终的时间序列是以各面元右边界的时间戳进行标记的。传入label='right'即可用面元的邮编界对其进行标记：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">218</span>]: ts.resample(<span class="pl-s"><span class="pl-pds">'</span>5min<span class="pl-pds">'</span></span>, <span class="pl-v">closed</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>right<span class="pl-pds">'</span></span>, <span class="pl-v">label</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>right<span class="pl-pds">'</span></span>).sum()
Out[<span class="pl-c1">218</span>]: 
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span> <span class="pl-c1">00</span>:<span class="pl-c1">00</span>:<span class="pl-c1">00</span>     <span class="pl-c1">0</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span> <span class="pl-c1">00</span>:<span class="pl-c1">0<span class="pl-ii">5</span></span>:<span class="pl-c1">00</span>    <span class="pl-c1">15</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span> <span class="pl-c1">00</span>:<span class="pl-c1">10</span>:<span class="pl-c1">00</span>    <span class="pl-c1">40</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span> <span class="pl-c1">00</span>:<span class="pl-c1">15</span>:<span class="pl-c1">00</span>    <span class="pl-c1">11</span>
Freq: <span class="pl-ii">5T</span>, dtype: int64</pre></div>
<p>图11-3说明了“1分钟”数据被转换为“5分钟”数据的处理过程。</p>
<p><a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/d1bff169a141563436ba51af3a2169d3cba366fb/687474703a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d376137376634373834346632656538632e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430"><img src="https://camo.githubusercontent.com/d1bff169a141563436ba51af3a2169d3cba366fb/687474703a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d376137376634373834346632656538632e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430" alt="图11-3 各种closed、label约定的“5分钟”重采样演示" data-canonical-src="http://upload-images.jianshu.io/upload_images/7178691-7a77f47844f2ee8c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="max-width:100%;"></a></p>
<p>最后，你可能希望对结果索引做一些位移，比如从右边界减去一秒以便更容易明白该时间戳到底表示的是哪个区间。只需通过loffset设置一个字符串或日期偏移量即可实现这个目的：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">219</span>]: ts.resample(<span class="pl-s"><span class="pl-pds">'</span>5min<span class="pl-pds">'</span></span>, <span class="pl-v">closed</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>right<span class="pl-pds">'</span></span>,
   <span class="pl-c1">...</span>..:             <span class="pl-v">label</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>right<span class="pl-pds">'</span></span>, <span class="pl-v">loffset</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>-1s<span class="pl-pds">'</span></span>).sum()
Out[<span class="pl-c1">219</span>]: 
<span class="pl-c1">1999</span><span class="pl-k">-</span><span class="pl-c1">12</span><span class="pl-k">-</span><span class="pl-c1">31</span> <span class="pl-c1">23</span>:<span class="pl-c1">59</span>:<span class="pl-c1">59</span>     <span class="pl-c1">0</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span> <span class="pl-c1">00</span>:<span class="pl-c1">0<span class="pl-ii">4</span></span>:<span class="pl-c1">59</span>    <span class="pl-c1">15</span>
In [<span class="pl-c1">219</span>]: ts.resample(<span class="pl-s"><span class="pl-pds">'</span>5min<span class="pl-pds">'</span></span>, <span class="pl-v">closed</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>right<span class="pl-pds">'</span></span>,
   <span class="pl-c1">...</span>..:             <span class="pl-v">label</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>right<span class="pl-pds">'</span></span>, <span class="pl-v">loffset</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>-1s<span class="pl-pds">'</span></span>).sum()
Out[<span class="pl-c1">219</span>]: 
<span class="pl-c1">1999</span><span class="pl-k">-</span><span class="pl-c1">12</span><span class="pl-k">-</span><span class="pl-c1">31</span> <span class="pl-c1">23</span>:<span class="pl-c1">59</span>:<span class="pl-c1">59</span>     <span class="pl-c1">0</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span> <span class="pl-c1">00</span>:<span class="pl-c1">0<span class="pl-ii">4</span></span>:<span class="pl-c1">59</span>    <span class="pl-c1">15</span></pre></div>
<p>此外，也可以通过调用结果对象的shift方法来实现该目的，这样就不需要设置loffset了。</p>
<p>##OHLC重采样</p>
<p>金融领域中有一种无所不在的时间序列聚合方式，即计算各面元的四个值：第一个值（open，开盘）、最后一个值（close，收盘）、最大值（high，最高）以及最小值（low，最低）。传入how='ohlc'即可得到一个含有这四种聚合值的DataFrame。整个过程很高效，只需一次扫描即可计算出结果：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">220</span>]: ts.resample(<span class="pl-s"><span class="pl-pds">'</span>5min<span class="pl-pds">'</span></span>).ohlc()
Out[<span class="pl-c1">220</span>]: 
                
3ff8
     <span class="pl-c1">open</span>  high  low  close
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span> <span class="pl-c1">00</span>:<span class="pl-c1">00</span>:<span class="pl-c1">00</span>     <span class="pl-c1">0</span>     <span class="pl-c1">4</span>    <span class="pl-c1">0</span>      <span class="pl-c1">4</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span> <span class="pl-c1">00</span>:<span class="pl-c1">0<span class="pl-ii">5</span></span>:<span class="pl-c1">00</span>     <span class="pl-c1">5</span>     <span class="pl-c1">9</span>    <span class="pl-c1">5</span>      <span class="pl-c1">9</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span> <span class="pl-c1">00</span>:<span class="pl-c1">10</span>:<span class="pl-c1">00</span>    <span class="pl-c1">10</span>    <span class="pl-c1">11</span>   <span class="pl-c1">10</span>     <span class="pl-c1">11</span></pre></div>
<p>##升采样和插值</p>
<p>在将数据从低频率转换到高频率时，就不需要聚合了。我们来看一个带有一些周型数据的DataFrame：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">221</span>]: frame <span class="pl-k">=</span> pd.DataFrame(np.random.randn(<span class="pl-c1">2</span>, <span class="pl-c1">4</span>),
   <span class="pl-c1">...</span>..:                      <span class="pl-v">index</span><span class="pl-k">=</span>pd.date_range(<span class="pl-s"><span class="pl-pds">'</span>1/1/2000<span class="pl-pds">'</span></span>, <span class="pl-v">periods</span><span class="pl-k">=</span><span class="pl-c1">2</span>,
   <span class="pl-c1">...</span>..:                                          <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>W-WED<span class="pl-pds">'</span></span>),
   <span class="pl-c1">...</span>..:                      <span class="pl-v">columns</span><span class="pl-k">=</span>[<span class="pl-s"><span class="pl-pds">'</span>Colorado<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Texas<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>New York<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Ohio<span class="pl-pds">'</span></span>])

In [<span class="pl-c1">222</span>]: frame
Out[<span class="pl-c1">222</span>]: 
            Colorado     Texas  New York      Ohio
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span> <span class="pl-k">-</span><span class="pl-c1">0.896431</span>  <span class="pl-c1">0.677263</span>  <span class="pl-c1">0.036503</span>  <span class="pl-c1">0.087102</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">12</span> <span class="pl-k">-</span><span class="pl-c1">0.046662</span>  <span class="pl-c1">0.927238</span>  <span class="pl-c1">0.482284</span> <span class="pl-k">-</span><span class="pl-c1">0.867130</span></pre></div>
<p>当你对这个数据进行聚合，每组只有一个值，这样就会引入缺失值。我们使用asfreq方法转换成高频，不经过聚合：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">223</span>]: df_daily <span class="pl-k">=</span> frame.resample(<span class="pl-s"><span class="pl-pds">'</span>D<span class="pl-pds">'</span></span>).asfreq()

In [<span class="pl-c1">224</span>]: df_daily
Out[<span class="pl-c1">224</span>]: 
            Colorado     Texas  New York      Ohio
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span> <span class="pl-k">-</span><span class="pl-c1">0.896431</span>  <span class="pl-c1">0.677263</span>  <span class="pl-c1">0.036503</span>  <span class="pl-c1">0.087102</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">6</span></span>       NaN       NaN       NaN       NaN
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">7</span></span>       NaN       NaN       NaN       NaN
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">8</span></span>       NaN       NaN       NaN       NaN
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">9</span></span>       NaN       NaN       NaN       NaN
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">10</span>       NaN       NaN       NaN       NaN
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">11</span>       NaN       NaN       NaN       NaN
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">12</span> <span class="pl-k">-</span><span class="pl-c1">0.046662</span>  <span class="pl-c1">0.927238</span>  <span class="pl-c1">0.482284</span> <span class="pl-k">-</span><span class="pl-c1">0.867130</span></pre></div>
<p>假设你想要用前面的周型值填充“非星期三”。resampling的填充和插值方式跟fillna和reindex的一样：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">225</span>]: frame.resample(<span class="pl-s"><span class="pl-pds">'</span>D<span class="pl-pds">'</span></span>).ffill()
Out[<span class="pl-c1">225</span>]: 
            Colorado     Texas  New York      Ohio
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span> <span class="pl-k">-</span><span class="pl-c1">0.896431</span>  <span class="pl-c1">0.677263</span>  <span class="pl-c1">0.036503</span>  <span class="pl-c1">0.087102</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">6</span></span> <span class="pl-k">-</span><span class="pl-c1">0.896431</span>  <span class="pl-c1">0.677263</span>  <span class="pl-c1">0.036503</span>  <span class="pl-c1">0.087102</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">7</span></span> <span class="pl-k">-</span><span class="pl-c1">0.896431</span>  <span class="pl-c1">0.677263</span>  <span class="pl-c1">0.036503</span>  <span class="pl-c1">0.087102</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">8</span></span> <span class="pl-k">-</span><span class="pl-c1">0.896431</span>  <span class="pl-c1">0.677263</span>  <span class="pl-c1">0.036503</span>  <span class="pl-c1">0.087102</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">9</span></span> <span class="pl-k">-</span><span class="pl-c1">0.896431</span>  <span class="pl-c1">0.677263</span>  <span class="pl-c1">0.036503</span>  <span class="pl-c1">0.087102</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">10</span> <span class="pl-k">-</span><span class="pl-c1">0.896431</span>  <span class="pl-c1">0.677263</span>  <span class="pl-c1">0.036503</span>  <span class="pl-c1">0.087102</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">11</span> <span class="pl-k">-</span><span class="pl-c1">0.896431</span>  <span class="pl-c1">0.677263</span>  <span class="pl-c1">0.036503</span>  <span class="pl-c1">0.087102</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">12</span> <span class="pl-k">-</span><span class="pl-c1">0.046662</span>  <span class="pl-c1">0.927238</span>  <span class="pl-c1">0.482284</span> <span class="pl-k">-</span><span class="pl-c1">0.867130</span></pre></div>
<p>同样，这里也可以只填充指定的时期数（目的是限制前面的观测值的持续使用距离）：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">226</span>]: frame.resample(<span class="pl-s"><span class="pl-pds">'</span>D<span class="pl-pds">'</span></span>).ffill(<span class="pl-v">limit</span><span class="pl-k">=</span><span class="pl-c1">2</span>)
Out[<span class="pl-c1">226</span>]:
            Colorado     Texas  New York      Ohio
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span> <span class="pl-k">-</span><span class="pl-c1">0.896431</span>  <span class="pl-c1">0.677263</span>  <span class="pl-c1">0.036503</span>  <span class="pl-c1">0.087102</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">6</span></span> <span class="pl-k">-</span><span class="pl-c1">0.896431</span>  <span class="pl-c1">0.677263</span>  <span class="pl-c1">0.036503</span>  <span class="pl-c1">0.087102</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">7</span></span> <span class="pl-k">-</span><span class="pl-c1">0.896431</span>  <span class="pl-c1">0.677263</span>  <span class="pl-c1">0.036503</span>  <span class="pl-c1">0.087102</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">8</span></span>       NaN       NaN       NaN       NaN
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">9</span></span>       NaN       NaN       NaN       NaN
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">10</span>       NaN       NaN       NaN       NaN
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">11</span>       NaN       NaN       NaN       NaN
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">12</span> <span class="pl-k">-</span><span class="pl-c1">0.046662</span>  <span class="pl-c1">0.927238</span>  <span class="pl-c1">0.482284</span> <span class="pl-k">-</span><span class="pl-c1">0.867130</span></pre></div>
<p>注意，新的日期索引完全没必要跟旧的重叠：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">227</span>]: frame.resample(<span class="pl-s"><span class="pl-pds">'</span>W-THU<span class="pl-pds">'</span></span>).ffill()
Out[<span class="pl-c1">227</span>]: 
            Colorado     Texas  New York      Ohio
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">6</span></span> <span class="pl-k">-</span><span class="pl-c1">0.896431</span>  <span class="pl-c1">0.677263</span>  <span class="pl-c1">0.036503</span>  <span class="pl-c1">0.087102</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">13</span> <span class="pl-k">-</span><span class="pl-c1">0.046662</span>  <span class="pl-c1">0.927238</span>  <span class="pl-c1">0.482284</span> <span class="pl-k">-</span><span class="pl-c1">0.867130</span></pre></div>
<h2><a id="user-content-通过时期进行重采样" class="anchor" aria-hidden="true" href="#通过时期进行重采样"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>通过时期进行重采样</h2>
<p>对那些使用时期索引的数据进行重采样与时间戳很像：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">228</span>]: frame <span class="pl-k">=</span> pd.DataFrame(np.random.randn(<span class="pl-c1">24</span>, <span class="pl-c1">4</span>),
   <span class="pl-c1">...</span>..:                      <span class="pl-v">index</span><span class="pl-k">=</span>pd.period_range(<span class="pl-s"><span class="pl-pds">'</span>1-2000<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>12-2001<span class="pl-pds">'</span></span>,
   <span class="pl-c1">...</span>..:                                            <span class="pl-v">freq</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>M<span class="pl-pds">'</span></span>),
   <span class="pl-c1">...</span>..:                      <span class="pl-v">columns</span><span class="pl-k">=</span>[<span class="pl-s"><span class="pl-pds">'</span>Colorado<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Texas<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>New York<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>Ohio<span class="pl-pds">'</span></span>])

In [<span class="pl-c1">229</span>]: frame[:<span class="pl-c1">5</span>]
Out[<span class="pl-c1">229</span>]: 
         Colorado     Texas  New York      Ohio
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span>  <span class="pl-c1">0.493841</span> <span class="pl-k">-</span><span class="pl-c1">0.155434</span>  <span class="pl-c1">1.397286</span>  <span class="pl-c1">1.507055</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span> <span class="pl-k">-</span><span class="pl-c1">1.179442</span>  <span class="pl-c1">0.443171</span>  <span class="pl-c1">1.395676</span> <span class="pl-k">-</span><
4000
span class="pl-c1">0.529658</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span>  <span class="pl-c1">0.787358</span>  <span class="pl-c1">0.248845</span>  <span class="pl-c1">0.743239</span>  <span class="pl-c1">1.267746</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">4</span></span>  <span class="pl-c1">1.302395</span> <span class="pl-k">-</span><span class="pl-c1">0.272154</span> <span class="pl-k">-</span><span class="pl-c1">0.051532</span> <span class="pl-k">-</span><span class="pl-c1">0.467740</span>
<span class="pl-c1">2000</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span> <span class="pl-k">-</span><span class="pl-c1">1.040816</span>  <span class="pl-c1">0.426419</span>  <span class="pl-c1">0.312945</span> <span class="pl-k">-</span><span class="pl-c1">1.115689</span>

In [<span class="pl-c1">230</span>]: annual_frame <span class="pl-k">=</span> frame.resample(<span class="pl-s"><span class="pl-pds">'</span>A-DEC<span class="pl-pds">'</span></span>).mean()

In [<span class="pl-c1">231</span>]: annual_frame
Out[<span class="pl-c1">231</span>]: 
      Colorado     Texas  New York      Ohio
<span class="pl-c1">2000</span>  <span class="pl-c1">0.556703</span>  <span class="pl-c1">0.016631</span>  <span class="pl-c1">0.111873</span> <span class="pl-k">-</span><span class="pl-c1">0.027445</span>
<span class="pl-c1">2001</span>  <span class="pl-c1">0.046303</span>  <span class="pl-c1">0.163344</span>  <span class="pl-c1">0.251503</span> <span class="pl-k">-</span><span class="pl-c1">0.157276</span></pre></div>
<p>升采样要稍微麻烦一些，因为你必须决定在新频率中各区间的哪端用于放置原来的值，就像asfreq方法那样。convention参数默认为'start'，也可设置为'end'：</p>
<div class="highlight highlight-source-python"><pre><span class="pl-c"><span class="pl-c">#</span> Q-DEC: Quarterly, year ending in December</span>
In [<span class="pl-c1">232</span>]: annual_frame.resample(<span class="pl-s"><span class="pl-pds">'</span>Q-DEC<span class="pl-pds">'</span></span>).ffill()
Out[<span class="pl-c1">232</span>]: 
        Colorado     Texas  New York      Ohio
<span class="pl-ii">2000Q1</span>  <span class="pl-c1">0.556703</span>  <span class="pl-c1">0.016631</span>  <span class="pl-c1">0.111873</span> <span class="pl-k">-</span><span class="pl-c1">0.027445</span>
<span class="pl-ii">2000Q2</span>  <span class="pl-c1">0.556703</span>  <span class="pl-c1">0.016631</span>  <span class="pl-c1">0.111873</span> <span class="pl-k">-</span><span class="pl-c1">0.027445</span>
<span class="pl-ii">2000Q3</span>  <span class="pl-c1">0.556703</span>  <span class="pl-c1">0.016631</span>  <span class="pl-c1">0.111873</span> <span class="pl-k">-</span><span class="pl-c1">0.027445</span>
<span class="pl-ii">2000Q4</span>  <span class="pl-c1">0.556703</span>  <span class="pl-c1">0.016631</span>  <span class="pl-c1">0.111873</span> <span class="pl-k">-</span><span class="pl-c1">0.027445</span>
<span class="pl-ii">2001Q1</span>  <span class="pl-c1">0.046303</span>  <span class="pl-c1">0.163344</span>  <span class="pl-c1">0.251503</span> <span class="pl-k">-</span><span class="pl-c1">0.157276</span>
<span class="pl-ii">2001Q2</span>  <span class="pl-c1">0.046303</span>  <span class="pl-c1">0.163344</span>  <span class="pl-c1">0.251503</span> <span class="pl-k">-</span><span class="pl-c1">0.157276</span>
<span class="pl-ii">2001Q3</span>  <span class="pl-c1">0.046303</span>  <span class="pl-c1">0.163344</span>  <span class="pl-c1">0.251503</span> <span class="pl-k">-</span><span class="pl-c1">0.157276</span>
<span class="pl-ii">2001Q4</span>  <span class="pl-c1">0.046303</span>  <span class="pl-c1">0.163344</span>  <span class="pl-c1">0.251503</span> <span class="pl-k">-</span><span class="pl-c1">0.157276</span>

In [<span class="pl-c1">233</span>]: annual_frame.resample(<span class="pl-s"><span class="pl-pds">'</span>Q-DEC<span class="pl-pds">'</span></span>, <span class="pl-v">convention</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>end<span class="pl-pds">'</span></span>).ffill()
Out[<span class="pl-c1">233</span>]: 
        Colorado     Texas  New York      Ohio
<span class="pl-ii">2000Q4</span>  <span class="pl-c1">0.556703</span>  <span class="pl-c1">0.016631</span>  <span class="pl-c1">0.111873</span> <span class="pl-k">-</span><span class="pl-c1">0.027445</span>
<span class="pl-ii">2001Q1</span>  <span class="pl-c1">0.556703</span>  <span class="pl-c1">0.016631</span>  <span class="pl-c1">0.111873</span> <span class="pl-k">-</span><span class="pl-c1">0.027445</span>
<span class="pl-ii">2001Q2</span>  <span class="pl-c1">0.556703</span>  <span class="pl-c1">0.016631</span>  <span class="pl-c1">0.111873</span> <span class="pl-k">-</span><span class="pl-c1">0.027445</span>
<span class="pl-ii">2001Q3</span>  <span class="pl-c1">0.556703</span>  <span class="pl-c1">0.016631</span>  <span class="pl-c1">0.111873</span> <span class="pl-k">-</span><span class="pl-c1">0.027445</span>
<span class="pl-ii">2001Q4</span>  <span class="pl-c1">0.046303</span>  <span class="pl-c1">0.163344</span>  <span class="pl-c1">0.251503</span> <span class="pl-k">-</span><span class="pl-c1">0.157276</span></pre></div>
<p>由于时期指的是时间区间，所以升采样和降采样的规则就比较严格：</p>
<ul>
<li>在降采样中，目标频率必须是源频率的子时期（subperiod）。</li>
<li>在升采样中，目标频率必须是源频率的超时期（superperiod）。</li>
</ul>
<p>如果不满足这些条件，就会引发异常。这主要影响的是按季、年、周计算的频率。例如，由Q-MAR定义的时间区间只能升采样为A-MAR、A-JUN、A-SEP、A-DEC等：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">234</span>]: annual_frame.resample(<span class="pl-s"><span class="pl-pds">'</span>Q-MAR<span class="pl-pds">'</span></span>).ffill()
Out[<span class="pl-c1">234</span>]: 
        Colorado     Texas  New York      Ohio
<span class="pl-ii">2000Q4</span>  <span class="pl-c1">0.556703</span>  <span class="pl-c1">0.016631</span>  <span class="pl-c1">0.111873</span> <span class="pl-k">-</span><span class="pl-c1">0.027445</span>
<span class="pl-ii">2001Q1</span>  <span class="pl-c1">0.556703</span>  <span class="pl-c1">0.016631</span>  <span class="pl-c1">0.111873</span> <span class="pl-k">-</span><span class="pl-c1">0.027445</span>
<span class="pl-ii">2001Q2</span>  <span class="pl-c1">0.556703</span>  <span class="pl-c1">0.016631</span>  <span class="pl-c1">0.111873</span> <span class="pl-k">-</span><span class="pl-c1">0.027445</span>
<span class="pl-ii">2001Q3</span>  <span class="pl-c1">0.556703</span>  <span class="pl-c1">0.016631</span>  <span class="pl-c1">0.111873</span> <span class="pl-k">-</span><span class="pl-c1">0.027445</span>
<span class="pl-ii">2001Q4</span>  <span class="pl-c1">0.046303</span>  <span class="pl-c1">0.163344</span>  <span class="pl-c1">0.251503</span> <span class="pl-k">-</span><span class="pl-c1">0.157276</span>
<span class="pl-ii">2002Q1</span>  <span class="pl-c1">0.046303</span>  <span class="pl-c1">0.163344</span>  <span class="pl-c1">0.251503</span> <span class="pl-k">-</span><span class="pl-c1">0.157276</span>
<span class="pl-ii">2002Q2</span>  <span class="pl-c1">0.046303</span>  <span class="pl-c1">0.163344</span>  <span class="pl-c1">0.251503</span> <span class="pl-k">-</span><span class="pl-c1">0.157276</span>
<span class="pl-ii">2002Q3</span>  <span class="pl-c1">0.046303</span>  <span class="pl-c1">0.163344</span>  <span class="pl-c1">0.251503</span> <span class="pl-k">-</span><span class="pl-c1">0.157276</span></pre></div>
<h1><a id="user-content-117-移动窗口函数" class="anchor" aria-hidden="true" href="#117-移动窗口函数"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>11.7 移动窗口函数</h1>
<p>在移动窗口（可以带有指数衰减权数）上计算的各种统计函数也是一类常见于时间序列的数组变换。这样可以圆滑噪音数据或断裂数据。我将它们称为移动窗口函数（moving window function），其中还包括那些窗口不定长的函数（如指数加权移动平均）。跟其他统计函数一样，移动窗口函数也会自动排除缺失值。</p>
<p>开始之前，我们加载一些时间序列数据，将其重采样为工作日频率：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">235</span>]: close_px_all <span class="pl-k">=</span> pd.read_csv(<span class="pl-s"><span class="pl-pds">'</span>examples/stock_px_2.csv<span class="pl-pds">'</span></span>,
   <span class="pl-c1">...</span>..:                            <span class="pl-v">parse_dates</span><span class="pl-k">=</span><span class="pl-c1">True</span>, <span class="pl-v">index_col</span><span class="pl-k">=</span><span class="pl-c1">0</span>)

In [<span class="pl-c1">236</span>]: close_px <span class="pl-k">=</span> close_px_all[[<span class="pl-s"><span class="pl-pds">'</span>AAPL<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>MSFT<span class="pl-pds">'</span></span>, <span class="pl-s"><span class="pl-pds">'</span>XOM<span class="pl-pds">'</span></span>]]

In [<span class="pl-c1">237</span>]: close_px <span class="pl-k">=</span> close_px.resample(<span class="pl-s"><span class="pl-pds">'</span>B<span class="pl-pds">'</span></span>).ffill()</pre></div>
<p>现在引入rolling运算符，它与resample和groupby很像。可以在TimeSeries或DataFrame以及一个window（表示期数，见图11-4）上调用它：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">238</span>]: close_px.<span class="pl-c1">AAPL</span>.plot()
Out[<span class="pl-c1">238</span>]: <span class="pl-k">&lt;</span>matplotlib.axes._subplots.AxesSubplot at <span class="pl-c1"><span class="pl-k">0x</span>7f2f2570cf98</span><span class="pl-k">&gt;</span>

In [<span class="pl-c1">239</span>]: close_px.<span class="pl-c1">AAPL</span>.rolling(<span class="pl-c1">250</span>).mean().plot()</pre></div>
<p><a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/34b86d734ac0f40a619d4cf7a0c59a4384a1f841/687474703a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d333332373438336561623733306230392e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430"><img src="https://camo.githubusercontent.com/34b86d734ac0f40a619d4cf7a0c59a4384a1f841/687474703a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d333332373438336561623733306230392e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430" alt="图11-4 苹果公司股价的250日均线" data-canonical-src="http://upload-images.jianshu.io/upload_images/7178691-3327483eab730b09.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="max-width:100%;"></a></p>
<p>表达式rolling(250)与groupby很像，但不是对其进行分组，而是创建一个按照250天分组的滑动窗口对象。然后，我们就得到了苹果公司股价的250天的移动窗口。</p>
<p>默认情况下，rolling函数需要窗口中所有的值为非NA值。可以修改该行为以解决缺失数据的问题。其实，在时间序列开始处尚不足窗口期的那些数据就是个特例（见图11-5）：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">241</span>]: appl_std250 <span class="pl-k">=</span> close_px.<span class="pl-c1">AAPL</span>.rolling(<span class="pl-c1">250</span>, <span class="pl-v">min_periods</span><span class="pl-k">=</span><span class="pl-c1">10</span>).std()

In [<span class="pl-c1">242</span>]: appl_std250[<span class="pl-c1">5</span>:<span class="pl-c1">12</span>]
Out[<span class="pl-c1">242</span>]: 
<span class="pl-c1">2003</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">9</span></span>         NaN
<span class="pl-c1">2003</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">10</span>         NaN
<span class="pl-c1">2003</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">13</span>         NaN
<span class="pl-c1">2003</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">14</span>         NaN
<span class="pl-c1">2003</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">15</span>    <span class="pl-c1">0.077496</span>
<span class="pl-c1">2003</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">16</span>    <span class="pl-c1">0.074760</span>
<span class="pl-c1">2003</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">17</span>    <span class="pl-c1">0.112368</span>
Freq: B, Name: <span class="pl-c1">AAPL</span>, dtype: float64

In [<span class="pl-c1">243</span>]: appl_std250.plot()</pre></div>
<p><a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/9bcf1f3cd2fdefbf8b8ce078933a8cf7ff663fb9/687474703a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d313566353635626564316363616430392e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430"><img src="https://camo.githubusercontent.com/9bcf1f3cd2fdefbf8b8ce078933a8cf7ff663fb9/687474703a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d313566353635626564316363616430392e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430" alt="图11-5 苹果公司250日每日回报标准差" data-canonical-src="http://upload-images.jianshu.io/upload_images/7178691-15f565bed1ccad09.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="max-width:100%;"></a></p>
<p>要计算扩展窗口平均（expanding window mean），可以使用expanding而不是rolling。“扩展”意味着，从时间序列的起始处开始窗口，增加窗口直到它超过所有的序列。apple_std250时间序列的扩展窗口平均如下所示：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">244</span>]: expanding_mean <span class="pl-k">=</span> appl_std250.expanding().mean()</pre></div>
<p>对DataFrame调用rolling_mean（以及与之类似的函数）会将转换应用到所有的列上（见图11-6）：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">246</span>]: close_px.rolling(<span class="pl-c1">60</span>).mean().plot(<span class="pl-v">logy</span><span class="pl-k">=</span><span class="pl-c1">True</span>)</pre></div>
<p><a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/43ad8e5a1d370bce04b2ba9ff7b7e9fef437a0d6/687474703a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d393739663734383035326232323739662e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430"><img src="https://camo.githubusercontent.com/43ad8e5a1d370bce04b2ba9ff7b7e9fef437a0d6/687474703a2f2f75706c
4000
6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d393739663734383035326232323739662e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430" alt="图11-6 各股价60日均线（对数Y轴）" data-canonical-src="http://upload-images.jianshu.io/upload_images/7178691-979f748052b2279f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="max-width:100%;"></a></p>
<p>rolling函数也可以接受一个指定固定大小时间补偿字符串，而不是一组时期。这样可以方便处理不规律的时间序列。这些字符串也可以传递给resample。例如，我们可以计算20天的滚动均值，如下所示：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">247</span>]: close_px.rolling(<span class="pl-s"><span class="pl-pds">'</span>20D<span class="pl-pds">'</span></span>).mean()
Out[<span class="pl-c1">247</span>]:
                  <span class="pl-c1">AAPL</span>       <span class="pl-c1">MSFT</span>        <span class="pl-c1">XOM</span>
<span class="pl-c1">2003</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">2</span></span>    <span class="pl-c1">7.400000</span>  <span class="pl-c1">21.110000</span>  <span class="pl-c1">29.220000</span>
<span class="pl-c1">2003</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span>    <span class="pl-c1">7.425000</span>  <span class="pl-c1">21.125000</span>  <span class="pl-c1">29.230000</span>
<span class="pl-c1">2003</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">6</span></span>    <span class="pl-c1">7.433333</span>  <span class="pl-c1">21.256667</span>  <span class="pl-c1">29.473333</span>
<span class="pl-c1">2003</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">7</span></span>    <span class="pl-c1">7.432500</span>  <span class="pl-c1">21.425000</span>  <span class="pl-c1">29.342500</span>
<span class="pl-c1">2003</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">8</span></span>    <span class="pl-c1">7.402000</span>  <span class="pl-c1">21.402000</span>  <span class="pl-c1">29.240000</span>
<span class="pl-c1">2003</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">9</span></span>    <span class="pl-c1">7.391667</span>  <span class="pl-c1">21.490000</span>  <span class="pl-c1">29.273333</span>
<span class="pl-c1">2003</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">10</span>    <span class="pl-c1">7.387143</span>  <span class="pl-c1">21.558571</span>  <span class="pl-c1">29.238571</span>
<span class="pl-c1">2003</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">13</span>    <span class="pl-c1">7.378750</span>  <span class="pl-c1">21.633750</span>  <span class="pl-c1">29.197500</span>
<span class="pl-c1">2003</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">14</span>    <span class="pl-c1">7.370000</span>  <span class="pl-c1">21.717778</span>  <span class="pl-c1">29.194444</span>
<span class="pl-c1">2003</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">1</span></span><span class="pl-k">-</span><span class="pl-c1">15</span>    <span class="pl-c1">7.355000</span>  <span class="pl-c1">21.757000</span>  <span class="pl-c1">29.152000</span>
<span class="pl-c1">...</span>                <span class="pl-c1">...</span>        <span class="pl-c1">...</span>        <span class="pl-c1">...</span>
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">10</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">3</span></span>  <span class="pl-c1">398.002143</span>  <span class="pl-c1">25.890714</span>  <span class="pl-c1">72.413571</span>
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">10</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">4</span></span>  <span class="pl-c1">396.802143</span>  <span class="pl-c1">25.807857</span>  <span class="pl-c1">72.427143</span>
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">10</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">5</span></span>  <span class="pl-c1">395.751429</span>  <span class="pl-c1">25.729286</span>  <span class="pl-c1">72.422857</span>
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">10</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">6</span></span>  <span class="pl-c1">394.099286</span>  <span class="pl-c1">25.673571</span>  <span class="pl-c1">72.375714</span>
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">10</span><span class="pl-k">-</span><span class="pl-c1">0<span class="pl-ii">7</span></span>  <span class="pl-c1">392.479333</span>  <span class="pl-c1">25.712000</span>  <span class="pl-c1">72.454667</span>
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">10</span><span class="pl-k">-</span><span class="pl-c1">10</span>  <span class="pl-c1">389.351429</span>  <span class="pl-c1">25.602143</span>  <span class="pl-c1">72.527857</span>
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">10</span><span class="pl-k">-</span><span class="pl-c1">11</span>  <span class="pl-c1">388.505000</span>  <span class="pl-c1">25.674286</span>  <span class="pl-c1">72.835000</span>
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">10</span><span class="pl-k">-</span><span class="pl-c1">12</span>  <span class="pl-c1">388.531429</span>  <span class="pl-c1">25.810000</span>  <span class="pl-c1">73.400714</span>
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">10</span><span class="pl-k">-</span><span class="pl-c1">13</span>  <span class="pl-c1">388.826429</span>  <span class="pl-c1">25.961429</span>  <span class="pl-c1">73.905000</span>
<span class="pl-c1">2011</span><span class="pl-k">-</span><span class="pl-c1">10</span><span class="pl-k">-</span><span class="pl-c1">14</span>  <span class="pl-c1">391.038000</span>  <span class="pl-c1">26.048667</span>  <span class="pl-c1">74.185333</span>
[<span class="pl-c1">2292</span> rows x <span class="pl-c1">3</span> columns]</pre></div>
<h2><a id="user-content-指数加权函数" class="anchor" aria-hidden="true" href="#指数加权函数"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>指数加权函数</h2>
<p>另一种使用固定大小窗口及相等权数观测值的办法是，定义一个衰减因子（decay factor）常量，以便使近期的观测值拥有更大的权数。衰减因子的定义方式有很多，比较流行的是使用时间间隔（span），它可以使结果兼容于窗口大小等于时间间隔的简单移动窗口（simple moving window）函数。</p>
<p>由于指数加权统计会赋予近期的观测值更大的权数，因此相对于等权统计，它能“适应”更快的变化。</p>
<p>除了rolling和expanding，pandas还有ewm运算符。下面这个例子对比了苹果公司股价的30日移动平均和span=30的指数加权移动平均（如图11-7所示）：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">249</span>]: aapl_px <span class="pl-k">=</span> close_px.<span class="pl-c1">AAPL</span>[<span class="pl-s"><span class="pl-pds">'</span>2006<span class="pl-pds">'</span></span>:<span class="pl-s"><span class="pl-pds">'</span>2007<span class="pl-pds">'</span></span>]

In [<span class="pl-c1">250</span>]: ma60 <span class="pl-k">=</span> aapl_px.rolling(<span class="pl-c1">30</span>, <span class="pl-v">min_periods</span><span class="pl-k">=</span><span class="pl-c1">20</span>).mean()

In [<span class="pl-c1">251</span>]: ewma60 <span class="pl-k">=</span> aapl_px.ewm(<span class="pl-v">span</span><span class="pl-k">=</span><span class="pl-c1">30</span>).mean()

In [<span class="pl-c1">252</span>]: ma60.plot(<span class="pl-v">style</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>k--<span class="pl-pds">'</span></span>, <span class="pl-v">label</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>Simple MA<span class="pl-pds">'</span></span>)
Out[<span class="pl-c1">252</span>]: <span class="pl-k">&lt;</span>matplotlib.axes._subplots.AxesSubplot at <span class="pl-c1"><span class="pl-k">0x</span>7f2f252161d0</span><span class="pl-k">&gt;</span>

In [<span class="pl-c1">253</span>]: ewma60.plot(<span class="pl-v">style</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>k-<span class="pl-pds">'</span></span>, <span class="pl-v">label</span><span class="pl-k">=</span><span class="pl-s"><span class="pl-pds">'</span>EW MA<span class="pl-pds">'</span></span>)
Out[<span class="pl-c1">253</span>]: <span class="pl-k">&lt;</span>matplotlib.axes._subplots.AxesSubplot at <span class="pl-c1"><span class="pl-k">0x</span>7f2f252161d0</span><span class="pl-k">&gt;</span>

In [<span class="pl-c1">254</span>]: plt.legend()</pre></div>
<p><a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/a03caaac90cb2f3daa497fe9fe65b95462645721/687474703a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d646165343864656665333734396661642e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430"><img src="https://camo.githubusercontent.com/a03caaac90cb2f3daa497fe9fe65b95462645721/687474703a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d646165343864656665333734396661642e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430" alt="图11-7 简单移动平均与指数加权移动平均" data-canonical-src="http://upload-images.jianshu.io/upload_images/7178691-dae48defe3749fad.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="max-width:100%;"></a></p>
<h2><a id="user-content-二元移动窗口函数" class="anchor" aria-hidden="true" href="#二元移动窗口函数"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>二元移动窗口函数</h2>
<p>有些统计运算（如相关系数和协方差）需要在两个时间序列上执行。例如，金融分析师常常对某只股票对某个参考指数（如标准普尔500指数）的相关系数感兴趣。要进行说明，我们先计算我们感兴趣的时间序列的百分数变化：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">256</span>]: spx_px <span class="pl-k">=</span> close_px_all[<span class="pl-s"><span class="pl-pds">'</span>SPX<span class="pl-pds">'</span></span>]

In [<span class="pl-c1">257</span>]: spx_rets <span class="pl-k">=</span> spx_px.pct_change()

In [<span class="pl-c1">258</span>]: returns <span class="pl-k">=</span> close_px.pct_change()</pre></div>
<p>调用rolling之后，corr聚合函数开始计算与spx_rets滚动相关系数（结果见图11-8）：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">259</span>]: corr <span class="pl-k">=</span> returns.<span class="pl-c1">AAPL</span>.rolling(<span class="pl-c1">125</span>, <span class="pl-v">min_periods</span><span class="pl-k">=</span><span class="pl-c1">100</span>).corr(spx_rets)

In [<span class="pl-c1">260</span>]: corr.plot()</pre></div>
<p><a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/cfb22ea69965633d44904208bcc7b47bbf101f77/687474703a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d653831653066363032623464623065642e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430"><img src="https://camo.githubusercontent.com/cfb22ea69965633d44904208bcc7b47bbf101f77/687474703a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d653831653066363032623464623065642e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430" alt="图11-8 AAPL 6个月的回报与标准普尔500指数的相关系数" data-canonical-src="http://upload-images.jianshu.io/upload_images/7178691-e81e0f602b4db0ed.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="max-width:100%;"></a></p>
<p>假设你想要一次性计算多只股票与标准普尔500指数的相关系数。虽然编写一个循环并新建一个DataFrame不是什么难事，但比较啰嗦。其实，只需传入一个TimeSeries和一个DataFrame，rolling_corr就会自动计算TimeSeries（本例中就是spx_rets）与DataFrame各列的相关系数。结果如图11-9所示：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">262</span>]: corr <span class="pl-k">=</span> returns.rolling(<span class="pl-c1">125</span>, <span class="pl-v">min_periods</span><span class="pl-k">=</span><span class="pl-c1">100</span>).corr(spx_rets)

In [<span class="pl-c1">263</span>]: corr.plot()</pre></div>
<p><a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/dbad2baf4a548dea512e2f42289c1f5cb1002d21/687474703a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d306135346130323861363262396235302e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430"><img src="https://camo.githubusercontent.com/dbad2baf4a548dea512e2f42289c1f5cb1002d21/687474703a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d306135346130323861363262396235302e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430" alt="图11-9 3只股票6个月的回报与标准普尔500指数的相关系数" data-canonical-src="http://upload-images.jianshu.io/upload_images/7178691-0a54a028a62b9b50.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="max-width:100%;"></a></p>
<h2><a id="user-content-用户定义的移动窗口函数" class="anchor" aria-hidden="true" href="#用户定义的移动窗口函数"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 
28f2
13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>用户定义的移动窗口函数</h2>
<p>rolling_apply函数使你能够在移动窗口上应用自己设计的数组函数。唯一要求的就是：该函数要能从数组的各个片段中产生单个值（即约简）。比如说，当我们用rolling(...).quantile(q)计算样本分位数时，可能对样本中特定值的百分等级感兴趣。scipy.stats.percentileofscore函数就能达到这个目的（结果见图11-10）：</p>
<div class="highlight highlight-source-python"><pre>In [<span class="pl-c1">265</span>]: <span class="pl-k">from</span> scipy.stats <span class="pl-k">import</span> percentileofscore

In [<span class="pl-c1">266</span>]: score_at_2percent <span class="pl-k">=</span> <span class="pl-k">lambda</span> <span class="pl-smi">x</span>: percentileofscore(x, <span class="pl-c1">0.02</span>)

In [<span class="pl-c1">267</span>]: result <span class="pl-k">=</span> returns.<span class="pl-c1">AAPL</span>.rolling(<span class="pl-c1">250</span>).apply(score_at_2percent)

In [<span class="pl-c1">268</span>]: result.plot()</pre></div>
<p><a target="_blank" rel="noopener noreferrer" href="https://camo.githubusercontent.com/4b165171da16be3a8ff95b66b795a39b3683331a/687474703a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d616634396538346139306332336331652e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430"><img src="https://camo.githubusercontent.com/4b165171da16be3a8ff95b66b795a39b3683331a/687474703a2f2f75706c6f61642d696d616765732e6a69616e7368752e696f2f75706c6f61645f696d616765732f373137383639312d616634396538346139306332336331652e706e673f696d6167654d6f6772322f6175746f2d6f7269656e742f7374726970253743696d61676556696577322f322f772f31323430" alt="图11-10 AAPL 2%回报率的百分等级（一年窗口期）" data-canonical-src="http://upload-images.jianshu.io/upload_images/7178691-af49e84a90c23c1e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" style="max-width:100%;"></a></p>
<p>如果你没安装SciPy，可以使用conda或pip安装。</p>
<h1><a id="user-content-118-总结" class="anchor" aria-hidden="true" href="#118-总结"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>11.8 总结</h1>
<p>与前面章节接触的数据相比，时间序列数据要求不同类型的分析和数据转换工具。</p>
<p>在接下来的章节中，我们将学习一些高级的pandas方法和如何开始使用建模库statsmodels和scikit-learn。</p>
</article>
  </div>

    </div>

  

  <details class="details-reset details-overlay details-overlay-dark">
    <summary data-hotkey="l" aria-label="Jump to line"></summary>
    <details-dialog class="Box Box--overlay d-flex flex-column anim-fade-in fast linejump" aria-label="Jump to line">
      <!-- '"` --><!-- </textarea></xmp> --></option></form><form class="js-jump-to-line-form Box-body d-flex" action="" accept-charset="UTF-8" method="get"><input name="utf8" type="hidden" value="&#x2713;" />
        <input class="form-control flex-auto mr-3 linejump-input js-jump-to-line-field" type="text" placeholder="Jump to line&hellip;" aria-label="Jump to line" autofocus>
        <button type="submit" class="btn" data-close-dialog>Go</button>
</form>    </details-dialog>
  </details>



  </div>
  <div class="modal-backdrop js-touch-events"></div>
</div>

    </main>
  </div>
  

  </div>

        
<div class="footer container-lg width-full p-responsive" role="contentinfo">
  <div class="position-relative d-flex flex-row-reverse flex-lg-row flex-wrap flex-lg-nowrap flex-justify-center flex-lg-justify-between pt-6 pb-2 mt-6 f6 text-gray border-top border-gray-light ">
    <ul class="list-style-none d-flex flex-wrap col-12 col-lg-5 flex-justify-center flex-lg-justify-between mb-2 mb-lg-0">
      <li class="mr-3 mr-lg-0">&copy; 2019 <span title="0.30673s from unicorn-856dd5c88b-vvhrb">GitHub</span>, Inc.</li>
        <li class="mr-3 mr-lg-0"><a data-ga-click="Footer, go to terms, text:terms" href="https://github.com/site/terms">Terms</a></li>
        <li class="mr-3 mr-lg-0"><a data-ga-click="Footer, go to privacy, text:privacy" href="https://github.com/site/privacy">Privacy</a></li>
        <li class="mr-3 mr-lg-0"><a data-ga-click="Footer, go to security, text:security" href="https://github.com/security">Security</a></li>
        <li class="mr-3 mr-lg-0"><a href="https://githubstatus.com/" data-ga-click="Footer, go to status, text:status">Status</a></li>
        <li><a data-ga-click="Footer, go to help, text:help" href="https://help.github.com">Help</a></li>
    </ul>

    <a aria-label="Homepage" title="GitHub" class="footer-octicon d-none d-lg-block mx-lg-4" href="https://github.com">
      <svg height="24" class="octicon octicon-mark-github" viewBox="0 0 16 16" version="1.1" width="24" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"/></svg>
</a>
   <ul class="list-style-none d-flex flex-wrap col-12 col-lg-5 flex-justify-center flex-lg-justify-between mb-2 mb-lg-0">
        <li class="mr-3 mr-lg-0"><a data-ga-click="Footer, go to contact, text:contact" href="https://github.com/contact">Contact GitHub</a></li>
        <li class="mr-3 mr-lg-0"><a href="https://github.com/pricing" data-ga-click="Footer, go to Pricing, text:Pricing">Pricing</a></li>
      <li class="mr-3 mr-lg-0"><a href="https://developer.github.com" data-ga-click="Footer, go to api, text:api">API</a></li>
      <li class="mr-3 mr-lg-0"><a href="https://training.github.com" data-ga-click="Footer, go to training, text:training">Training</a></li>
        <li class="mr-3 mr-lg-0"><a href="https://github.blog" data-ga-click="Footer, go to blog, text:blog">Blog</a></li>
        <li><a data-ga-click="Footer, go to about, text:about" href="https://github.com/about">About</a></li>

    </ul>
  </div>
  <div class="d-flex flex-justify-center pb-6">
    <span class="f6 text-gray-light"></span>
  </div>
</div>



  <div id="ajax-error-message" class="ajax-error-message flash flash-error">
    <svg class="octicon octicon-alert" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"/></svg>
    <button type="button" class="flash-close js-ajax-error-dismiss" aria-label="Dismiss error">
      <svg class="octicon octicon-x" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48L7.48 8z"/></svg>
    </button>
    You can’t perform that action at this time.
  </div>


    
    <script crossorigin="anonymous" integrity="sha512-rJYwxC2PbjddnbCbfKXSZxekGYFjn1retNfTFCDEkEng1h8kMzpGOqgZZ8Zkseeb7HqkgjG5DXDNJ5wXgC1PnA==" type="application/javascript" src="https://github.githubassets.com/assets/frameworks-9326be1f.js"></script>
    
    <script crossorigin="anonymous" async="async" integrity="sha512-GOTdFccIAFMTeFTgpEo62DnqdlyvJCgvnUBsE9nVaEtybG4Ho1jQuRwNc8TsaLC89RL2YO6NhZJM7OwScEh6Bg==" type="application/javascript" src="https://github.githubassets.com/assets/github-bootstrap-445c13e9.js"></script>
    
    
    
  <div class="js-stale-session-flash stale-session-flash flash flash-warn flash-banner" hidden
    >
    <svg class="octicon octicon-alert" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"/></svg>
    <span class="signed-in-tab-flash">You signed in with another tab or window. <a href="">Reload</a> to refresh your session.</span>
    <span class="signed-out-tab-flash">You signed out in another tab or window. <a href="">Reload</a> to refresh your session.</span>
  </div>
  <template id="site-details-dialog">
  <details class="details-reset details-overlay details-overlay-dark lh-default text-gray-dark hx_rsm" open>
    <summary role="button" aria-label="Close dialog"></summary>
    <details-dialog class="Box Box--overlay d-flex flex-column anim-fade-in fast hx_rsm-dialog hx_rsm-modal">
      <button class="Box-btn-octicon m-0 btn-octicon position-absolute right-0 top-0" type="button" aria-label="Close dialog" data-close-dialog>
        <svg class="octicon octicon-x" viewBox="0 0 12 16" version="1.1" width="12" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M7.48 8l3.75 3.75-1.48 1.48L6 9.48l-3.75 3.75-1.48-1.48L4.52 8 .77 4.25l1.48-1.48L6 6.52l3.75-3.75 1.48 1.48L7.48 8z"/></svg>
      </button>
      <div class="octocat-spinner my-6 js-details-dialog-spinner"></div>
    </details-dialog>
  </details>
</template>

  <div class="Popover js-hovercard-content position-absolute" style="display: none; outline: none;" tabindex="0">
  <div class="Popover-message Popover-message--bottom-left Popover-message--large Box box-shadow-large" style="width:360px;">
  </div>
</div>

  <div aria-live="polite" class="js-global-screen-reader-notice sr-only"></div>

  </body>
</html>


0

